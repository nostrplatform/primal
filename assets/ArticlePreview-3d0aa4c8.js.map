{"version":3,"file":"ArticlePreview-3d0aa4c8.js","sources":["../../src/components/Note/NoteFooter/ArticleFooterActionButton.tsx","../../src/components/BookmarkNote/BookmarkArticle.tsx","../../src/components/Note/NoteFooter/ArticleFooter.tsx","../../src/components/ArticlePreview/ArticlePreview.tsx"],"sourcesContent":["import { Component, createEffect, onCleanup } from 'solid-js';\nimport { PrimalArticle, PrimalNote } from '../../../types/primal';\n\nimport styles from './NoteFooter.module.scss';\n\nconst buttonTypeClasses: Record<string, string> = {\n  zap: styles.zapType,\n  like: styles.likeType,\n  reply: styles.replyType,\n  repost: styles.repostType,\n};\n\nconst ArticleFooterActionButton: Component<{\n  type: 'zap' | 'like' | 'reply' | 'repost',\n  note: PrimalArticle,\n  disabled?: boolean,\n  highlighted?: boolean,\n  onClick?: (e: MouseEvent) => void,\n  onMouseDown?: (e: MouseEvent) => void,\n  onMouseUp?: (e: MouseEvent) => void,\n  onTouchStart?: (e: TouchEvent) => void,\n  onTouchEnd?: (e: TouchEvent) => void,\n  label: string | number,\n  hidden?: boolean,\n  title?: string,\n  large?: boolean,\n}> = (props) => {\n\n  return (\n    <button\n      id={`btn_${props.type}_${props.note.id}`}\n      class={`${styles.stat} ${props.highlighted ? styles.highlighted : ''}`}\n      onClick={props.onClick ?? (() => {})}\n      onMouseDown={props.onMouseDown ?? (() => {})}\n      onMouseUp={props.onMouseUp ?? (() => {})}\n      onTouchStart={props.onTouchStart ?? (() => {})}\n      onTouchEnd={props.onTouchEnd ?? (() => {})}\n      disabled={props.disabled}\n    >\n      <div class={`${buttonTypeClasses[props.type]} ${props.large ? styles.large : ''}`}>\n        <div\n          class={`${styles.icon} ${props.large ? styles.large : ''}`}\n          style={props.hidden ? 'visibility: hidden': 'visibility: visible'}\n        ></div>\n        <div class={styles.statNumber}>{props.label || ''}</div>\n      </div>\n    </button>\n  )\n}\n\nexport default ArticleFooterActionButton;\n","import { useIntl } from '@cookbook/solid-intl';\nimport { Component, createEffect, createSignal, Show } from 'solid-js';\nimport { APP_ID } from '../../App';\nimport { Kind, supportedBookmarkTypes } from '../../constants';\nimport { useAccountContext } from '../../contexts/AccountContext';\nimport { useAppContext } from '../../contexts/AppContext';\nimport { logWarning } from '../../lib/logger';\nimport { getBookmarks, sendBookmarks } from '../../lib/profile';\nimport { subsTo } from '../../sockets';\nimport { PrimalArticle } from '../../types/primal';\nimport ButtonGhost from '../Buttons/ButtonGhost';\nimport { bookmarks as tBookmarks } from '../../translations';\n\nimport styles from './BookmarkNote.module.scss';\nimport { saveBookmarks } from '../../lib/localStore';\nimport { triggerImportEvents } from '../../lib/notes';\n\nconst BookmarkArticle: Component<{ note: PrimalArticle | undefined, large?: boolean }> = (props) => {\n  const account = useAccountContext();\n  const app = useAppContext();\n  const intl = useIntl();\n\n  const [isBookmarked, setIsBookmarked] = createSignal(false);\n  const [bookmarkInProgress, setBookmarkInProgress] = createSignal(false);\n\n  createEffect(() => {\n    const note = props.note;\n\n    if (note) {\n      const coor = `${note.msg.kind}:${note.pubkey}:${(note.msg.tags.find(t => t[0] === 'd') || [])[1]}`;\n\n      setIsBookmarked(() => account?.bookmarks.includes(coor) || false);\n    }\n  })\n\n  const updateBookmarks = async (bookmarkTags: string[][]) => {\n    if (!account) return;\n\n    const bookmarks = bookmarkTags.reduce((acc, t) =>\n      supportedBookmarkTypes.includes(t[0]) ? [...acc, t[1]] : [...acc]\n    , []);\n\n    const date = Math.floor((new Date()).getTime() / 1000);\n\n    account.actions.updateBookmarks(bookmarks)\n    saveBookmarks(account.publicKey, bookmarks);\n    const { success, note} = await sendBookmarks([...bookmarkTags], date, '', account?.proxyThroughPrimal || false, account.activeRelays, account?.relaySettings);\n\n    if (success && note) {\n      triggerImportEvents([note], `bookmark_import_${APP_ID}`)\n    }\n  };\n\n  const addBookmark = async (bookmarkTags: string[][]) => {\n    if (!account || !props.note) return;\n\n    const aTag = ['a', `${props.note.msg.kind}:${props.note.pubkey}:${(props.note.msg.tags.find(t => t[0] === 'd') || [])[1]}`];\n\n    if (!bookmarkTags.find(b => b[0] === aTag[0] && b[1] === aTag[1])) {\n      const bookmarksToAdd = [...bookmarkTags, [ ...aTag ]];\n\n      if (bookmarksToAdd.length < 2) {\n        logWarning('BOOKMARK ISSUE: ', `before_bookmark_${APP_ID}`);\n\n        app?.actions.openConfirmModal({\n          title: intl.formatMessage(tBookmarks.confirm.title),\n          description: intl.formatMessage(tBookmarks.confirm.description),\n          confirmLabel: intl.formatMessage(tBookmarks.confirm.confirm),\n          abortLabel: intl.formatMessage(tBookmarks.confirm.abort),\n          onConfirm: async () => {\n            await updateBookmarks(bookmarksToAdd);\n            app.actions.closeConfirmModal();\n          },\n          onAbort: app.actions.closeConfirmModal,\n        })\n\n        return;\n      }\n\n      await updateBookmarks(bookmarksToAdd);\n    }\n  }\n\n  const removeBookmark = async (bookmarks: string[][]) => {\n    if (!account || !props.note) return;\n\n    const aTag = ['a', `${props.note.msg.kind}:${props.note.pubkey}:${(props.note.msg.tags.find(t => t[0] === 'd') || [])[1]}`];\n\n    if (bookmarks.find(b => b[0] === aTag[0] && b[1] === aTag[1])) {\n      const bookmarksToAdd = bookmarks.filter(b => b[0] !== aTag[0] || b[1] !== aTag[1]);\n\n      if (bookmarksToAdd.length < 1) {\n        logWarning('BOOKMARK ISSUE: ', `before_bookmark_${APP_ID}`);\n\n        app?.actions.openConfirmModal({\n          title: intl.formatMessage(tBookmarks.confirm.titleZero),\n          description: intl.formatMessage(tBookmarks.confirm.descriptionZero),\n          confirmLabel: intl.formatMessage(tBookmarks.confirm.confirmZero),\n          abortLabel: intl.formatMessage(tBookmarks.confirm.abortZero),\n          onConfirm: async () => {\n            await updateBookmarks(bookmarksToAdd);\n            app.actions.closeConfirmModal();\n          },\n          onAbort: app.actions.closeConfirmModal,\n        })\n\n        return;\n      }\n\n      await updateBookmarks(bookmarksToAdd);\n    }\n  }\n\n  const doBookmark = (remove: boolean, then?: () => void) => {\n\n    if (!account?.publicKey) {\n      return;\n    }\n\n    let bookmarks: string[][] = []\n\n    const unsub = subsTo(`before_bookmark_${APP_ID}`, {\n      onEvent: (_, content) => {\n        if (!content || content.kind !== Kind.Bookmarks) return;\n\n        bookmarks = content.tags;\n      },\n      onEose: async () => {\n        if (remove) {\n          await removeBookmark(bookmarks);\n        }\n        else {\n          await addBookmark(bookmarks);\n        }\n\n        then && then();\n        setBookmarkInProgress(() => false);\n        unsub();\n      },\n    });\n\n    setBookmarkInProgress(() => true);\n    getBookmarks(account.publicKey, `before_bookmark_${APP_ID}`);\n  }\n\n  return (\n    <div class={styles.bookmark}>\n      <ButtonGhost\n        onClick={(e: MouseEvent) => {\n          e.preventDefault();\n\n          doBookmark(isBookmarked());\n\n        }}\n        disabled={bookmarkInProgress()}\n      >\n        <Show\n          when={isBookmarked()}\n          fallback={\n            <div class={`${styles.emptyBookmark} ${props.large ? styles.large : ''}`}></div>\n          }\n          >\n            <div class={`${styles.fullBookmark} ${props.large ? styles.large : ''}`}></div>\n        </Show>\n      </ButtonGhost>\n    </div>\n  )\n}\n\nexport default BookmarkArticle;\n","import { batch, Component, createEffect, Show } from 'solid-js';\nimport { MenuItem, PrimalArticle, PrimalNote, ZapOption } from '../../../types/primal';\nimport { sendArticleRepost } from '../../../lib/notes';\n\nimport styles from './NoteFooter.module.scss';\nimport { useAccountContext } from '../../../contexts/AccountContext';\nimport { useToastContext } from '../../Toaster/Toaster';\nimport { useIntl } from '@cookbook/solid-intl';\n\nimport { truncateNumber } from '../../../lib/notifications';\nimport { canUserReceiveZaps, zapArticle, zapNote } from '../../../lib/zap';\nimport { useSettingsContext } from '../../../contexts/SettingsContext';\n\nimport zapMD from '../../../assets/lottie/zap_md_2.json';\nimport { toast as t } from '../../../translations';\nimport PrimalMenu from '../../PrimalMenu/PrimalMenu';\nimport { hookForDev } from '../../../lib/devTools';\nimport { getScreenCordinates } from '../../../utils';\nimport ZapAnimation from '../../ZapAnimation/ZapAnimation';\nimport { CustomZapInfo, useAppContext } from '../../../contexts/AppContext';\nimport ArticleFooterActionButton from './ArticleFooterActionButton';\nimport { NoteReactionsState } from '../Note';\nimport { SetStoreFunction } from 'solid-js/store';\nimport BookmarkNote from '../../BookmarkNote/BookmarkNote';\nimport BookmarkArticle from '../../BookmarkNote/BookmarkArticle';\n\nexport const lottieDuration = () => zapMD.op * 1_000 / zapMD.fr;\n\nconst ArticleFooter: Component<{\n  note: PrimalArticle,\n  size?: 'xwide' | 'wide' | 'normal' | 'short',\n  id?: string,\n  state: NoteReactionsState,\n  updateState: SetStoreFunction<NoteReactionsState>,\n  customZapInfo: CustomZapInfo,\n  large?: boolean,\n  onZapAnim?: (zapOption: ZapOption) => void,\n}> = (props) => {\n\n  const account = useAccountContext();\n  const toast = useToastContext();\n  const intl = useIntl();\n  const settings = useSettingsContext();\n  const app = useAppContext();\n\n  let medZapAnimation: HTMLElement | undefined;\n\n  let quickZapDelay = 0;\n  let footerDiv: HTMLDivElement | undefined;\n  let repostMenu: HTMLDivElement | undefined;\n\n  const size = () => props.size ?? 'normal';\n\n  const repostMenuItems: MenuItem[] = [\n    {\n      action: () => doRepost(),\n      label: 'Repost Note',\n      icon: 'feed_repost',\n    },\n    {\n      action: () => doQuote(),\n      label: 'Quote Note',\n      icon: 'quote',\n    },\n  ];\n\n  const onClickOutside = (e: MouseEvent) => {\n    if (\n      !document?.getElementById(`repost_menu_${props.note.id}`)?.contains(e.target as Node)\n    ) {\n      props.updateState('isRepostMenuVisible', () => false);\n    }\n  }\n\n  createEffect(() => {\n    if (props.state.isRepostMenuVisible) {\n      document.addEventListener('click', onClickOutside);\n    }\n    else {\n      document.removeEventListener('click', onClickOutside);\n    }\n  });\n\n  const showRepostMenu = (e: MouseEvent) => {\n    e.preventDefault();\n    props.updateState('isRepostMenuVisible', () => true);\n  };\n\n  const doQuote = () => {\n    if (!account?.hasPublicKey()) {\n      account?.actions.showGetStarted();\n      return;\n    }\n    props.updateState('isRepostMenuVisible', () => false);\n    account?.actions?.quoteNote(`nostr:${props.note.naddr}`);\n    account?.actions?.showNewNoteForm();\n  };\n\n  const doRepost = async () => {\n    if (!account) {\n      return;\n    }\n\n    if (!account.hasPublicKey()) {\n      account.actions.showGetStarted();\n      return;\n    }\n\n    props.updateState('isRepostMenuVisible', () => false);\n\n    const { success } = await sendArticleRepost(props.note, account.proxyThroughPrimal, account.activeRelays, account.relaySettings);\n\n    if (success) {\n      batch(() => {\n        props.updateState('reposts', (r) => r + 1);\n        props.updateState('reposted', () => true);\n      });\n\n      toast?.sendSuccess(\n        intl.formatMessage(t.repostSuccess),\n      );\n    }\n    else {\n      toast?.sendWarning(\n        intl.formatMessage(t.repostFailed),\n      );\n    }\n  };\n\n  const doReply = () => {};\n\n  const doLike = async (e: MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    if (!account) {\n      return;\n    }\n\n    if (!account.hasPublicKey()) {\n      account.actions.showGetStarted();\n      return;\n    }\n\n    const success = await account.actions.addLike(props.note);\n\n    if (success) {\n      batch(() => {\n        props.updateState('likes', (l) => l + 1);\n        props.updateState('liked', () => true);\n      });\n    }\n  };\n\n  const startZap = (e: MouseEvent | TouchEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    if (!account?.hasPublicKey()) {\n      account?.actions.showGetStarted();\n      props.updateState('isZapping', () => false);\n      return;\n    }\n\n    if (!account.proxyThroughPrimal && account.relays.length === 0) {\n      toast?.sendWarning(\n        intl.formatMessage(t.noRelaysConnected),\n      );\n      return;\n    }\n\n    if (!canUserReceiveZaps(props.note.user)) {\n      toast?.sendWarning(\n        intl.formatMessage(t.zapUnavailable),\n      );\n      props.updateState('isZapping', () => false);\n      return;\n    }\n\n    quickZapDelay = setTimeout(() => {\n      app?.actions.openCustomZapModal(props.customZapInfo);\n      props.updateState('isZapping', () => true);\n    }, 500);\n  };\n\n  const commitZap = (e: MouseEvent | TouchEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    clearTimeout(quickZapDelay);\n\n    if (!account?.hasPublicKey()) {\n      account?.actions.showGetStarted();\n      return;\n    }\n\n    if ((!account.proxyThroughPrimal && account.relays.length === 0) || !canUserReceiveZaps(props.note.user)) {\n      return;\n    }\n\n    if (app?.customZap === undefined) {\n      doQuickZap();\n    }\n  };\n\n  const animateZap = () => {\n    setTimeout(() => {\n      props.updateState('hideZapIcon', () => true);\n\n      if (!medZapAnimation) {\n        return;\n      }\n\n      let newLeft = 33;\n      let newTop = -6;\n\n      if (size() === 'xwide') {\n        newLeft = 46;\n        newTop = -7;\n      }\n\n      if (size() === 'wide' && props.large) {\n        newLeft = 14;\n        newTop = -10;\n      }\n\n      if (size() === 'short') {\n        newLeft = 14;\n        newTop = -6;\n      }\n\n      medZapAnimation.style.left = `${newLeft}px`;\n      medZapAnimation.style.top = `${newTop}px`;\n\n      const onAnimDone = () => {\n        batch(() => {\n          props.updateState('showZapAnim', () => false);\n          props.updateState('hideZapIcon', () => false);\n          props.updateState('zapped', () => true);\n        });\n        medZapAnimation?.removeEventListener('complete', onAnimDone);\n      }\n\n      medZapAnimation.addEventListener('complete', onAnimDone);\n\n      try {\n        // @ts-ignore\n        medZapAnimation.seek(0);\n        // @ts-ignore\n        medZapAnimation.play();\n      } catch (e) {\n        console.warn('Failed to animte zap:', e);\n        onAnimDone();\n      }\n    }, 10);\n  };\n\n  const doQuickZap = async () => {\n    if (!account?.hasPublicKey()) {\n      account?.actions.showGetStarted();\n      return;\n    }\n\n    const amount = settings?.defaultZap.amount || 10;\n    const message = settings?.defaultZap.message || '';\n    const emoji = settings?.defaultZap.emoji;\n\n    batch(() => {\n      props.updateState('isZapping', () => true);\n      props.updateState('satsZapped', (z) => z + amount);\n      props.updateState('showZapAnim', () => true);\n    });\n\n    props.onZapAnim && props.onZapAnim({ amount, message, emoji })\n\n    setTimeout(async () => {\n      const success = await zapArticle(props.note, account.publicKey, amount, message, account.activeRelays);\n\n      props.updateState('isZapping', () => false);\n\n      if (success) {\n        props.customZapInfo.onSuccess({\n          emoji,\n          amount,\n          message,\n        });\n\n        return;\n      }\n\n      props.customZapInfo.onFail({\n        emoji,\n        amount,\n        message,\n      });\n    }, lottieDuration());\n\n  }\n\n  const buttonTypeClasses: Record<string, string> = {\n    zap: styles.zapType,\n    like: styles.likeType,\n    reply: styles.replyType,\n    repost: styles.repostType,\n  };\n\n  createEffect(() => {\n    if (props.state.showZapAnim) {\n      animateZap();\n    }\n  });\n\n  const determineOrient = () => {\n    const coor = getScreenCordinates(repostMenu);\n    const height = 100;\n    return (coor.y || 0) + height < window.innerHeight + window.scrollY ? 'down' : 'up';\n  }\n\n  return (\n    <div\n      id={props.id}\n      class={`${styles.footer} ${styles[size()]}`}\n      ref={footerDiv}\n      onClick={(e) => {e.preventDefault();}}\n    >\n\n      <Show when={props.state.showZapAnim}>\n        <ZapAnimation\n          id={`note-med-zap-${props.note.id}`}\n          src={zapMD}\n          class={props.large ? styles.largeZapLottie : styles.mediumZapLottie}\n          ref={medZapAnimation}\n        />\n      </Show>\n\n      <ArticleFooterActionButton\n        note={props.note}\n        onClick={doReply}\n        type=\"reply\"\n        highlighted={props.state.replied}\n        label={props.state.replies === 0 ? '' : truncateNumber(props.state.replies, 2)}\n        title={props.state.replies.toLocaleString()}\n        large={props.large}\n      />\n\n      <ArticleFooterActionButton\n        note={props.note}\n        onClick={(e: MouseEvent) => e.preventDefault()}\n        onMouseDown={startZap}\n        onMouseUp={commitZap}\n        onTouchStart={startZap}\n        onTouchEnd={commitZap}\n        type=\"zap\"\n        highlighted={props.state.zapped || props.state.isZapping}\n        label={props.state.satsZapped === 0 ? '' : truncateNumber(props.state.satsZapped, 2)}\n        hidden={props.state.hideZapIcon}\n        title={props.state.satsZapped.toLocaleString()}\n        large={props.large}\n      />\n\n      <ArticleFooterActionButton\n        note={props.note}\n        onClick={doLike}\n        type=\"like\"\n        highlighted={props.state.liked}\n        label={props.state.likes === 0 ? '' : truncateNumber(props.state.likes, 2)}\n        title={props.state.likes.toLocaleString()}\n        large={props.large}\n      />\n\n      <button\n        id={`btn_repost_${props.note.id}`}\n        class={`${styles.stat} ${props.state.reposted ? styles.highlighted : ''}`}\n        onClick={showRepostMenu}\n        title={props.state.reposts.toLocaleString()}\n      >\n        <div\n          class={`${buttonTypeClasses.repost}`}\n          ref={repostMenu}\n        >\n          <div\n            class={`${styles.icon} ${props.large ? styles.large : ''}`}\n            style={'visibility: visible'}\n          ></div>\n          <div class={styles.statNumber}>\n            {props.state.reposts === 0 ? '' : truncateNumber(props.state.reposts, 2)}\n          </div>\n          <PrimalMenu\n            id={`repost_menu_${props.note.id}`}\n            items={repostMenuItems}\n            position=\"note_footer\"\n            orientation={determineOrient()}\n            hidden={!props.state.isRepostMenuVisible}\n          />\n        </div>\n      </button>\n\n      <div class={styles.bookmarkFoot}>\n        <BookmarkArticle\n          note={props.note}\n          large={props.large}\n        />\n      </div>\n\n    </div>\n  )\n}\n\nexport default hookForDev(ArticleFooter);\n","import { A } from '@solidjs/router';\nimport { batch, Component, createEffect, createSignal, For, JSXElement, onMount, Show } from 'solid-js';\nimport { createStore } from 'solid-js/store';\nimport { Portal } from 'solid-js/web';\nimport { wordsPerMinute } from '../../constants';\nimport { useAccountContext } from '../../contexts/AccountContext';\nimport { CustomZapInfo, useAppContext } from '../../contexts/AppContext';\nimport { useMediaContext } from '../../contexts/MediaContext';\nimport { useThreadContext } from '../../contexts/ThreadContext';\nimport { shortDate } from '../../lib/dates';\nimport { hookForDev } from '../../lib/devTools';\nimport { userName } from '../../stores/profile';\nimport { PrimalArticle, ZapOption } from '../../types/primal';\nimport { uuidv4 } from '../../utils';\nimport Avatar from '../Avatar/Avatar';\nimport { NoteReactionsState } from '../Note/Note';\nimport NoteContextTrigger from '../Note/NoteContextTrigger';\nimport ArticleFooter from '../Note/NoteFooter/ArticleFooter';\nimport NoteFooter from '../Note/NoteFooter/NoteFooter';\nimport NoteTopZaps from '../Note/NoteTopZaps';\nimport NoteTopZapsCompact from '../Note/NoteTopZapsCompact';\nimport VerificationCheck from '../VerificationCheck/VerificationCheck';\n\nimport defaultAvatarDark from '../../assets/images/reads_image_dark.png';\nimport defaultAvatarLight from '../../assets/images/reads_image_light.png';\n\nimport styles from './ArticlePreview.module.scss';\nimport { useSettingsContext } from '../../contexts/SettingsContext';\nimport { nip19 } from 'nostr-tools';\n\nconst isDev = localStorage.getItem('devMode') === 'true';\n\nconst ArticlePreview: Component<{\n  id?: string,\n  article: PrimalArticle,\n  height?: number,\n  onRender?: (article: PrimalArticle, el: HTMLAnchorElement | undefined) => void,\n  hideFooter?: boolean,\n  hideContext?: boolean,\n  boredered?: boolean,\n}> = (props) => {\n\n  const app = useAppContext();\n  const account = useAccountContext();\n  const thread = useThreadContext();\n  const media = useMediaContext();\n  const settings = useSettingsContext();\n\n  const [reactionsState, updateReactionsState] = createStore<NoteReactionsState>({\n    likes: props.article.likes || 0,\n    liked: props.article.noteActions?.liked || false,\n    reposts: props.article.reposts || 0,\n    reposted: props.article.noteActions?.reposted || false,\n    replies: props.article.replies || 0,\n    replied: props.article.noteActions?.replied || false,\n    zapCount: props.article.zaps || 0,\n    satsZapped: props.article.satszapped || 0,\n    zapped: props.article.noteActions?.zapped || false,\n    zappedAmount: 0,\n    zappedNow: false,\n    isZapping: false,\n    showZapAnim: false,\n    hideZapIcon: false,\n    moreZapsAvailable: false,\n    isRepostMenuVisible: false,\n    topZaps: [],\n    topZapsFeed: [],\n    quoteCount: 0,\n  });\n\n  let latestTopZap: string = '';\n  let latestTopZapFeed: string = '';\n  let articleContextMenu: HTMLDivElement | undefined;\n\n  const onConfirmZap = (zapOption: ZapOption) => {\n    app?.actions.closeCustomZapModal();\n    batch(() => {\n      updateReactionsState('zappedAmount', () => zapOption.amount || 0);\n      updateReactionsState('satsZapped', (z) => z + (zapOption.amount || 0));\n      updateReactionsState('zapped', () => true);\n      updateReactionsState('showZapAnim', () => true)\n    });\n\n    addTopZap(zapOption);\n    addTopZapFeed(zapOption)\n  };\n\n  const onSuccessZap = (zapOption: ZapOption) => {\n    app?.actions.closeCustomZapModal();\n    app?.actions.resetCustomZap();\n\n    const pubkey = account?.publicKey;\n\n    if (!pubkey) return;\n\n    batch(() => {\n      updateReactionsState('zapCount', (z) => z + 1);\n      updateReactionsState('isZapping', () => false);\n      updateReactionsState('showZapAnim', () => false);\n      updateReactionsState('hideZapIcon', () => false);\n      updateReactionsState('zapped', () => true);\n    });\n  };\n\n  const onFailZap = (zapOption: ZapOption) => {\n    app?.actions.closeCustomZapModal();\n    app?.actions.resetCustomZap();\n    batch(() => {\n      updateReactionsState('zappedAmount', () => -(zapOption.amount || 0));\n      updateReactionsState('satsZapped', (z) => z - (zapOption.amount || 0));\n      updateReactionsState('isZapping', () => false);\n      updateReactionsState('showZapAnim', () => false);\n      updateReactionsState('hideZapIcon', () => false);\n      updateReactionsState('zapped', () => props.article.noteActions.zapped);\n    });\n\n    removeTopZap(zapOption);\n    removeTopZapFeed(zapOption);\n  };\n\n  const onCancelZap = (zapOption: ZapOption) => {\n    app?.actions.closeCustomZapModal();\n    app?.actions.resetCustomZap();\n    batch(() => {\n      updateReactionsState('zappedAmount', () => -(zapOption.amount || 0));\n      updateReactionsState('satsZapped', (z) => z - (zapOption.amount || 0));\n      updateReactionsState('isZapping', () => false);\n      updateReactionsState('showZapAnim', () => false);\n      updateReactionsState('hideZapIcon', () => false);\n      updateReactionsState('zapped', () => props.article.noteActions.zapped);\n    });\n\n    removeTopZap(zapOption);\n    removeTopZapFeed(zapOption);\n  };\n\n  const addTopZap = (zapOption: ZapOption) => {\n    const pubkey = account?.publicKey;\n\n    if (!pubkey) return;\n\n    const oldZaps = [ ...reactionsState.topZaps ];\n\n    latestTopZap = uuidv4() as string;\n\n    const newZap = {\n      amount: zapOption.amount || 0,\n      message: zapOption.message || '',\n      pubkey,\n      eventId: props.article.id,\n      id: latestTopZap,\n    };\n\n    if (!thread?.users.find((u) => u.pubkey === pubkey)) {\n      thread?.actions.fetchUsers([pubkey])\n    }\n\n    const zaps = [ ...oldZaps, { ...newZap }].sort((a, b) => b.amount - a.amount);\n    updateReactionsState('topZaps', () => [...zaps]);\n  };\n\n  const removeTopZap = (zapOption: ZapOption) => {\n    const zaps = reactionsState.topZaps.filter(z => z.id !== latestTopZap);\n    updateReactionsState('topZaps', () => [...zaps]);\n  };\n\n\n  const addTopZapFeed = (zapOption: ZapOption) => {\n    const pubkey = account?.publicKey;\n\n    if (!pubkey) return;\n\n    const oldZaps = [ ...reactionsState.topZapsFeed ];\n\n    latestTopZapFeed = uuidv4() as string;\n\n    const newZap = {\n      amount: zapOption.amount || 0,\n      message: zapOption.message || '',\n      pubkey,\n      eventId: props.article.id,\n      id: latestTopZapFeed,\n    };\n\n    const zaps = [ ...oldZaps, { ...newZap }].sort((a, b) => b.amount - a.amount).slice(0, 4);\n    updateReactionsState('topZapsFeed', () => [...zaps]);\n  }\n\n  const removeTopZapFeed = (zapOption: ZapOption) => {\n    const zaps = reactionsState.topZapsFeed.filter(z => z.id !== latestTopZapFeed);\n    updateReactionsState('topZapsFeed', () => [...zaps]);\n  };\n\n  const customZapInfo: () => CustomZapInfo = () => ({\n    note: props.article,\n    onConfirm: onConfirmZap,\n    onSuccess: onSuccessZap,\n    onFail: onFailZap,\n    onCancel: onCancelZap,\n  });\n\n  const openReactionModal = (openOn = 'likes') =>  {\n    app?.actions.openReactionModal(props.article.naddr, {\n      likes: reactionsState.likes,\n      zaps: reactionsState.zapCount,\n      reposts: reactionsState.reposts,\n      quotes: reactionsState.quoteCount,\n      openOn,\n    });\n  };\n\n  const onContextMenuTrigger = () => {\n    app?.actions.openContextMenu(\n      props.article,\n      articleContextMenu?.getBoundingClientRect(),\n      () => {\n        app?.actions.openCustomZapModal(customZapInfo());\n      },\n      openReactionModal,\n    );\n  }\n\n  let articlePreview: HTMLAnchorElement | undefined;\n\n  const [missingCacheImage, setMissingChacheImage] = createSignal(false);\n\n  const articleImage = () => {\n    const url = props.article.image;\n    setMissingChacheImage(() => false);\n\n    let m = media?.actions.getMediaUrl(url, 's');\n\n    if (!m) {\n      m = media?.actions.getMediaUrl(url, 'm');\n    }\n\n    if (!m) {\n      m = media?.actions.getMediaUrl(url, 'o');\n    }\n\n    if (!m) {\n      m = url;\n      setMissingChacheImage(() => true);\n    }\n\n    return m;\n  }\n\n  const authorAvatar = () => {\n    const url = props.article.user.picture;\n    setMissingChacheImage(() => false);\n\n    let m = media?.actions.getMediaUrl(url, 's');\n\n    if (!m) {\n      m = media?.actions.getMediaUrl(url, 'm');\n    }\n\n    if (!m) {\n      m = media?.actions.getMediaUrl(url, 'o');\n    }\n\n    if (!m) {\n      m = url;\n      setMissingChacheImage(() => true);\n    }\n\n    return m;\n  }\n\n  const onImageLoaded = () => {\n    props.onRender && props.onRender(props.article, articlePreview);\n  };\n\n  const onImageError = (event: any) => {\n    const image = event.target;\n\n    let src: string = authorAvatar();\n\n    if (image.src === src || image.src.endsWith(src)) {\n      src = ['sunrise_wave', 'ice_wave'].includes(settings?.theme || '') ? defaultAvatarLight : defaultAvatarDark;\n    }\n\n    image.onerror = \"\";\n    image.src = src;\n    return true;\n  };\n\n  const countLines = (el: Element) => {\n\n    // @ts-ignore\n    var divHeight = el.offsetHeight\n\n    // @ts-ignore\n    var lineHeight = el.computedStyleMap().get('line-height').value;\n\n    var lines = divHeight / lineHeight;\n\n    return lines;\n  }\n\n  const [contentStyle, setContentStyle] = createSignal('T3');\n\n  createEffect(() => {\n    const t = props.article.title;\n    const s = props.article.summary;\n\n    const tt = articlePreview?.querySelector(`.${styles.title}`);\n    const ss = articlePreview?.querySelector(`.${styles.summary}`);\n\n    if (!tt || !ss) return;\n\n    const titleLines = countLines(tt);\n    const summaryLines = countLines(ss);\n\n    if (titleLines === 1) setContentStyle('T1');\n\n    if (titleLines === 2) setContentStyle('T2');\n\n    if (titleLines === 3) setContentStyle('T3');\n  });\n\n  const conetntStyles = () => {\n    if (contentStyle() === 'T1') return styles.t1;\n    if (contentStyle() === 'T2') return styles.t2;\n\n    return ''\n  }\n\n  const articleUrl = () => {\n    const vanityName = app?.verifiedUsers[props.article.pubkey];\n\n    if (!vanityName) return `/e/${props.article.naddr}`;\n\n    const decoded = nip19.decode(props.article.naddr);\n\n    const data = decoded.data as nip19.AddressPointer;\n\n    return `/${vanityName}/${data.identifier}`;\n  }\n\n  return (\n    <A\n      ref={articlePreview}\n      class={`${styles.article} ${props.boredered ? styles.bordered : ''}`}\n      href={articleUrl()}\n      style={props.height ? `height: ${props.height}px` : ''}\n    >\n      <Show when={!props.hideContext}>\n        <div class={styles.upRightFloater}>\n          <NoteContextTrigger\n            ref={articleContextMenu}\n            onClick={onContextMenuTrigger}\n          />\n        </div>\n      </Show>\n\n      <div class={styles.header}>\n        <div class={styles.userInfo}>\n          <Avatar user={props.article.user} size=\"micro\"/>\n          <div class={styles.userName}>{userName(props.article.user)}</div>\n          <VerificationCheck user={props.article.user} />\n          <div class={styles.nip05}>{props.article.user?.nip05 || ''}</div>\n        </div>\n        <div class={styles.time}>\n          {shortDate(props.article.published)}\n        </div>\n      </div>\n\n      <div class={styles.body}>\n        <div class={styles.text}>\n          <div class={`${styles.content} ${conetntStyles()}`}>\n            <div class={styles.title}>\n              {props.article.title}\n            </div>\n            <div class={styles.summary}>\n              {props.article.summary}\n            </div>\n          </div>\n          <div class={styles.tags}>\n            <div class={styles.estimate}>\n              {Math.ceil(props.article.wordCount / wordsPerMinute)} minute read\n            </div>\n            <For each={props.article.tags?.slice(0, 3)}>\n              {tag => (\n                <A href={`/reads/${tag}`} class={styles.tag}>\n                  {tag}\n                </A>\n              )}\n            </For>\n            <Show when={props.article.tags?.length && props.article.tags.length > 3}>\n              <div class={styles.tag}>\n                + {props.article.tags.length - 3}\n              </div>\n            </Show>\n          </div>\n        </div>\n        <div class={styles.image}>\n          <Show\n            when={props.article.image}\n            fallback={\n              <Show\n                when={authorAvatar()}\n                fallback={<div class={styles.placeholderImage}></div>}\n              >\n                <img src={props.article.user.picture} onload={onImageLoaded} onerror={onImageError} />\n              </Show>\n            }\n          >\n            <img\n              src={articleImage()}\n              onload={onImageLoaded}\n              onerror={onImageError}\n              class={isDev && missingCacheImage() ? 'redBorder' : ''}\n            />\n          </Show>\n        </div>\n      </div>\n\n      <Show when={props.article.topZaps?.length > 0}>\n        <div class={styles.zaps}>\n          <NoteTopZapsCompact\n            note={props.article}\n            action={() => {}}\n            topZaps={props.article.topZaps}\n            topZapLimit={4}\n          />\n        </div>\n      </Show>\n\n      <Show when={!props.hideFooter}>\n        <div class={styles.footer}>\n          <ArticleFooter\n            note={props.article}\n            state={reactionsState}\n            updateState={updateReactionsState}\n            customZapInfo={customZapInfo()}\n            onZapAnim={addTopZapFeed}\n          />\n        </div>\n      </Show>\n\n    </A>\n  );\n}\n\nexport default hookForDev(ArticlePreview);\n"],"names":["buttonTypeClasses","zap","styles","zapType","like","likeType","reply","replyType","repost","repostType","ArticleFooterActionButton","props","_el$","_tmpl$","_el$2","firstChild","_el$3","_el$4","nextSibling","_$addEventListener","onTouchEnd","onTouchStart","onMouseUp","onMouseDown","onClick","_$insert","label","_$effect","_p$","_v$","type","note","id","_v$2","stat","highlighted","_v$3","disabled","_v$4","large","_v$5","icon","_v$6","hidden","_v$7","statNumber","_$setAttribute","_$className","_$style","undefined","_$delegateEvents","BookmarkArticle","account","useAccountContext","app","useAppContext","intl","useIntl","isBookmarked","setIsBookmarked","createSignal","bookmarkInProgress","setBookmarkInProgress","createEffect","coor","msg","kind","pubkey","tags","find","t","bookmarks","includes","updateBookmarks","__name","bookmarkTags","reduce","acc","supportedBookmarkTypes","date","Math","floor","Date","getTime","actions","saveBookmarks","publicKey","success","sendBookmarks","proxyThroughPrimal","activeRelays","relaySettings","triggerImportEvents","APP_ID","addBookmark","aTag","b","bookmarksToAdd","length","logWarning","openConfirmModal","title","formatMessage","tBookmarks","confirm","description","confirmLabel","abortLabel","abort","onConfirm","closeConfirmModal","onAbort","removeBookmark","filter","titleZero","descriptionZero","confirmZero","abortZero","doBookmark","remove","then","unsub","subsTo","onEvent","_","content","Kind","Bookmarks","onEose","getBookmarks","_$createComponent","ButtonGhost","e","preventDefault","children","Show","when","fallback","emptyBookmark","fullBookmark","bookmark","lottieDuration","zapMD","op","fr","ArticleFooter","toast","useToastContext","settings","useSettingsContext","medZapAnimation","quickZapDelay","footerDiv","repostMenu","size","repostMenuItems","action","doRepost","doQuote","onClickOutside","document","getElementById","contains","target","updateState","state","isRepostMenuVisible","addEventListener","removeEventListener","showRepostMenu","hasPublicKey","showGetStarted","quoteNote","naddr","showNewNoteForm","sendArticleRepost","batch","r","sendSuccess","repostSuccess","sendWarning","repostFailed","doReply","doLike","stopPropagation","addLike","l","startZap","relays","noRelaysConnected","canUserReceiveZaps","user","zapUnavailable","setTimeout","openCustomZapModal","customZapInfo","commitZap","clearTimeout","customZap","doQuickZap","animateZap","newLeft","newTop","style","left","top","onAnimDone","seek","play","console","warn","amount","defaultZap","message","emoji","z","onZapAnim","zapArticle","onSuccess","onFail","showZapAnim","determineOrient","getScreenCordinates","height","y","window","innerHeight","scrollY","_el$5","_el$6","$$click","_ref$","_$use","ZapAnimation","src","largeZapLottie","mediumZapLottie","ref","r$","_ref$2","replied","_$memo","replies","truncateNumber","toLocaleString","zapped","isZapping","satsZapped","hideZapIcon","liked","likes","_ref$3","_c$","reposts","PrimalMenu","items","position","orientation","footer","reposted","_v$8","_v$9","bookmarkFoot","ArticleFooter$1","hookForDev","isDev","localStorage","getItem","ArticlePreview","thread","useThreadContext","media","useMediaContext","reactionsState","updateReactionsState","createStore","article","noteActions","zapCount","zaps","satszapped","zappedAmount","zappedNow","moreZapsAvailable","topZaps","topZapsFeed","quoteCount","latestTopZap","latestTopZapFeed","articleContextMenu","onConfirmZap","zapOption","closeCustomZapModal","addTopZap","addTopZapFeed","onSuccessZap","resetCustomZap","onFailZap","removeTopZap","removeTopZapFeed","onCancelZap","oldZaps","uuidv4","newZap","eventId","users","u","fetchUsers","sort","a","slice","onCancel","openReactionModal","openOn","quotes","onContextMenuTrigger","openContextMenu","getBoundingClientRect","articlePreview","missingCacheImage","setMissingChacheImage","articleImage","url","image","m","getMediaUrl","authorAvatar","picture","onImageLoaded","onRender","onImageError","event","endsWith","theme","defaultAvatarLight","defaultAvatarDark","onerror","countLines","el","divHeight","offsetHeight","lineHeight","computedStyleMap","get","value","lines","contentStyle","setContentStyle","summary","tt","querySelector","ss","titleLines","conetntStyles","t1","t2","articleUrl","vanityName","verifiedUsers","data","nip19","decode","identifier","A","boredered","bordered","href","hideContext","NoteContextTrigger","upRightFloater","_tmpl$2","Avatar","userName","VerificationCheck","nip05","shortDate","published","header","userInfo","time","_el$7","_tmpl$5","_el$8","_el$9","_el$10","_el$11","_el$12","_el$13","_el$14","_el$17","ceil","wordCount","wordsPerMinute","For","each","tag","_el$15","_tmpl$3","_el$22","placeholderImage","_el$21","_tmpl$4","_el$18","body","text","_v$10","_v$11","_v$12","_v$13","_v$14","estimate","_v$15","_el$19","NoteTopZapsCompact","topZapLimit","hideFooter","_el$20"],"mappings":"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"}