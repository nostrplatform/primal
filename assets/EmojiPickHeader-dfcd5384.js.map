{"version":3,"file":"EmojiPickHeader-dfcd5384.js","sources":["../../src/components/EmojiPicker/EmojiPicker.tsx","../../src/components/EmojiPickModal/EmojiPickHeader.tsx"],"sourcesContent":["import { Component, createEffect, createSignal, For, onCleanup, onMount, Show } from 'solid-js';\n\nimport styles from './EmojiPicker.module.scss';\nimport { isVisibleInContainer, uuidv4 } from '../../utils';\nimport { hookForDev } from '../../lib/devTools';\n\nimport emojiSearch from '@jukben/emoji-search';\nimport { createStore } from 'solid-js/store';\nimport { EmojiOption } from '../../types/primal';\nimport { useIntl } from '@cookbook/solid-intl';\nimport { emojiGroups } from '../../translations';\n\nconst rowLength = 8;\n\nconst EmojiPicker: Component<{\n  id?: string,\n  filter: string,\n  preset?: EmojiOption[],\n  showPreset?: boolean,\n  short?: boolean,\n  onSelect: (emoji: EmojiOption) => void,\n}> = (props) => {\n\n  const intl = useIntl();\n\n  const [emojiResults, setEmojiResults] = createStore<EmojiOption[]>([]);\n  const [highlightedEmoji, setHighlightedEmoji] = createSignal<number>(0);\n  let emojiOptions: HTMLDivElement | undefined;\n  const instanceId = uuidv4();\n\n  const presetEmojis = props.preset || [];\n\n  const preset = () => props.showPreset ? presetEmojis : [];\n\n  const completeCollection = () => [...preset(), ...emojiResults];\n\n  const emojiChangeKeyboard = (e: KeyboardEvent) => {\n    if (e.code === 'ArrowDown') {\n      e.preventDefault();\n      setHighlightedEmoji(i => {\n        if (completeCollection().length === 0) {\n          return 0;\n        }\n\n        if (i < preset().length && i + rowLength > preset().length) {\n          return preset().length;\n        }\n\n        return i < completeCollection().length - rowLength ? i + rowLength : 0;\n      });\n\n      const emojiHolder = document.getElementById(`${instanceId}-${highlightedEmoji()}`);\n\n      if (emojiHolder && emojiOptions && !isVisibleInContainer(emojiHolder, emojiOptions)) {\n        emojiHolder.scrollIntoView({ block: 'end', behavior: 'smooth' });\n      }\n\n      return;\n    }\n\n    if (e.code === 'ArrowUp') {\n      e.preventDefault();\n      setHighlightedEmoji(i => {\n        if (completeCollection().length === 0) {\n          return 0;\n        }\n\n        if (i > preset().length - 1 && i - rowLength < preset().length) {\n          return preset().length - 1;\n        }\n\n        return i >= rowLength ? i - rowLength : completeCollection().length - 1;\n      });\n\n      const emojiHolder = document.getElementById(`${instanceId}-${highlightedEmoji()}`);\n\n      if (emojiHolder && emojiOptions && !isVisibleInContainer(emojiHolder, emojiOptions)) {\n        emojiHolder.scrollIntoView({ block: 'start', behavior: 'smooth' });\n      }\n\n      return;\n    }\n\n    if (e.code === 'ArrowRight') {\n      e.preventDefault();\n      setHighlightedEmoji(i => {\n        if (completeCollection().length === 0) {\n          return 0;\n        }\n\n        return i < completeCollection().length - 1 ? i + 1 : 0;\n      });\n\n      const emojiHolder = document.getElementById(`${instanceId}-${highlightedEmoji()}`);\n\n      if (emojiHolder && emojiOptions && !isVisibleInContainer(emojiHolder, emojiOptions)) {\n        emojiHolder.scrollIntoView({ block: 'end', behavior: 'smooth' });\n      }\n\n      return;\n    }\n\n    if (e.code === 'ArrowLeft') {\n      e.preventDefault();\n      setHighlightedEmoji(i => {\n        if (completeCollection().length === 0) {\n          return 0;\n        }\n\n        return i > 0 ? i - 1 : completeCollection().length - 1;\n      });\n\n      const emojiHolder = document.getElementById(`${instanceId}-${highlightedEmoji()}`);\n\n      if (emojiHolder && emojiOptions && !isVisibleInContainer(emojiHolder, emojiOptions)) {\n        emojiHolder.scrollIntoView({ block: 'start', behavior: 'smooth' });\n      }\n\n      return;\n    }\n\n    if (['Enter', 'Space'].includes(e.code)) {\n      props.onSelect(completeCollection()[highlightedEmoji()]);\n      return;\n    }\n  };\n\n  onMount(() => {\n    window.addEventListener('keydown', emojiChangeKeyboard);\n  });\n\n  onCleanup(() => {\n    window.removeEventListener('keydown', emojiChangeKeyboard);\n  });\n\n  createEffect(() => {\n    const val = props.filter.trim();\n\n    setEmojiResults(emojiSearch(val));\n  });\n\n  return (\n    <div\n      class={`${styles.emojiSuggestions} ${props.short && styles.short}`}\n      ref={emojiOptions}\n    >\n      <Show when={props.showPreset && presetEmojis.length > 0}>\n        <div class={styles.groupTitle}>{intl.formatMessage(emojiGroups.preset)}</div>\n      </Show>\n      <div class={styles.group}>\n        <For each={preset()}>\n          {(emoji, index) => (\n            <button\n              id={`${instanceId}-${index()}`}\n              class={`${styles.emojiOption} ${highlightedEmoji() === index() ? styles.highlight : ''}`}\n              onClick={() => {\n                props.onSelect(emoji);\n              }}\n            >\n              {emoji.name}\n            </button>\n          )}\n        </For>\n      </div>\n\n      <Show when={props.showPreset}>\n        <div class={styles.groupTitle}>\n          {intl.formatMessage(emojiGroups.face)}\n        </div>\n      </Show>\n      <div class={styles.group}>\n        <For each={emojiResults}>\n          {(emoji, index) => (\n            <button\n              id={`${instanceId}-${index()+preset().length}`}\n              class={`${styles.emojiOption} ${highlightedEmoji() === (index()+preset().length) ? styles.highlight : ''}`}\n              onClick={() => {\n                props.onSelect(emoji);\n              }}\n            >\n              {emoji.name}\n            </button>\n          )}\n        </For>\n      </div>\n    </div>\n  );\n}\n\nexport default hookForDev(EmojiPicker);\n","import { Component, createEffect, createSignal } from 'solid-js';\n\nimport styles from './EmojiPickHeader.module.scss';\nimport { useIntl } from '@cookbook/solid-intl';\nimport { settings as t } from '../../translations';\nimport ButtonGhost from '../Buttons/ButtonGhost';\n\nconst EmojiPickHeader: Component<{\n  focus?: boolean,\n  onInput: (emoji: string) => void,\n  onFilter?: (emoji: string) => void,\n}> = (props) => {\n\n  const intl = useIntl();\n\n  let inputRef: HTMLInputElement | undefined;\n\n  createEffect(() => {\n    if (props.focus) {\n      inputRef?.focus();\n    }\n  })\n\n  const onFilter = (filter: string) => {\n    if (inputRef) {\n      inputRef.value = '';\n      inputRef.focus();\n    }\n\n    props.onFilter && props.onFilter(filter);\n\n  }\n\n  return (\n    <div class={styles.emojiHeader}>\n      <div class={styles.emojiInput}>\n        <div class={styles.searchIcon}></div>\n        <input\n          ref={inputRef}\n          onInput={(e: InputEvent) => {\n            const target = e.target as HTMLInputElement;\n            props.onInput(target.value);\n          }}\n          placeholder={intl.formatMessage(t.zapEmojiFilterPlaceholder)}\n        >\n        </input>\n      </div>\n      <div class={styles.filters}>\n        <ButtonGhost\n          onClick={() => onFilter('default')}\n        >\n          <div class={`latest_icon ${styles.emojiIcon}`}></div>\n        </ButtonGhost>\n        <ButtonGhost\n          onClick={() => onFilter('face')}\n        >\n          <div class={`emoji_icon ${styles.emojiIcon}`}></div>\n        </ButtonGhost>\n        <ButtonGhost\n          onClick={() => onFilter('love')}\n        >\n          <div class={`heart_icon ${styles.emojiIcon}`}></div>\n        </ButtonGhost>\n        <ButtonGhost\n          onClick={() => onFilter('weather')}\n        >\n          <div class={`weather_icon ${styles.emojiIcon}`}></div>\n        </ButtonGhost>\n      </div>\n    </div>\n  );\n}\n\nexport default EmojiPickHeader;\n"],"names":["rowLength","EmojiPicker","props","intl","useIntl","emojiResults","setEmojiResults","createStore","highlightedEmoji","setHighlightedEmoji","createSignal","emojiOptions","instanceId","uuidv4","presetEmojis","preset","showPreset","completeCollection","emojiChangeKeyboard","e","code","preventDefault","i","length","emojiHolder","document","getElementById","isVisibleInContainer","scrollIntoView","block","behavior","includes","onSelect","onMount","window","addEventListener","onCleanup","removeEventListener","createEffect","val","filter","trim","emojiSearch","_el$","_tmpl$2","_el$3","firstChild","_el$5","nextSibling","_ref$","_$use","_$insert","_$createComponent","Show","when","children","_el$2","_tmpl$","formatMessage","emojiGroups","_$effect","_$className","styles","groupTitle","For","each","emoji","index","_el$6","_tmpl$3","$$click","name","_p$","_v$4","_v$5","emojiOption","highlight","_$setAttribute","undefined","_el$4","face","_el$7","_v$6","_v$7","_v$","emojiSuggestions","short","_v$2","group","_v$3","EmojiPicker$1","hookForDev","_$delegateEvents","EmojiPickHeader","inputRef","focus","onFilter","value","$$input","target","onInput","ButtonGhost","onClick","emojiIcon","_el$8","_el$9","emojiHeader","emojiInput","searchIcon","t","zapEmojiFilterPlaceholder","filters"],"mappings":"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"}