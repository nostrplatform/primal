var Bt=Object.defineProperty;var b=(n,s)=>Bt(n,"name",{value:s,configurable:!0});import{g as It,aD as Tt,$ as kt,u as Ht,ad as Nt,b as Wt,B as Ft,I as Ut,C as x,o as Kt,n as qt,E as D,j as r,c as f,cN as o,l as v,m as a,S as U,s as h,k as it,bC as $e,q as rt,e as Ot,t as K,cS as lt,cT as Rt,cU as zt,ak as ot,T as Dt,x as V}from"./index-64dc6460.js";import{P as Vt}from"./PageCaption-27eb7f4c.js";import{L as st}from"./Loader-1ac7e304.js";import{P as jt}from"./PageTitle-3d0a9832.js";import{B as Gt}from"./ButtonPrimary-1f64caa8.js";import{B as Jt}from"./ButtonSecondary-cc5e2282.js";import{U as Qt}from"./Uploader-f6bcb09a.js";import"./Buttons.module-e818c1ea.js";import"./5WXHJDCZ-8b9b8e69.js";import"./index-b4296c5e.js";import"./EMOXVTIZ-81fa338a.js";import"./LR7LBJN3-a1aba763.js";import"./JNCCF6MP-19ab5fd3.js";import"./ButtonGhost-a0fa1826.js";const Xt="_container_6b43a_1",Yt="_fullHeader_6b43a_6",Zt="_bannerPlaceholder_6b43a_11",en="_banner_6b43a_11",tn="_uploadingOverlay_6b43a_23",nn="_userImage_6b43a_60",an="_avatar_6b43a_66",rn="_phoneAvatar_6b43a_83",ln="_desktopAvatar_6b43a_87",on="_uploadAction_6b43a_91",sn="_uploadActions_6b43a_115",dn="_uploader_6b43a_125",un="_separator_6b43a_129",vn="_uploadButton_6b43a_135",fn="_inputLabel_6b43a_162",_n="_required_6b43a_175",cn="_star_6b43a_184",bn="_inputWithPrefix_6b43a_222",pn="_inputPrefix_6b43a_230",gn="_inputError_6b43a_247",$n="_cacheFlag_6b43a_303",mn="_horizontalSeparator_6b43a_307",hn="_moreTrigger_6b43a_314",xn="_hidden_6b43a_333",Sn="_shown_6b43a_346",Pn="_moreInputs_6b43a_360",yn="_hide_6b43a_363",Mn="_show_6b43a_346",Cn="_formSubmit_6b43a_372",t={container:Xt,fullHeader:Yt,bannerPlaceholder:Zt,banner:en,uploadingOverlay:tn,userImage:nn,avatar:an,phoneAvatar:rn,desktopAvatar:ln,uploadAction:on,uploadActions:sn,uploader:dn,separator:un,uploadButton:vn,inputLabel:fn,required:_n,star:cn,inputWithPrefix:bn,inputPrefix:pn,inputError:gn,cacheFlag:$n,horizontalSeparator:mn,moreTrigger:hn,hidden:xn,shown:Sn,moreInputs:Pn,hide:yn,show:Mn,formSubmit:Cn},me=K("<div>"),wn=K('<label for="upload-banner"><img><div>'),An=K('<div><div><label for="upload-avatar"><div><div></div></div><div><div>'),Ln=K('<div><div id="central_header"><div id="profile_banner"></div><div><div></div><div><div><input id="upload-avatar" type="file" accept="image/*"><label for="upload-avatar"></label></div><div><input id="upload-banner" type="file" accept="image/*"><label for="upload-banner"></label></div></div></div></div><form><div><label for="name"></label><span><span>*</span></span></div><div><div>@</div><input name="name" type="text"></div><div><label for="displayName"></label></div><input name="displayName" type="text"><div><label for="website"></label></div><input name="website" type="text"><div><label for="about"></label></div><textarea name="about" rows="1" data-min-rows="1"></textarea><div><label for="lud16"></label></div><input name="lud16" type="text"><div><label for="nip05"></label></div><input name="nip05" type="text"><div><button type="button">More</button></div><div><div><label for="picture"></label></div><input name="picture" type="text"><div><label for="banner"></label></div><input name="banner" type="text"></div><div>'),En=K('<div><label for="upload-banner"><div>'),Vn=b(()=>{const n=It(),s=Tt(),dt=kt(),p=Ht(),P=Nt();Wt();const he=Ft(),xe=Ut();let j,L,E,G;const[ut,vt]=x(!1),[J,ft]=x(!1),[Q,X]=x(),[Se,Y]=x(),[Pe,_t]=x(!0),[q,ye]=x(),[Me,Ce]=x("none"),[ct,we]=x(!1),bt=b(()=>{const l=localStorage.getItem("devMode")==="true";return ut()||!l?"":t.cacheFlag},"flagBannerForWarning"),pt=b(l=>{const i=document.getElementById("profile_banner");return i&&(i.innerHTML=`<div class="${t.bannerPlaceholder}"></div>`),!0},"imgError"),Ae=b(()=>{const l=Se(),i=dt?.actions.getMediaUrl(l,"m",!0);return vt(!!i),i??l},"banner"),gt=b(l=>{s?.actions.setProfileKey(l),s?.actions.clearNotes()},"setProfile"),$t=b(l=>{var i=l.value;l.value="",l._baseScrollHeight=l.scrollHeight,l.value=i},"getScrollHeight"),Le=b(()=>{const l=document.documentElement.clientHeight||window.innerHeight||0,i=j,_=parseInt(i.getAttribute("data-min-rows")||"0");if(!i._baseScrollHeight&&$t(i),i.scrollHeight>=l/3)return;i.rows=_;const $=Math.ceil((i.scrollHeight-i._baseScrollHeight)/20);i.rows=_+$},"onExpandableTextareaInput");Kt(()=>{we(!0)}),qt(()=>{we(!1)}),D(()=>{p?.isKeyLookupDone&&p.publicKey&&gt(p.publicKey)}),D(()=>{s?.userProfile?.about&&Le()}),D(()=>{s?.userProfile?.banner&&Y(s.userProfile.banner)}),D(()=>{s?.userProfile?.picture&&X(s.userProfile.picture)});const mt=b(()=>{const l=G?.value||"";_t(lt.test(l))},"onNameInput"),O=b(()=>{L&&(L.value=""),E&&(E.value=""),ye(void 0),Ce("none")},"resetUpload"),Ee=b((l,i)=>{if(!i)return;const _=i.files?i.files[0]:null;_&&(Ce(l),ye(_))},"onUpload"),ht=b(async l=>{if(l.preventDefault(),!l.target||!p)return!1;const i=new FormData(l.target),_=i.get("name")?.toString()||"";if(!lt.test(_))return P?.sendWarning(n.formatMessage(o.profile.name.formError)),!1;let $={};["displayName","name","website","about","lud16","nip05","picture","banner"].forEach(g=>{i.get(g)&&($[g]=i.get(g),g==="displayName"&&($.display_name=i.get(g)))});const B=s?.userProfile||{},{success:Z,note:c}=await Rt({...B,...$},p?.proxyThroughPrimal||!1,p.activeRelays,p.relaySettings);return Z?(c&&zt([c],`import_profile_${Dt}`,()=>{c&&s?.actions.updateProfile(c.pubkey),c&&p.actions.updateAccountProfile(c.pubkey),c&&xe(he?.actions.profileLink(c.pubkey)||"/home"),P?.sendSuccess(n.formatMessage(ot.updateProfileSuccess))}),!1):(P?.sendWarning(n.formatMessage(ot.updateProfileFail)),!1)},"onSubmit");return(()=>{const l=Ln(),i=l.firstChild,_=i.firstChild,$=_.nextSibling,B=$.firstChild,Z=B.nextSibling,c=Z.firstChild,g=c.firstChild,xt=g.nextSibling,Be=c.nextSibling,I=Be.firstChild,St=I.nextSibling,ee=i.nextSibling,te=ee.firstChild,Ie=te.firstChild,ne=Ie.nextSibling,Pt=ne.firstChild,ae=te.nextSibling,Te=ae.firstChild,y=Te.nextSibling,R=ae.nextSibling,yt=R.firstChild,ie=R.nextSibling,re=ie.nextSibling,Mt=re.firstChild,le=re.nextSibling,oe=le.nextSibling,Ct=oe.firstChild,M=oe.nextSibling,se=M.nextSibling,wt=se.firstChild,de=se.nextSibling,ue=de.nextSibling,At=ue.firstChild,ve=ue.nextSibling,fe=ve.nextSibling,ke=fe.firstChild,_e=fe.nextSibling,ce=_e.firstChild,Lt=ce.firstChild,z=ce.nextSibling,be=z.nextSibling,Et=be.firstChild,pe=be.nextSibling,ge=_e.nextSibling;r(l,f(jt,{get title(){return n.formatMessage(o.profile.title)}}),i),r(l,f(Vt,{get title(){return n.formatMessage(o.profile.title)}}),i),r(_,f(U,{get when(){return q()},get children(){const e=me();return r(e,f(st,{})),v(()=>a(e,t.uploadingOverlay)),e}}),null),r(_,f(U,{get when(){return Ae()},get fallback(){return(()=>{const e=En(),u=e.firstChild,m=u.firstChild;return r(m,()=>n.formatMessage(o.profile.uploadBanner)),v(()=>a(e,t.bannerPlaceholder)),e})()},get children(){const e=wn(),u=e.firstChild,m=u.nextSibling;return u.addEventListener("error",pt),r(m,()=>n.formatMessage(o.profile.uploadBanner)),v(()=>h(u,"src",Ae())),e}}),null),r(i,f(U,{get when(){return s?.userProfile&&!s?.isFetching},get children(){const e=An(),u=e.firstChild,m=u.firstChild,S=m.firstChild,C=S.firstChild,w=S.nextSibling,A=w.firstChild;return r(u,f(U,{get when(){return q()},get children(){const d=me();return r(d,f(st,{})),v(()=>a(d,t.uploadingOverlay)),d}}),m),r(S,f(it,{get src(){return Q()},size:"xxl"}),C),r(C,()=>n.formatMessage(o.profile.uploadAvatar)),r(w,f(it,{get src(){return Q()},size:"lg"}),A),r(A,()=>n.formatMessage(o.profile.uploadAvatar)),v(d=>{const T=t.userImage,k=t.avatar,H=t.desktopAvatar,N=t.uploadAction,W=t.phoneAvatar,F=t.uploadAction;return T!==d._v$&&a(e,d._v$=T),k!==d._v$2&&a(u,d._v$2=k),H!==d._v$3&&a(S,d._v$3=H),N!==d._v$4&&a(C,d._v$4=N),W!==d._v$5&&a(w,d._v$5=W),F!==d._v$6&&a(A,d._v$6=F),d},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0}),e}}),$),r(B,f(Qt,{hideLabel:!0,get publicKey(){return p?.publicKey},get nip05(){return p?.activeUser?.nip05},get openSockets(){return ct()},get file(){return q()},onFail:()=>{P?.sendWarning(n.formatMessage($e.fail,{file:q()?.name})),O()},onRefuse:e=>{e==="file_too_big_100"&&P?.sendWarning(n.formatMessage($e.fileTooBigRegular)),e==="file_too_big_1024"&&P?.sendWarning(n.formatMessage($e.fileTooBigPremium)),O()},onCancel:()=>{O()},onSuccsess:e=>{Me()==="picture"&&X(e),Me()==="banner"&&Y(e),O()}}));const He=L;typeof He=="function"?V(He,g):L=g,g.addEventListener("change",()=>Ee("picture",L)),g.hidden=!0,r(xt,()=>n.formatMessage(o.profile.uploadAvatar));const Ne=E;typeof Ne=="function"?V(Ne,I):E=I,I.addEventListener("change",()=>Ee("banner",E)),I.hidden=!0,r(St,()=>n.formatMessage(o.profile.uploadBanner)),ee.addEventListener("submit",ht),r(Ie,()=>n.formatMessage(o.profile.name.label)),r(ne,()=>n.formatMessage(o.profile.required),null),y.$$input=mt;const We=G;typeof We=="function"?V(We,y):G=y,r(ee,f(U,{get when(){return!Pe()},get children(){const e=me();return r(e,()=>n.formatMessage(o.profile.name.error)),v(()=>a(e,t.inputError)),e}}),R),r(yt,()=>n.formatMessage(o.profile.displayName.label)),r(Mt,()=>n.formatMessage(o.profile.website.label)),r(Ct,()=>n.formatMessage(o.profile.about.label)),M.$$input=Le;const Fe=j;return typeof Fe=="function"?V(Fe,M):j=M,r(wt,()=>n.formatMessage(o.profile.lud16.label)),r(At,()=>n.formatMessage(o.profile.nip05.label)),ke.$$click=()=>ft(!J()),r(Lt,()=>n.formatMessage(o.profile.picture.label)),z.addEventListener("change",e=>{const u=e.target;u.value&&X(u.value)}),r(Et,()=>n.formatMessage(o.profile.banner.label)),pe.addEventListener("change",e=>{const u=e.target;u.value&&Y(u.value)}),r(ge,f(Gt,{type:"submit",get disabled(){return!Pe()},get children(){return n.formatMessage(rt.save)}}),null),r(ge,f(Jt,{type:"button",onClick:()=>xe(he?.actions.profileLink(p?.publicKey)||""),get children(){return n.formatMessage(rt.cancel)}}),null),v(e=>{const u=t.container,m=t.fullHeader,S=`${t.banner} ${bt()}`,C=t.uploadActions,w=t.uploader,A=t.uploadButton,d=t.uploadButton,T=t.inputLabel,k=t.required,H=t.star,N=t.inputWithPrefix,W=t.inputPrefix,F=t.inputWithPrefix,Ue=n.formatMessage(o.profile.name.placeholder),Ke=t.inputLabel,qe=n.formatMessage(o.profile.displayName.placeholder),Oe=t.inputLabel,Re=n.formatMessage(o.profile.website.placeholder),ze=t.inputLabel,De=n.formatMessage(o.profile.about.placeholder),Ve=t.inputLabel,je=n.formatMessage(o.profile.lud16.placeholder),Ge=t.inputLabel,Je=n.formatMessage(o.profile.nip05.placeholder),Qe=t.moreTrigger,Xe=`${J()?t.shown:t.hidden}`,Ye=`${t.moreInputs} ${J()?t.show:t.hide}`,Ze=t.inputLabel,et=n.formatMessage(o.profile.picture.placeholder),tt=t.inputLabel,nt=n.formatMessage(o.profile.banner.placeholder),at=t.formSubmit;return u!==e._v$7&&a(l,e._v$7=u),m!==e._v$8&&a(i,e._v$8=m),S!==e._v$9&&a(_,e._v$9=S),C!==e._v$10&&a($,e._v$10=C),w!==e._v$11&&a(B,e._v$11=w),A!==e._v$12&&a(c,e._v$12=A),d!==e._v$13&&a(Be,e._v$13=d),T!==e._v$14&&a(te,e._v$14=T),k!==e._v$15&&a(ne,e._v$15=k),H!==e._v$16&&a(Pt,e._v$16=H),N!==e._v$17&&a(ae,e._v$17=N),W!==e._v$18&&a(Te,e._v$18=W),F!==e._v$19&&a(y,e._v$19=F),Ue!==e._v$20&&h(y,"placeholder",e._v$20=Ue),Ke!==e._v$21&&a(R,e._v$21=Ke),qe!==e._v$22&&h(ie,"placeholder",e._v$22=qe),Oe!==e._v$23&&a(re,e._v$23=Oe),Re!==e._v$24&&h(le,"placeholder",e._v$24=Re),ze!==e._v$25&&a(oe,e._v$25=ze),De!==e._v$26&&h(M,"placeholder",e._v$26=De),Ve!==e._v$27&&a(se,e._v$27=Ve),je!==e._v$28&&h(de,"placeholder",e._v$28=je),Ge!==e._v$29&&a(ue,e._v$29=Ge),Je!==e._v$30&&h(ve,"placeholder",e._v$30=Je),Qe!==e._v$31&&a(fe,e._v$31=Qe),Xe!==e._v$32&&a(ke,e._v$32=Xe),Ye!==e._v$33&&a(_e,e._v$33=Ye),Ze!==e._v$34&&a(ce,e._v$34=Ze),et!==e._v$35&&h(z,"placeholder",e._v$35=et),tt!==e._v$36&&a(be,e._v$36=tt),nt!==e._v$37&&h(pe,"placeholder",e._v$37=nt),at!==e._v$38&&a(ge,e._v$38=at),e},{_v$7:void 0,_v$8:void 0,_v$9:void 0,_v$10:void 0,_v$11:void 0,_v$12:void 0,_v$13:void 0,_v$14:void 0,_v$15:void 0,_v$16:void 0,_v$17:void 0,_v$18:void 0,_v$19:void 0,_v$20:void 0,_v$21:void 0,_v$22:void 0,_v$23:void 0,_v$24:void 0,_v$25:void 0,_v$26:void 0,_v$27:void 0,_v$28:void 0,_v$29:void 0,_v$30:void 0,_v$31:void 0,_v$32:void 0,_v$33:void 0,_v$34:void 0,_v$35:void 0,_v$36:void 0,_v$37:void 0,_v$38:void 0}),v(()=>y.value=s?.userProfile?.name||""),v(()=>ie.value=s?.userProfile?.displayName||s?.userProfile?.display_name||""),v(()=>le.value=s?.userProfile?.website||""),v(()=>M.value=s?.userProfile?.about||""),v(()=>de.value=s?.userProfile?.lud16||""),v(()=>ve.value=s?.userProfile?.nip05||""),v(()=>z.value=Q()||""),v(()=>pe.value=Se()||""),l})()},"EditProfile");Ot(["input","click"]);export{Vn as default};
//# sourceMappingURL=EditProfile-e293fc2a.js.map
