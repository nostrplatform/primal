var S=Object.defineProperty;var l=(v,m)=>S(v,"name",{value:m,configurable:!0});import{U as x,u as D,D as P,E as F,N as E,e2 as T,T as w,e3 as K,e4 as L,c as o,j as p,F as M,H as j,M as N,l as k,m as f,S as q,t as H}from"./index-64dc6460.js";import{A as J}from"./ArticlePreview-3d0aa4c8.js";import{L as O}from"./Loader-1ac7e304.js";import{N as Q}from"./Note-f0f70728.js";import{P as R}from"./PageCaption-27eb7f4c.js";import{P as U}from"./Paginator-4878ac5b.js";import{s as d}from"./FeedsTest.module-c5555bee.js";import"./dates-9bcb2bf7.js";import"./ParsedNote-9900e3c8.js";import"./ButtonGhost-a0fa1826.js";import"./Buttons.module-e818c1ea.js";import"./5WXHJDCZ-8b9b8e69.js";import"./index-b4296c5e.js";import"./ButtonPrimary-1f64caa8.js";const z=H("<div><div><div></div></div><div><div>"),ce=l(()=>{const v=x(),m=D(),[s,A]=P({id:"",name:"",description:"",specification:"",category:""}),[c,h]=P([]);F(()=>{I(v.query)}),F(()=>{s.id.length>0&&(h(()=>[]),_())});const I=l(t=>{const n=`advanced_feed_${w}`,r=E(n,{onEvent:(a,i)=>{let u=JSON.parse(i.content||"[]").find(g=>g.id===t);A(()=>({...u}))},onEose:()=>{r()}});T(n)},"fetchAdvancedFeeds"),_=l(async(t=0,n=0)=>{const r=`feed_items_${s.id}_${w}`;if(s.category==="notes"){const a=await K(m?.publicKey,s.specification,r,20,t,n);h(i=>[...i,...a]);return}if(s.category==="reads"){const a=await L(m?.publicKey,s.specification,r,20,t,n);h(i=>[...i,...a]);return}},"fetchFeedItems"),C=l(()=>{if(s.category==="notes"){const t=c[c.length-1],n=t.msg.created_at,r=c.filter(a=>a.msg.created_at===n).length;_(t.msg.created_at,r)}if(s.category==="reads"){const t=c[c.length-1],n=t.published,r=c.filter(a=>a.published===n).length;_(t.published,r)}},"onNextPage");return o(q,{get when(){return s.id.length>0},get fallback(){return o(O,{})},get children(){return[o(R,{get title(){return s.name}}),(()=>{const t=z(),n=t.firstChild,r=n.firstChild,a=n.nextSibling,i=a.firstChild;return p(r,()=>s.description),p(i,o(M,{each:c,children:e=>o(j,{get children(){return[o(N,{get when(){return s.category==="notes"},get children(){return o(Q,{note:e,noteType:"feed"})}}),o(N,{get when(){return s.category==="reads"},get children(){return o(J,{article:e})}})]}})}),null),p(i,o(U,{loadNextPage:C}),null),k(e=>{const u=d.page,g=d.section,$=d.feedDescription,y=`${d.section} ${d.borderless}`,b=d.list;return u!==e._v$&&f(t,e._v$=u),g!==e._v$2&&f(n,e._v$2=g),$!==e._v$3&&f(r,e._v$3=$),y!==e._v$4&&f(a,e._v$4=y),b!==e._v$5&&f(i,e._v$5=b),e},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0}),t})()]}})},"FeedsQueryTest");export{ce as default};
//# sourceMappingURL=FeedQueryTest-7cb3e4ac.js.map
