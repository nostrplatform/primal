{"version":3,"mappings":"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","names":["zapNote","__name","note","sender","amount","comment","relays","callback","getZapEndpoint","sats","payload","r","zapReq","nip57","signedEvent","signEvent","event","pr","enableWebLn","sendPayment","reason","zapArticle","Kind","t","zapProfile","profile","zapDVM","dvm","author","a","user","lnurl","lud06","lud16","name","domain","words","bech32","data","utils","body","err","logError","canUserReceiveZaps","PrimalMenuItem","props","icon","setIcon","createSignal","getIcon","item","__variableDynamicImportRuntimeHelper","then","ic","default","warningClass","warning","styles","reverseClass","reverse","onMount","_$createComponent","Show","when","separator","fallback","_el$4","_tmpl$","_$effect","_$className","children","_el$","_tmpl$2","_el$2","firstChild","$$click","e","preventDefault","stopPropagation","action","_$insert","label","_el$3","_$p","_$style","_p$","_v$","id","_v$2","contextOption","_$setAttribute","undefined","PrimalMenuItem$1","hookForDev","_$delegateEvents","PrimalMenu","positionClass","position","noteContext","noteFooter","orientationClass","orientation","contextMenuOptions","contextMenuOptionsUp","For","each","items","_v$3","hidden","ZapAnimation","_ref$","ref","_$use","_$owner","_$getOwner","src","class","buttonTypeClasses","zap","zapType","like","likeType","reply","replyType","repost","repostType","NoteFooterActionButton","nextSibling","_$addEventListener","onTouchEnd","onTouchStart","onMouseUp","onMouseDown","onClick","type","post","stat","highlighted","disabled","_v$4","large","_v$5","_v$6","_v$7","statNumber","BookmarkNote","account","useAccountContext","app","useAppContext","intl","useIntl","isBookmarked","setIsBookmarked","bookmarkInProgress","setBookmarkInProgress","createEffect","bookmarks","includes","updateBookmarks","bookmarkTags","reduce","acc","date","Math","floor","Date","getTime","actions","saveBookmarks","publicKey","success","sendBookmarks","proxyThroughPrimal","activeRelays","relaySettings","triggerImportEvents","APP_ID","addBookmark","find","b","bookmarksToAdd","length","logWarning","openConfirmModal","title","formatMessage","tBookmarks","confirm","description","confirmLabel","abortLabel","abort","onConfirm","closeConfirmModal","onAbort","removeBookmark","filter","titleZero","descriptionZero","confirmZero","abortZero","doBookmark","remove","unsub","subsTo","onEvent","_","content","kind","Bookmarks","tags","onEose","getBookmarks","ButtonGhost","right","rightL","emptyBookmark","fullBookmark","bookmark","lottieDuration","zapMD","op","fr","NoteFooter","toast","useToastContext","settings","useSettingsContext","medZapAnimation","quickZapDelay","footerDiv","repostMenu","size","repostMenuItems","doRepost","doQuote","onClickOutside","document","getElementById","contains","target","updateState","state","isRepostMenuVisible","addEventListener","removeEventListener","showRepostMenu","hasPublicKey","showGetStarted","quoteNote","noteId","showNewNoteForm","sendWarning","noRelaysConnected","sendRepost","batch","sendSuccess","repostSuccess","repostFailed","doReply","doLike","addLike","l","startZap","zapUnavailable","setTimeout","customZapInfo","openCustomZapModal","commitZap","clearTimeout","customZap","doQuickZap","animateZap","newLeft","newTop","style","left","top","onAnimDone","seek","play","console","warn","defaultZap","message","emoji","z","onZapAnim","onSuccess","onFail","showZapAnim","determineOrient","coor","getScreenCordinates","height","y","window","innerHeight","scrollY","_el$5","_el$6","largeZapLottie","mediumZapLottie","r$","_ref$2","replied","_$memo","replies","truncateNumber","toLocaleString","zapped","isZapping","satsZapped","hideZapIcon","liked","likes","_ref$3","_c$","reposts","footer","reposted","_v$8","_v$9","bookmarkFoot","NoteFooter$1","EmbeddedNote","threadContext","useThreadContext","noteContent","reactionsState","updateReactionsState","createStore","noteActions","zapCount","zaps","satszapped","zappedAmount","zappedNow","moreZapsAvailable","topZaps","topZapsFeed","quoteCount","nip19","noteEncode","navToThread","setPrimaryNote","createMemo","trimVerification","nip05","klass","k","mentionedNote","isLast","alternativeBackground","altBack","embedLevel","embededContentWrapper","wrapper","includeEmbeds","A","href","onConfirmZap","zapOption","closeCustomZapModal","onSuccessZap","resetCustomZap","onFailZap","onCancelZap","onCancel","_tmpl$3","_el$7","Avatar","_el$10","userName","VerificationCheck","nip05Verification","verifiedBy","created_at","mentionedNoteHeader","postInfo","userInfo","time","_v$10","_el$8","ParsedNote","shorten","isEmbeded","rootNote","width","getBoundingClientRect","margins","noLinks","_el$9","hideFooter","footerSize","createElement","className","tagName","appendToEl","el","toTransformString","x","scale","propValue","setWidthHeight","w","h","LOAD_STATE","specialKeyUsed","getElementsFromOption","option","legacySelector","parent","elements","selector","isPswpClass","fn","isSafari","_PhotoSwipeEvent","details","PhotoSwipeEvent","_Eventable","priority","_this$_filters$name","_this$_filters$name2","_this$pswp","f1","f2","args","_this$_filters$name3","_this$_listeners$name","_this$pswp2","_this$pswp3","listener","_this$_listeners$name2","Eventable","_Placeholder","imageSrc","container","imgEl","_this$element","Placeholder","_Content","itemData","instance","index","isLazy","reload","placeholderEl","placeholderSrc","_this$data$src","_this$data$alt","imageElement","slide","isInitialSizeUpdate","image","sizesWidth","_this$instance$option","_this$instance$option2","errorMsgEl","supportsDecode","Content","getViewportSize","options","pswp","newViewportSize","parsePaddingOption","prop","viewportSize","paddingValue","legacyPropName","getPanAreaSize","MAX_IMAGE_WIDTH","_ZoomLevel","maxWidth","maxHeight","panAreaSize","elementSize","hRatio","vRatio","optionPrefix","optionName","optionValue","currZoomLevel","ZoomLevel","lazyLoadData","zoomLevel","lazyLoadSlide","_PhotoSwipeBase","_this$options","numItems","dataSource","slideData","_this$options2","dataSourceItem","galleryElement","_this$options3","_this$options4","element","linkEl","thumbnailEl","_thumbnailEl$getAttri","PhotoSwipeBase","_PhotoSwipeLightbox","initialPoint","clickedIndex","clickedTarget","clickedChildIndex","child","galleryElements","promiseArray","pswpModuleType","uid","iterableModules","mainModule","module","PhotoSwipeLightbox","exports","assertNumber","n","chain","wrap","c","encode","i","decode","alphabet","digits","input","letter","join","from","to","padding","bits","chr","end","normalize","convertRadix","pos","res","d","carry","done","digit","digitBase","gcd","radix2carry","convertRadix2","mask","radix","num","bytes","radix2","revPadding","unsafeWrapper","checksum","len","newChecksum","oldChecksum","s","genBase58","abc","XMR_BLOCK_LEN","block","str","slice","blockLen","j","base58check","sha256","BECH_ALPHABET","POLYMOD_GENERATORS","bech32Polymod","pre","chk","bechChecksum","prefix","encodingConst","v","genBech32","encoding","ENCODING_CONST","_words","fromWords","toWords","fromWordsUnsafe","limit","actualLength","lowered","sepIndex","sum","decodeUnsafe","decodeToBytes","CODERS","coderTypeError","bytesToString","stringToBytes","hex","utf8","require$$0","DEFAULTNETWORK","TESTNETWORK","SIGNETNETWORK","REGTESTNETWORK","SIMNETWORK","FEATUREBIT_ORDER","DIVISORS","MAX_MILLISATS","MILLISATS_PER_BTC","TAGCODES","TAGNAMES","keys","currentName","currentCode","TAGPARSERS","wordsToIntBE","routingInfoParser","featureBitsParser","getUnknownParser","tagCode","total","routes","pubkey","shortChannelId","feeBaseMSats","feeProportionalMillionths","cltvExpiryDelta","routesBuffer","bools","word","finalArr","itemArr","featureBits","featureName","status","extraBits","result","bit","hrpToMillisat","hrpString","outputString","divisor","value","valueBN","millisatoshisBN","paymentRequest","network","sections","decoded","letters","sigWords","prefixMatches","bech32Prefix","coinNetwork","millisatoshis","timestamp","parser","tagLength","tagWords","exp","getValue","section","bolt11","subTo","socket","subId","cb","subscriptionId","sendMessage","Lnbc","invoice","setInvoice","emptyInvoice","invoiceCopied","setInvoiceCopied","paymentInProgress","setPaymentInProgress","dec","lnbc","reconcile","isLightning","expiryDate","expiry","created","hasExpired","humanizeNumber","parseInt","decodeURI","confirmPayment","lnInvoice","payInvoice","inactive","walletSocket","WebSocket","logInfo","close","JSON","stringify","subwallet","target_lud16","note_for_recipient","note_for_self","WALLET_OPERATION","ceil","cache","operation_event","alternative","lnbcAlter","noBack","_el$11","_el$12","_el$13","Loader","paymentOverlay","lnIcon","openLnbcModal","closeLnbcModal","shrink","qrIcon","_el$16","_tmpl$4","_el$17","_v$11","copyDone","_v$12","checkIcon","navigator","clipboard","writeText","copyIcon","_el$18","expired","expiredDate","_el$14","expires","dateFuture","_el$15","ButtonPrimary","pay","payAction","header","headerActions","Lnbc$1","defaultAvatarDark","defaultAvatarLight","noop","noopTransition","createSwitchTransition","source","initSource","untrack","initReturned","onEnter","onExit","returned","setReturned","isTransitionPending","useTransition","next","isExiting","exitTransition","after","p","enterTransition","triggerTransitions","prev","createComputed","createListTransition","onChange","prevSet","exiting","toRemove","setToRemove","finishRemoved","els","handleRemoved","elsToRemove","sourceList","$TRACK","nextSet","added","removed","unchanged","nothingChanged","createClassnames","nextFrame","classes","events","onBeforeEnter","onAfterEnter","endTransition","onBeforeExit","onAfterExit","TRANSITION_MODE_MAP","Transition","classnames","resolveFirst","TransitionGroup","resolveElements","list","toMove","moved","rect","newRect","dX","dY","endTransition2","NoteTopZapsCompact","dontAnimate","setDontAnimate","topZapLimit","zapSender","activeUser","mentionedUsers","enterClass","topZapEnterTransition","exitClass","topZapExitTransition","zapWrap","noAnimation","topZap","compact","zapHighlightsTiny","NoteTopZapsTiny","isDev","localStorage","getItem","ArticleCompactPreview","media","useMediaContext","navigate","useNavigate","article","articlePreview","missingCacheImage","setMissingChacheImage","articleImage","url","m","getMediaUrl","authorAvatar","picture","onImageLoaded","onRender","onImageError","endsWith","theme","onerror","countLines","divHeight","offsetHeight","lineHeight","computedStyleMap","get","lines","contentStyle","setContentStyle","summary","tt","querySelector","ss","titleLines","conetntStyles","t1","t2","articleUrl","vanityName","verifiedUsers","naddr","identifier","articleCompact","_el$25","placeholderImage","_el$24","_el$19","_el$20","_el$21","_el$22","_el$23","shortDate","published","wordCount","wordsPerMinute","profileLink","hideMessage","articleInfo","text","_v$13","_v$14","_v$15","_v$16","estimate","_v$17","comments","_v$18","commentIcon","_v$19","commentCount","_v$20","_v$21","zapIcon","ProfileNoteZap","userNpub","hexToNpub","npub","subject","link","msg","Text","sub","LongForm","Metadata","about","bullet","_tmpl$5","receiver","reciver","contentZap","zapInfo","number","groupGridLimit","dev","noteWidth","thisNote","lightbox","gallery","showHideAnimationType","initialZoomLevel","secondaryZoomLevel","maxZoomLevel","thumbSelector","pswpModule","__vitePreload","noLightbox","init","tokens","setTokens","wordsDisplayed","setWordsDisplayed","isNoteTooLong","shortNoteWords","charLimit","shortNoteChars","nextWordBreak","search","parseContent","ignoreLinebreaks","replace","linebreakRegex","split","removeLinebreaks","lastSignificantContent","lastIndex","lastGroup","setContent","meta","removedBy","removedTokens","updateContent","contentArray","token","isAfterEmbed","totalLinks","parseToken","isInterpunction","isUrl","indexOf","matched","match","urlExtractRegex","suffix","substring","ignoreMedia","isImage","isMp4Video","videoType","isOggVideo","isWebmVideo","isYouTube","isSpotify","isTwitch","isMixCloud","isSoundCloud","isAppleMusic","isWavelake","preview","getLinkPreview","noPreviews","images","some","isNoteMention","isUserMention","isAddrMention","isTagMention","isHashtag","isCustomEmoji","isUnitifedLnAddress","lnbcToken","lnUnifiedRegex","startsWith","isLnbc","generateContent","lastMediaIndex","findLastIndex","lastContent","every","cont","renderLinebreak","min","lineBreaks","Array","fill","renderText","trim","push","replaceAll","renderImage","groupCount","imageGroup","generatePrivateKey","imageError","lastClass","getMedia","media_url","getMediaUrlDefault","imageThumb","NoteImage","mediaThumb","shortHeight","onError","gridClass","plainBorder","forceHeight","renderVideo","mVideo","ratio","shortMentionInWords","video","muted","loop","playsInline","addVideo","renderYouTube","youtubeId","RegExp","$1","renderSpotify","convertedUrl","renderTwitch","location","hostname","_tmpl$6","renderMixCloud","feedPath","$2","_tmpl$7","renderSoundCloud","_tmpl$8","renderAppleMusic","isSongLink","test","_tmpl$9","renderWavelake","_tmpl$10","renderLinks","LinkPreview","bordered","_tmpl$11","unknownEvents","setUnknownEvents","unknownMention","nid","decodeIdentifier","alt","evs","getEvents","_tmpl$13","unknownEvent","bang","_tmpl$12","file","getParametrizedEvent","_el$26","_el$27","_el$28","_el$29","_el$30","renderComunityMention","specialCharsRegex","exec","rn","reEncoded","naddrEncode","mentionedArticles","mention","renderLongFormMention","_el$31","hideContext","boredered","renderNoteMention","eventId","_el$32","_tmpl$14","mentionedNotes","mentionedHighlights","f","ment","LongFormShell","_el$33","altEmbeds","Highlight","_el$34","mentionedHighlight","Zap","zapContent","zapEvent","parse","zappedId","zappedKind","zapTagA","zapTagE","zapSubject","parseBolt11","renderUserMention","nostr","profileId","path","truncateNpub","_el$35","_tmpl$15","_el$36","_el$37","_tmpl$16","_el$38","MentionedUserLink","_el$39","_tmpl$17","error","renderTagMention","tag","embeded","_el$40","_el$41","_el$43","_el$44","_tmpl$18","_el$46","_el$47","_el$48","_el$49","_el$51","_el$53","_el$55","_tmpl$19","renderHashtag","term","hashtagCharsRegex","_el$57","_tmpl$20","_el$59","renderEmoji","_el$61","_tmpl$21","_el$62","renderLnbc","renderContent","renderers","linebreak","youtube","spotify","twitch","mixcloud","soundcloud","applemusic","wavelake","notemention","usermention","comunity","tagmention","hashtag","_el$63","_el$64","_tmpl$22","_el$65","_el$66","seeMore","more","parsedNote","veryShort","shortNote"],"sources":["../../src/lib/zap.ts","../../src/components/PrimalMenu/PrimalMenuItem.tsx","../../src/components/PrimalMenu/PrimalMenu.tsx","../../src/components/ZapAnimation/ZapAnimation.tsx","../../src/components/Note/NoteFooter/NoteFooterActionButton.tsx","../../src/components/BookmarkNote/BookmarkNote.tsx","../../src/components/Note/NoteFooter/NoteFooter.tsx","../../src/components/EmbeddedNote/EmbeddedNote.tsx","../../node_modules/photoswipe/dist/photoswipe-lightbox.esm.js","../../node_modules/light-bolt11-decoder/node_modules/@scure/base/lib/index.js","../../node_modules/light-bolt11-decoder/bolt11.js","../../src/lib/sockets.ts","../../src/components/Lnbc/Lnbc.tsx","../../src/assets/images/reads_image_dark.png","../../src/assets/images/reads_image_light.png","../../node_modules/@solid-primitives/transition-group/dist/index.js","../../node_modules/solid-transition-group/dist/index.js","../../src/components/Note/NoteTopZapsTiny.tsx","../../src/components/ArticlePreview/ArticleCompactPreview.tsx","../../src/components/ProfileNoteZap/ProfileNoteZap.tsx","../../src/components/ParsedNote/ParsedNote.tsx"],"sourcesContent":["import { bech32 } from \"@scure/base\";\nimport { nip57, Relay, utils } from \"../lib/nTools\";\nimport { Tier } from \"../components/SubscribeToAuthorModal/SubscribeToAuthorModal\";\nimport { Kind } from \"../constants\";\nimport { NostrRelaySignedEvent, PrimalArticle, PrimalDVM, PrimalNote, PrimalUser } from \"../types/primal\";\nimport { logError } from \"./logger\";\nimport { enableWebLn, sendPayment, signEvent } from \"./nostrAPI\";\n\nexport const zapNote = async (note: PrimalNote, sender: string | undefined, amount: number, comment = '', relays: Relay[]) => {\n  if (!sender) {\n    return false;\n  }\n\n  const callback = await getZapEndpoint(note.user);\n\n  if (!callback) {\n    return false;\n  }\n\n  const sats = Math.round(amount * 1000);\n\n  let payload = {\n    profile: note.pubkey,\n    event: note.id,\n    amount: sats,\n    relays: relays.map(r => r.url)\n  };\n\n  if (comment.length > 0) {\n    // @ts-ignore\n    payload.comment = comment;\n  }\n\n  const zapReq = nip57.makeZapRequest(payload);\n\n  try {\n    const signedEvent = await signEvent(zapReq);\n\n    const event = encodeURIComponent(JSON.stringify(signedEvent));\n\n    const r2 = await (await fetch(`${callback}?amount=${sats}&nostr=${event}`)).json();\n    const pr = r2.pr;\n\n    await enableWebLn();\n    await sendPayment(pr);\n\n    return true;\n  } catch (reason) {\n    console.error('Failed to zap: ', reason);\n    return false;\n  }\n}\n\nexport const zapArticle = async (note: PrimalArticle, sender: string | undefined, amount: number, comment = '', relays: Relay[]) => {\n  if (!sender) {\n    return false;\n  }\n\n  const callback = await getZapEndpoint(note.user);\n\n  if (!callback) {\n    return false;\n  }\n\n  const a = `${Kind.LongForm}:${note.pubkey}:${(note.msg.tags.find(t => t[0] === 'd') || [])[1]}`;\n\n  const sats = Math.round(amount * 1000);\n\n  let payload = {\n    profile: note.pubkey,\n    event: note.msg.id,\n    amount: sats,\n    relays: relays.map(r => r.url)\n  };\n\n  if (comment.length > 0) {\n    // @ts-ignore\n    payload.comment = comment;\n  }\n\n  const zapReq = nip57.makeZapRequest(payload);\n\n  if (!zapReq.tags.find((t: string[]) => t[0] === 'a' && t[1] === a)) {\n    zapReq.tags.push(['a', a]);\n  }\n\n  try {\n    const signedEvent = await signEvent(zapReq);\n\n    const event = encodeURIComponent(JSON.stringify(signedEvent));\n\n    const r2 = await (await fetch(`${callback}?amount=${sats}&nostr=${event}`)).json();\n    const pr = r2.pr;\n\n    await enableWebLn();\n    await sendPayment(pr);\n\n    return true;\n  } catch (reason) {\n    console.error('Failed to zap: ', reason);\n    return false;\n  }\n}\n\nexport const zapProfile = async (profile: PrimalUser, sender: string | undefined, amount: number, comment = '', relays: Relay[]) => {\n  if (!sender || !profile) {\n    return false;\n  }\n\n  const callback = await getZapEndpoint(profile);\n\n  if (!callback) {\n    return false;\n  }\n\n  const sats = Math.round(amount * 1000);\n\n  let payload = {\n    profile: profile.pubkey,\n    amount: sats,\n    relays: relays.map(r => r.url)\n  };\n\n  if (comment.length > 0) {\n    // @ts-ignore\n    payload.comment = comment;\n  }\n  const zapReq = nip57.makeZapRequest(payload);\n\n  try {\n    const signedEvent = await signEvent(zapReq);\n\n    const event = encodeURIComponent(JSON.stringify(signedEvent));\n\n    const r2 = await (await fetch(`${callback}?amount=${sats}&nostr=${event}`)).json();\n    const pr = r2.pr;\n\n    await enableWebLn();\n    await sendPayment(pr);\n\n    return true;\n  } catch (reason) {\n    console.error('Failed to zap: ', reason);\n    return false;\n  }\n}\n\nexport const zapSubscription = async (subEvent: NostrRelaySignedEvent, recipient: PrimalUser, sender: string | undefined, relays: Relay[], exchangeRate?: Record<string, Record<string, number>>) => {\n  if (!sender || !recipient) {\n    return false;\n  }\n\n  const callback = await getZapEndpoint(recipient);\n\n  if (!callback) {\n    return false;\n  }\n\n  const costTag = subEvent.tags.find(t => t [0] === 'amount');\n  if (!costTag) return false;\n\n  let sats = 0;\n\n  if (costTag[2] === 'sats') {\n    sats = parseInt(costTag[1]) * 1_000;\n  }\n\n  if (costTag[2] === 'msat') {\n    sats = parseInt(costTag[1]);\n  }\n\n  if (costTag[2] === 'USD' && exchangeRate && exchangeRate['USD']) {\n    let usd = parseFloat(costTag[1]);\n    sats = Math.ceil(exchangeRate['USD'].sats * usd * 1_000);\n  }\n\n  let payload = {\n    profile: recipient.pubkey,\n    event: subEvent.id,\n    amount: sats,\n    relays: relays.map(r => r.url)\n  };\n\n  if (subEvent.content.length > 0) {\n    // @ts-ignore\n    payload.comment = comment;\n  }\n\n  const zapReq = nip57.makeZapRequest(payload);\n\n  try {\n    const signedEvent = await signEvent(zapReq);\n\n    const event = encodeURIComponent(JSON.stringify(signedEvent));\n\n    const r2 = await (await fetch(`${callback}?amount=${sats}&nostr=${event}`)).json();\n    const pr = r2.pr;\n\n    await enableWebLn();\n    await sendPayment(pr);\n\n    return true;\n  } catch (reason) {\n    console.error('Failed to zap: ', reason);\n    return false;\n  }\n}\n\nexport const zapDVM = async (dvm: PrimalDVM, author: PrimalUser, sender: string | undefined, amount: number, comment = '', relays: Relay[]) => {\n  if (!sender) {\n    return false;\n  }\n\n  const callback = await getZapEndpoint(author);\n\n  if (!callback) {\n    return false;\n  }\n\n  const a = `${Kind.DVM}:${dvm.pubkey}:${dvm.identifier}`;\n\n  const sats = Math.round(amount * 1000);\n\n  let payload = {\n    profile: dvm.pubkey,\n    event: dvm.id,\n    amount: sats,\n    relays: relays.map(r => r.url)\n  };\n\n  if (comment.length > 0) {\n    // @ts-ignore\n    payload.comment = comment;\n  }\n\n  const zapReq = nip57.makeZapRequest(payload);\n\n  if (!zapReq.tags.find((t: string[]) => t[0] === 'a' && t[1] === a)) {\n    zapReq.tags.push(['a', a]);\n  }\n\n  try {\n    const signedEvent = await signEvent(zapReq);\n\n    const event = encodeURIComponent(JSON.stringify(signedEvent));\n\n    const r2 = await (await fetch(`${callback}?amount=${sats}&nostr=${event}`)).json();\n    const pr = r2.pr;\n\n    await enableWebLn();\n    await sendPayment(pr);\n\n    return true;\n  } catch (reason) {\n    console.error('Failed to zap: ', reason);\n    return false;\n  }\n}\n\nexport const getZapEndpoint = async (user: PrimalUser): Promise<string | null>  => {\n  try {\n    let lnurl: string = ''\n    let {lud06, lud16} = user;\n\n    if (lud16) {\n      let [name, domain] = lud16.split('@')\n      lnurl = `https://${domain}/.well-known/lnurlp/${name}`\n    }\n    else if (lud06) {\n      let {words} = bech32.decode(lud06, 1023)\n      let data = bech32.fromWords(words)\n      lnurl = utils.utf8Decoder.decode(data)\n    }\n    else {\n      return null;\n    }\n\n    let res = await fetch(lnurl)\n    let body = await res.json()\n\n    if (body.allowsNostr && body.nostrPubkey) {\n      return body.callback;\n    }\n  } catch (err) {\n    logError('Error zapping: ', err);\n    return null;\n    /*-*/\n  }\n\n  return null;\n}\n\nexport const canUserReceiveZaps = (user: PrimalUser | undefined) => {\n  return !!user && (!!user.lud16 || !!user.lud06);\n}\n","import { Component, createSignal, onMount, Show } from \"solid-js\";\nimport { hookForDev } from \"../../lib/devTools\";\nimport { MenuItem } from \"../../types/primal\";\nimport styles from  \"./PrimalMenuItem.module.scss\";\n\n\nconst PrimalMenuItem: Component<{\n  item: MenuItem,\n  reverse?: boolean,\n  id?: string,\n}> = (props) => {\n\n  const [icon, setIcon] = createSignal<string>()\n\n  const getIcon = () => {\n    if (!props.item.icon) {\n      return;\n    }\n\n    import(`../../assets/icons/${props.item.icon}.svg`).then((ic) => {\n      setIcon(ic.default);\n    });\n  };\n\n  const warningClass= () => props.item.warning ? styles.warning : '';\n\n  const reverseClass= () => props.reverse ? styles.reverse : '';\n\n  onMount(getIcon);\n\n  return (\n    <Show\n      when={!props.item.separator}\n      fallback={<div class={styles.separator}></div>}\n    >\n      <button\n        id={props.id}\n        onClick={(e: MouseEvent) => {\n          e.preventDefault();\n          e.stopPropagation();\n          props.item.action();\n        }}\n        class={`${styles.contextOption} ${warningClass()}  ${reverseClass()}`}\n      >\n\n        <span>\n          {props.item.label}\n        </span>\n        <Show when={icon()}>\n          <div style={`-webkit-mask: url(${icon()}) no-repeat 0 / 100%; mask: url(${icon()}) no-repeat 0 / 100%;`} />\n        </Show>\n      </button>\n    </Show>\n  )\n}\n\nexport default hookForDev(PrimalMenuItem);\n","import { Component, createEffect, createSignal, For, onMount } from \"solid-js\";\nimport { hookForDev } from \"../../lib/devTools\";\nimport { MenuItem } from \"../../types/primal\";\nimport styles from  \"./PrimalMenu.module.scss\";\nimport PrimalMenuItem from \"./PrimalMenuItem\";\n\n\nconst PrimalMenu: Component<{\n  id: string,\n  items: MenuItem[],\n  position?: 'note_footer' | 'profile' | 'note_context',\n  orientation?: 'up' | 'down',\n  reverse?: boolean,\n  hidden?: boolean,\n}> = (props) => {\n\n  const visibilityClass = () => {\n    if (props.hidden) {\n      return styles.hidden;\n    }\n\n    return styles.visible;\n  };\n\n  const positionClass = () => {\n    if (props.position == 'note_context') {\n      return styles.noteContext\n    }\n\n    if (props.position == 'note_footer') {\n      return styles.noteFooter\n    }\n\n    if (props.position == 'profile') {\n      return styles.profile\n    }\n\n    return '';\n  }\n\n  const orientationClass = () => {\n    if (!props.orientation || props.orientation == 'down') {\n      return styles.contextMenuOptions\n    }\n\n    return styles.contextMenuOptionsUp\n  };\n\n  return (\n    <div\n      id={props.id}\n      class={`${orientationClass()} ${positionClass()}`}\n      data-open={!props.hidden}\n    >\n      <For each={props.items}>\n        {item => (\n          <PrimalMenuItem item={item} reverse={props.reverse} />\n        )}\n      </For>\n    </div>\n  )\n}\n\nexport default hookForDev(PrimalMenu);\n","import { Component } from 'solid-js';\n\nconst ZapAnimation: Component<{\n  id?: string,\n  class?: string,\n  src: any,\n  ref?: HTMLElement | undefined,\n}> = (props) => {\n\n  return (\n    // @ts-ignore\n    <lottie-player\n      id={props.id}\n      src={props.src}\n      speed=\"1\"\n      class={props.class}\n      ref={props.ref}\n    >\n    {/* @ts-ignore */}\n    </lottie-player>\n  );\n}\n\nexport default ZapAnimation;\n","import { Component, createEffect, onCleanup } from 'solid-js';\nimport { PrimalNote } from '../../../types/primal';\n\nimport styles from './NoteFooter.module.scss';\n\nconst buttonTypeClasses: Record<string, string> = {\n  zap: styles.zapType,\n  like: styles.likeType,\n  reply: styles.replyType,\n  repost: styles.repostType,\n};\n\nconst NoteFooterActionButton: Component<{\n  type: 'zap' | 'like' | 'reply' | 'repost',\n  note: PrimalNote,\n  disabled?: boolean,\n  highlighted?: boolean,\n  onClick?: (e: MouseEvent) => void,\n  onMouseDown?: (e: MouseEvent) => void,\n  onMouseUp?: (e: MouseEvent) => void,\n  onTouchStart?: (e: TouchEvent) => void,\n  onTouchEnd?: (e: TouchEvent) => void,\n  label: string | number,\n  hidden?: boolean,\n  title?: string,\n  large?: boolean,\n}> = (props) => {\n\n  return (\n    <button\n      id={`btn_${props.type}_${props.note.post.id}`}\n      class={`${styles.stat} ${props.highlighted ? styles.highlighted : ''}`}\n      onClick={props.onClick ?? (() => {})}\n      onMouseDown={props.onMouseDown ?? (() => {})}\n      onMouseUp={props.onMouseUp ?? (() => {})}\n      onTouchStart={props.onTouchStart ?? (() => {})}\n      onTouchEnd={props.onTouchEnd ?? (() => {})}\n      disabled={props.disabled}\n    >\n      <div class={`${buttonTypeClasses[props.type]} ${props.large ? styles.large : ''}`}>\n        <div\n          class={`${styles.icon} ${props.large ? styles.large : ''}`}\n          style={props.hidden ? 'visibility: hidden': 'visibility: visible'}\n        ></div>\n        <div class={styles.statNumber}>{props.label || ''}</div>\n      </div>\n    </button>\n  )\n}\n\nexport default NoteFooterActionButton;\n","import { useIntl } from '@cookbook/solid-intl';\nimport { Component, createEffect, createSignal, Show } from 'solid-js';\nimport { APP_ID } from '../../App';\nimport { Kind } from '../../constants';\nimport { useAccountContext } from '../../contexts/AccountContext';\nimport { useAppContext } from '../../contexts/AppContext';\nimport { logWarning } from '../../lib/logger';\nimport { getBookmarks, sendBookmarks } from '../../lib/profile';\nimport { subsTo } from '../../sockets';\nimport { PrimalNote } from '../../types/primal';\nimport ButtonGhost from '../Buttons/ButtonGhost';\nimport { bookmarks as tBookmarks } from '../../translations';\n\nimport styles from './BookmarkNote.module.scss';\nimport { saveBookmarks } from '../../lib/localStore';\nimport { triggerImportEvents } from '../../lib/notes';\n\nconst BookmarkNote: Component<{ note: PrimalNote, large?: boolean, right?: boolean }> = (props) => {\n  const account = useAccountContext();\n  const app = useAppContext();\n  const intl = useIntl();\n\n  const [isBookmarked, setIsBookmarked] = createSignal(false);\n  const [bookmarkInProgress, setBookmarkInProgress] = createSignal(false);\n\n  createEffect(() => {\n    setIsBookmarked(() => account?.bookmarks.includes(props.note.post.id) || false);\n  })\n\n  const updateBookmarks = async (bookmarkTags: string[][]) => {\n    if (!account) return;\n\n    const bookmarks = bookmarkTags.reduce((acc, t) =>\n      t[0] === 'e' ? [...acc, t[1]] : [...acc]\n    , []);\n\n    const date = Math.floor((new Date()).getTime() / 1000);\n\n    account.actions.updateBookmarks(bookmarks)\n    saveBookmarks(account.publicKey, bookmarks);\n    const { success, note} = await sendBookmarks([...bookmarkTags], date, '', account?.proxyThroughPrimal || false, account.activeRelays, account?.relaySettings);\n\n    if (success && note) {\n      triggerImportEvents([note], `bookmark_import_${APP_ID}`)\n    }\n  };\n\n  const addBookmark = async (bookmarkTags: string[][]) => {\n    if (account && !bookmarkTags.find(b => b[0] === 'e' && b[1] === props.note.post.id)) {\n      const bookmarksToAdd = [...bookmarkTags, ['e', props.note.post.id]];\n\n      if (bookmarksToAdd.length < 2) {\n        logWarning('BOOKMARK ISSUE: ', `before_bookmark_${APP_ID}`);\n\n        app?.actions.openConfirmModal({\n          title: intl.formatMessage(tBookmarks.confirm.title),\n          description: intl.formatMessage(tBookmarks.confirm.description),\n          confirmLabel: intl.formatMessage(tBookmarks.confirm.confirm),\n          abortLabel: intl.formatMessage(tBookmarks.confirm.abort),\n          onConfirm: async () => {\n            await updateBookmarks(bookmarksToAdd);\n            app.actions.closeConfirmModal();\n          },\n          onAbort: app.actions.closeConfirmModal,\n        })\n\n        return;\n      }\n\n      await updateBookmarks(bookmarksToAdd);\n    }\n  }\n\n  const removeBookmark = async (bookmarks: string[][]) => {\n    if (account && bookmarks.find(b => b[0] === 'e' && b[1] === props.note.post.id)) {\n      const bookmarksToAdd = bookmarks.filter(b => b[0] !== 'e' || b[1] !== props.note.post.id);\n\n      if (bookmarksToAdd.length < 1) {\n        logWarning('BOOKMARK ISSUE: ', `before_bookmark_${APP_ID}`);\n\n        app?.actions.openConfirmModal({\n          title: intl.formatMessage(tBookmarks.confirm.titleZero),\n          description: intl.formatMessage(tBookmarks.confirm.descriptionZero),\n          confirmLabel: intl.formatMessage(tBookmarks.confirm.confirmZero),\n          abortLabel: intl.formatMessage(tBookmarks.confirm.abortZero),\n          onConfirm: async () => {\n            await updateBookmarks(bookmarksToAdd);\n            app.actions.closeConfirmModal();\n          },\n          onAbort: app.actions.closeConfirmModal,\n        })\n\n        return;\n      }\n\n      await updateBookmarks(bookmarksToAdd);\n    }\n  }\n\n  const doBookmark = (remove: boolean, then?: () => void) => {\n\n    if (!account?.publicKey) {\n      return;\n    }\n\n    let bookmarks: string[][] = []\n\n    const unsub = subsTo(`before_bookmark_${APP_ID}`, {\n      onEvent: (_, content) => {\n        if (!content || content.kind !== Kind.Bookmarks) return;\n\n        bookmarks = content.tags;\n      },\n      onEose: async () => {\n        if (remove) {\n          await removeBookmark(bookmarks);\n        }\n        else {\n          await addBookmark(bookmarks);\n        }\n\n        then && then();\n        setBookmarkInProgress(() => false);\n        unsub();\n      },\n    });\n\n    setBookmarkInProgress(() => true);\n    getBookmarks(account.publicKey, `before_bookmark_${APP_ID}`);\n  }\n\n  return (\n    <div class={styles.bookmark}>\n      <ButtonGhost\n        class={`${props.right ? styles.right : ''} ${props.large ? styles.rightL : ''}`}\n        onClick={(e: MouseEvent) => {\n          e.preventDefault();\n\n          doBookmark(isBookmarked());\n\n        }}\n        disabled={bookmarkInProgress()}\n      >\n        <Show\n          when={isBookmarked()}\n          fallback={\n            <div class={`${styles.emptyBookmark} ${props.large ? styles.large : ''}`}></div>\n          }\n          >\n            <div class={`${styles.fullBookmark} ${props.large ? styles.large : ''}`}></div>\n        </Show>\n      </ButtonGhost>\n    </div>\n  )\n}\n\nexport default BookmarkNote;\n","import { batch, Component, createEffect, Show } from 'solid-js';\nimport { MenuItem, PrimalNote, ZapOption } from '../../../types/primal';\nimport { sendRepost, triggerImportEvents } from '../../../lib/notes';\n\nimport styles from './NoteFooter.module.scss';\nimport { useAccountContext } from '../../../contexts/AccountContext';\nimport { useToastContext } from '../../Toaster/Toaster';\nimport { useIntl } from '@cookbook/solid-intl';\n\nimport { truncateNumber } from '../../../lib/notifications';\nimport { canUserReceiveZaps, zapNote } from '../../../lib/zap';\nimport { useSettingsContext } from '../../../contexts/SettingsContext';\n\nimport zapMD from '../../../assets/lottie/zap_md_2.json';\nimport { toast as t } from '../../../translations';\nimport PrimalMenu from '../../PrimalMenu/PrimalMenu';\nimport { hookForDev } from '../../../lib/devTools';\nimport { getScreenCordinates } from '../../../utils';\nimport ZapAnimation from '../../ZapAnimation/ZapAnimation';\nimport { CustomZapInfo, useAppContext } from '../../../contexts/AppContext';\nimport NoteFooterActionButton from './NoteFooterActionButton';\nimport { NoteReactionsState } from '../Note';\nimport { SetStoreFunction } from 'solid-js/store';\nimport BookmarkNote from '../../BookmarkNote/BookmarkNote';\n\nexport const lottieDuration = () => zapMD.op * 1_000 / zapMD.fr;\n\nconst NoteFooter: Component<{\n  note: PrimalNote,\n  size?: 'xwide' | 'wide' | 'normal' | 'compact' | 'short',\n  id?: string,\n  state: NoteReactionsState,\n  updateState?: SetStoreFunction<NoteReactionsState>,\n  customZapInfo?: CustomZapInfo,\n  large?: boolean,\n  onZapAnim?: (zapOption: ZapOption) => void,\n}> = (props) => {\n\n  const account = useAccountContext();\n  const toast = useToastContext();\n  const intl = useIntl();\n  const settings = useSettingsContext();\n  const app = useAppContext();\n\n  let medZapAnimation: HTMLElement | undefined;\n\n  let quickZapDelay = 0;\n  let footerDiv: HTMLDivElement | undefined;\n  let repostMenu: HTMLDivElement | undefined;\n\n  const size = () => props.size ?? 'normal';\n\n  const repostMenuItems: MenuItem[] = [\n    {\n      action: () => doRepost(),\n      label: 'Repost Note',\n      icon: 'feed_repost',\n    },\n    {\n      action: () => doQuote(),\n      label: 'Quote Note',\n      icon: 'quote',\n    },\n  ];\n\n\n  const onClickOutside = (e: MouseEvent) => {\n    if (\n      !document?.getElementById(`repost_menu_${props.note.post.id}`)?.contains(e.target as Node) &&\n      props.updateState\n    ) {\n      props.updateState('isRepostMenuVisible', () => false);\n    }\n  }\n\n  createEffect(() => {\n    if (props.state.isRepostMenuVisible) {\n      document.addEventListener('click', onClickOutside);\n    }\n    else {\n      document.removeEventListener('click', onClickOutside);\n    }\n  });\n\n  const showRepostMenu = (e: MouseEvent) => {\n    e.preventDefault();\n    props.updateState && props.updateState('isRepostMenuVisible', () => true);\n  };\n\n  const doQuote = () => {\n    if (!account?.hasPublicKey()) {\n      account?.actions.showGetStarted();\n      return;\n    }\n    props.updateState && props.updateState('isRepostMenuVisible', () => false);\n    account?.actions?.quoteNote(`nostr:${props.note.post.noteId}`);\n    account?.actions?.showNewNoteForm();\n  };\n\n  const doRepost = async () => {\n    if (!account) {\n      return;\n    }\n\n    if (!account.hasPublicKey()) {\n      account.actions.showGetStarted();\n      return;\n    }\n\n    if (!account.proxyThroughPrimal && account.relays.length === 0) {\n      toast?.sendWarning(\n        intl.formatMessage(t.noRelaysConnected),\n      );\n      return;\n    }\n\n    props.updateState && props.updateState('isRepostMenuVisible', () => false);\n\n    const { success } = await sendRepost(props.note, account.proxyThroughPrimal, account.activeRelays, account.relaySettings);\n\n    if (success) {\n      batch(() => {\n        props.updateState && props.updateState('reposts', (r) => r + 1);\n        props.updateState && props.updateState('reposted', () => true);\n      });\n\n      toast?.sendSuccess(\n        intl.formatMessage(t.repostSuccess),\n      );\n    }\n    else {\n      toast?.sendWarning(\n        intl.formatMessage(t.repostFailed),\n      );\n    }\n  };\n\n  const doReply = () => {};\n\n  const doLike = async (e: MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    if (!account) {\n      return;\n    }\n\n    if (!account.hasPublicKey()) {\n      account.actions.showGetStarted();\n      return;\n    }\n\n    if (!account.proxyThroughPrimal && account.relays.length === 0) {\n      toast?.sendWarning(\n        intl.formatMessage(t.noRelaysConnected),\n      );\n      return;\n    }\n\n    const success = await account.actions.addLike(props.note);\n\n    if (success) {\n      batch(() => {\n        props.updateState && props.updateState('likes', (l) => l + 1);\n        props.updateState && props.updateState('liked', () => true);\n      });\n    }\n  };\n\n  const startZap = (e: MouseEvent | TouchEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    if (!account?.hasPublicKey()) {\n      account?.actions.showGetStarted();\n      props.updateState && props.updateState('isZapping', () => false);\n      return;\n    }\n\n    if (!account.proxyThroughPrimal && account.relays.length === 0) {\n      toast?.sendWarning(\n        intl.formatMessage(t.noRelaysConnected),\n      );\n      return;\n    }\n\n    if (!canUserReceiveZaps(props.note.user)) {\n      toast?.sendWarning(\n        intl.formatMessage(t.zapUnavailable),\n      );\n      props.updateState && props.updateState('isZapping', () => false);\n      return;\n    }\n\n    quickZapDelay = setTimeout(() => {\n      props.customZapInfo && app?.actions.openCustomZapModal(props.customZapInfo);\n      props.updateState && props.updateState('isZapping', () => true);\n    }, 500);\n  };\n\n  const commitZap = (e: MouseEvent | TouchEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    clearTimeout(quickZapDelay);\n\n    if (!account?.hasPublicKey()) {\n      account?.actions.showGetStarted();\n      return;\n    }\n\n    if ((!account.proxyThroughPrimal && account.relays.length === 0) || !canUserReceiveZaps(props.note.user)) {\n      return;\n    }\n\n    if (app?.customZap === undefined) {\n      doQuickZap();\n    }\n  };\n\n  const animateZap = () => {\n    setTimeout(() => {\n      props.updateState && props.updateState('hideZapIcon', () => true);\n\n      if (!medZapAnimation) {\n        return;\n      }\n\n      let newLeft = 33;\n      let newTop = -13;\n\n      if (size() === 'xwide') {\n        newLeft = 46;\n        newTop = -7;\n      }\n\n      if (size() === 'wide' && props.large) {\n        newLeft = 4;\n        newTop = -15;\n      }\n\n      if (size() === 'short') {\n        newLeft = 21;\n        newTop = -13;\n      }\n\n      if (size() === 'compact') {\n        newLeft = 26;\n        newTop = -6;\n      }\n\n      medZapAnimation.style.left = `${newLeft}px`;\n      medZapAnimation.style.top = `${newTop}px`;\n\n      const onAnimDone = () => {\n        batch(() => {\n          props.updateState && props.updateState('showZapAnim', () => false);\n          props.updateState && props.updateState('hideZapIcon', () => false);\n          props.updateState && props.updateState('zapped', () => true);\n        });\n        medZapAnimation?.removeEventListener('complete', onAnimDone);\n      }\n\n      medZapAnimation.addEventListener('complete', onAnimDone);\n\n      try {\n        // @ts-ignore\n        medZapAnimation.seek(0);\n        // @ts-ignore\n        medZapAnimation.play();\n      } catch (e) {\n        console.warn('Failed to animte zap:', e);\n        onAnimDone();\n      }\n    }, 10);\n  };\n\n  const doQuickZap = async () => {\n    if (!account?.hasPublicKey()) {\n      account?.actions.showGetStarted();\n      return;\n    }\n\n    const amount = settings?.defaultZap.amount || 10;\n    const message = settings?.defaultZap.message || '';\n    const emoji = settings?.defaultZap.emoji;\n\n    batch(() => {\n      props.updateState && props.updateState('isZapping', () => true);\n      props.updateState && props.updateState('satsZapped', (z) => z + amount);\n      props.updateState && props.updateState('showZapAnim', () => true);\n    });\n\n    props.onZapAnim && props.onZapAnim({ amount, message, emoji })\n\n    setTimeout(async () => {\n      const success = await zapNote(props.note, account.publicKey, amount, message, account.activeRelays);\n\n      props.updateState && props.updateState('isZapping', () => false);\n\n      if (success) {\n        props.customZapInfo &&props.customZapInfo.onSuccess({\n          emoji,\n          amount,\n          message,\n        });\n\n        return;\n      }\n\n      props.customZapInfo && props.customZapInfo.onFail({\n        emoji,\n        amount,\n        message,\n      });\n    }, lottieDuration());\n\n  }\n\n  const buttonTypeClasses: Record<string, string> = {\n    zap: styles.zapType,\n    like: styles.likeType,\n    reply: styles.replyType,\n    repost: styles.repostType,\n  };\n\n  createEffect(() => {\n    if (props.state.showZapAnim) {\n      animateZap();\n    }\n  });\n\n  const determineOrient = () => {\n    const coor = getScreenCordinates(repostMenu);\n    const height = 100;\n    return (coor.y || 0) + height < window.innerHeight + window.scrollY ? 'down' : 'up';\n  }\n\n  return (\n    <div\n      id={props.id}\n      class={`${styles.footer} ${styles[size()]}`}\n      ref={footerDiv}\n      onClick={(e) => e.preventDefault() }\n    >\n\n      <Show when={props.state.showZapAnim}>\n        <ZapAnimation\n          id={`note-med-zap-${props.note.post.id}`}\n          src={zapMD}\n          class={props.large ? styles.largeZapLottie : styles.mediumZapLottie}\n          ref={medZapAnimation}\n        />\n      </Show>\n\n      <NoteFooterActionButton\n        note={props.note}\n        onClick={doReply}\n        type=\"reply\"\n        highlighted={props.state.replied}\n        label={props.state.replies === 0 ? '' : truncateNumber(props.state.replies, 2)}\n        title={props.state.replies.toLocaleString()}\n        large={props.large}\n      />\n\n      <NoteFooterActionButton\n        note={props.note}\n        onClick={(e: MouseEvent) => e.preventDefault()}\n        onMouseDown={startZap}\n        onMouseUp={commitZap}\n        onTouchStart={startZap}\n        onTouchEnd={commitZap}\n        type=\"zap\"\n        highlighted={props.state.zapped || props.state.isZapping}\n        label={props.state.satsZapped === 0 ? '' : truncateNumber(props.state.satsZapped, 2)}\n        hidden={props.state.hideZapIcon}\n        title={props.state.satsZapped.toLocaleString()}\n        large={props.large}\n      />\n\n      <NoteFooterActionButton\n        note={props.note}\n        onClick={doLike}\n        type=\"like\"\n        highlighted={props.state.liked}\n        label={props.state.likes === 0 ? '' : truncateNumber(props.state.likes, 2)}\n        title={props.state.likes.toLocaleString()}\n        large={props.large}\n      />\n\n      <button\n        id={`btn_repost_${props.note.post.id}`}\n        class={`${styles.stat} ${props.state.reposted ? styles.highlighted : ''}`}\n        onClick={showRepostMenu}\n        title={props.state.reposts.toLocaleString()}\n      >\n        <div\n          class={`${buttonTypeClasses.repost}`}\n          ref={repostMenu}\n        >\n          <div\n            class={`${styles.icon} ${props.large ? styles.large : ''}`}\n            style={'visibility: visible'}\n          ></div>\n          <div class={styles.statNumber}>\n            {props.state.reposts === 0 ? '' : truncateNumber(props.state.reposts, 2)}\n          </div>\n          <PrimalMenu\n            id={`repost_menu_${props.note.post.id}`}\n            items={repostMenuItems}\n            position=\"note_footer\"\n            orientation={determineOrient()}\n            hidden={!props.state.isRepostMenuVisible}\n          />\n        </div>\n      </button>\n\n      <div class={styles.bookmarkFoot}>\n        <BookmarkNote\n          note={props.note}\n          large={props.large}\n          right={true}\n        />\n      </div>\n\n    </div>\n  )\n}\n\nexport default hookForDev(NoteFooter);\n","import { useIntl } from '@cookbook/solid-intl';\nimport { A } from '@solidjs/router';\nimport { nip19 } from '../../lib/nTools';\nimport { batch, Component, createMemo, JSXElement, Show } from 'solid-js';\nimport { createStore } from 'solid-js/store';\nimport { useAccountContext } from '../../contexts/AccountContext';\nimport { CustomZapInfo, useAppContext } from '../../contexts/AppContext';\nimport { useMediaContext } from '../../contexts/MediaContext';\nimport { useThreadContext } from '../../contexts/ThreadContext';\nimport { date } from '../../lib/dates';\nimport { trimVerification } from '../../lib/profile';\nimport { nip05Verification, userName } from '../../stores/profile';\nimport { note as t } from '../../translations';\nimport { PrimalNote, PrimalUser, ZapOption } from '../../types/primal';\nimport Avatar from '../Avatar/Avatar';\nimport { NoteReactionsState } from '../Note/Note';\nimport NoteFooter from '../Note/NoteFooter/NoteFooter';\nimport ParsedNote from '../ParsedNote/ParsedNote';\nimport VerificationCheck from '../VerificationCheck/VerificationCheck';\n\nimport styles from './EmbeddedNote.module.scss';\n\nconst EmbeddedNote: Component<{\n  note: PrimalNote | undefined,\n  mentionedUsers?: Record<string, PrimalUser>,\n  includeEmbeds?: boolean,\n  isLast?: boolean,\n  alternativeBackground?: boolean,\n  class?: string,\n  footerSize?: 'xwide' | 'wide' | 'normal' | 'compact' | 'short' | 'mini',\n  hideFooter?: boolean,\n  embedLevel?: number,\n  rootNote?: PrimalNote,\n  noLinks?: 'text' | 'links',\n}> = (props) => {\n\n  const threadContext = useThreadContext();\n  const intl = useIntl();\n  const app = useAppContext();\n  const account = useAccountContext();\n\n  let noteContent: HTMLDivElement | undefined;\n\n  const [reactionsState, updateReactionsState] = createStore<NoteReactionsState>({\n    likes: props.note?.post.likes || 0,\n    liked: props.note?.post.noteActions?.liked || false,\n    reposts: props.note?.post.reposts || 0,\n    reposted: props.note?.post.noteActions?.reposted || false,\n    replies: props.note?.post.replies || 0,\n    replied: props.note?.post.noteActions?.replied || false,\n    zapCount: props.note?.post.zaps || 0,\n    satsZapped: props.note?.post.satszapped || 0,\n    zapped: props.note?.post.noteActions?.zapped || false,\n    zappedAmount: 0,\n    zappedNow: false,\n    isZapping: false,\n    showZapAnim: false,\n    hideZapIcon: false,\n    moreZapsAvailable: false,\n    isRepostMenuVisible: false,\n    topZaps: [],\n    topZapsFeed: [],\n    quoteCount: 0,\n  });\n\n  // @ts-ignore\n  const noteId = () => nip19.noteEncode(props.note?.post.id);\n\n  const navToThread = () => {\n    threadContext?.actions.setPrimaryNote(props.note);\n  };\n\n  const verification = createMemo(() => {\n    return trimVerification(props.note?.user?.nip05);\n  });\n\n  const klass = () => {\n    let k = styles.mentionedNote;\n    k += ' embeddedNote';\n    if (props.isLast) k += ' noBottomMargin';\n    if (props.alternativeBackground) k += ` ${styles.altBack}`;\n    if ((props.embedLevel || 0) > 0) k += ` ${styles.embededContentWrapper}`\n    if (props.class) k += ` ${props.class}`;\n\n    return k;\n  }\n\n  const wrapper = (children: JSXElement) => {\n    if (props.includeEmbeds) {\n      return (\n        <div\n          class={klass()}\n          data-event={props.note?.post.id}\n          data-event-bech32={noteId()}\n        >\n          {children}\n        </div>\n      );\n    }\n\n    return (\n      <A\n        href={`/e/${noteId()}`}\n        class={klass()}\n        onClick={() => navToThread()}\n        data-event={props.note?.post.id}\n        data-event-bech32={noteId()}\n      >\n        {children}\n      </A>\n    );\n  };\n\n  const onConfirmZap = (zapOption: ZapOption) => {\n    app?.actions.closeCustomZapModal();\n    batch(() => {\n      updateReactionsState('zappedAmount', () => zapOption.amount || 0);\n      updateReactionsState('satsZapped', (z) => z + (zapOption.amount || 0));\n      updateReactionsState('zapped', () => true);\n      updateReactionsState('showZapAnim', () => true)\n    });\n\n    // addTopZap(zapOption);\n    // addTopZapFeed(zapOption)\n  };\n\n  const onSuccessZap = (zapOption: ZapOption) => {\n    app?.actions.closeCustomZapModal();\n    app?.actions.resetCustomZap();\n\n    const pubkey = account?.publicKey;\n\n    if (!pubkey) return;\n\n    batch(() => {\n      updateReactionsState('zapCount', (z) => z + 1);\n      updateReactionsState('isZapping', () => false);\n      updateReactionsState('showZapAnim', () => false);\n      updateReactionsState('hideZapIcon', () => false);\n      updateReactionsState('zapped', () => true);\n    });\n  };\n\n  const onFailZap = (zapOption: ZapOption) => {\n    const note = props.note;\n    if (!note) return;\n\n    app?.actions.closeCustomZapModal();\n    app?.actions.resetCustomZap();\n    batch(() => {\n      updateReactionsState('zappedAmount', () => -(zapOption.amount || 0));\n      updateReactionsState('satsZapped', (z) => z - (zapOption.amount || 0));\n      updateReactionsState('isZapping', () => false);\n      updateReactionsState('showZapAnim', () => false);\n      updateReactionsState('hideZapIcon', () => false);\n      updateReactionsState('zapped', () => note.post.noteActions.zapped);\n    });\n\n    // removeTopZap(zapOption);\n    // removeTopZapFeed(zapOption);\n  };\n\n  const onCancelZap = (zapOption: ZapOption) => {\n    const note = props.note;\n    if (!note) return;\n\n    app?.actions.closeCustomZapModal();\n    app?.actions.resetCustomZap();\n    batch(() => {\n      updateReactionsState('zappedAmount', () => -(zapOption.amount || 0));\n      updateReactionsState('satsZapped', (z) => z - (zapOption.amount || 0));\n      updateReactionsState('isZapping', () => false);\n      updateReactionsState('showZapAnim', () => false);\n      updateReactionsState('hideZapIcon', () => false);\n      updateReactionsState('zapped', () => note.post.noteActions.zapped);\n    });\n\n    // removeTopZap(zapOption);\n    // removeTopZapFeed(zapOption);\n  };\n\n  const customZapInfo: () => CustomZapInfo = () => ({\n    note: props.note,\n    onConfirm: onConfirmZap,\n    onSuccess: onSuccessZap,\n    onFail: onFailZap,\n    onCancel: onCancelZap,\n  });\n\n  return wrapper(\n    <>\n      <div class={styles.mentionedNoteHeader}>\n        <Avatar\n          user={props.note?.user}\n          size=\"xxs\"\n        />\n        <span class={styles.postInfo}>\n          <span class={styles.userInfo}>\n            <Show\n              when={props.note?.user.nip05}\n              fallback={\n                <span class={styles.userName}>\n                  {userName(props.note?.user)}\n                </span>\n              }\n            >\n              <span class={styles.userName}>\n                {userName(props.note?.user)}\n              </span>\n              <VerificationCheck user={props.note?.user} />\n              <span\n                class={styles.verifiedBy}\n                title={props.note?.user.nip05}\n              >\n                {nip05Verification(props.note?.user)}\n              </span>\n            </Show>\n          </span>\n\n          <span\n            class={styles.time}\n            title={date(props.note?.post.created_at || 0).date.toLocaleString()}\n          >\n            {date(props.note?.post.created_at || 0).label}\n          </span>\n        </span>\n      </div>\n      <div class={styles.noteContent} ref={noteContent}>\n        <ParsedNote\n          note={props.note}\n          shorten={true}\n          isEmbeded={true}\n          embedLevel={(props.embedLevel || 0)+1}\n          rootNote={props.rootNote}\n          width={noteContent?.getBoundingClientRect().width}\n          margins={2}\n          noLinks={props.noLinks}\n        />\n      </div>\n      <div class={styles.footer}>\n        <Show when={!props.hideFooter}>\n          <NoteFooter\n            note={props.note}\n            state={reactionsState}\n            size={props.footerSize || 'compact'}\n            updateState={updateReactionsState}\n            customZapInfo={customZapInfo()}\n          />\n        </Show>\n      </div>\n    </>\n  );\n}\n\nexport default EmbeddedNote;\n","/*!\n  * PhotoSwipe Lightbox 5.4.3 - https://photoswipe.com\n  * (c) 2023 Dmytro Semenov\n  */\n/** @typedef {import('../photoswipe.js').Point} Point */\n\n/**\r\n * @template {keyof HTMLElementTagNameMap} T\r\n * @param {string} className\r\n * @param {T} tagName\r\n * @param {Node} [appendToEl]\r\n * @returns {HTMLElementTagNameMap[T]}\r\n */\nfunction createElement(className, tagName, appendToEl) {\n  const el = document.createElement(tagName);\n\n  if (className) {\n    el.className = className;\n  }\n\n  if (appendToEl) {\n    appendToEl.appendChild(el);\n  }\n\n  return el;\n}\n/**\r\n * Get transform string\r\n *\r\n * @param {number} x\r\n * @param {number} [y]\r\n * @param {number} [scale]\r\n * @returns {string}\r\n */\n\nfunction toTransformString(x, y, scale) {\n  let propValue = `translate3d(${x}px,${y || 0}px,0)`;\n\n  if (scale !== undefined) {\n    propValue += ` scale3d(${scale},${scale},1)`;\n  }\n\n  return propValue;\n}\n/**\r\n * Apply width and height CSS properties to element\r\n *\r\n * @param {HTMLElement} el\r\n * @param {string | number} w\r\n * @param {string | number} h\r\n */\n\nfunction setWidthHeight(el, w, h) {\n  el.style.width = typeof w === 'number' ? `${w}px` : w;\n  el.style.height = typeof h === 'number' ? `${h}px` : h;\n}\n/** @typedef {LOAD_STATE[keyof LOAD_STATE]} LoadState */\n\n/** @type {{ IDLE: 'idle'; LOADING: 'loading'; LOADED: 'loaded'; ERROR: 'error' }} */\n\nconst LOAD_STATE = {\n  IDLE: 'idle',\n  LOADING: 'loading',\n  LOADED: 'loaded',\n  ERROR: 'error'\n};\n/**\r\n * Check if click or keydown event was dispatched\r\n * with a special key or via mouse wheel.\r\n *\r\n * @param {MouseEvent | KeyboardEvent} e\r\n * @returns {boolean}\r\n */\n\nfunction specialKeyUsed(e) {\n  return 'button' in e && e.button === 1 || e.ctrlKey || e.metaKey || e.altKey || e.shiftKey;\n}\n/**\r\n * Parse `gallery` or `children` options.\r\n *\r\n * @param {import('../photoswipe.js').ElementProvider} [option]\r\n * @param {string} [legacySelector]\r\n * @param {HTMLElement | Document} [parent]\r\n * @returns HTMLElement[]\r\n */\n\nfunction getElementsFromOption(option, legacySelector, parent = document) {\n  /** @type {HTMLElement[]} */\n  let elements = [];\n\n  if (option instanceof Element) {\n    elements = [option];\n  } else if (option instanceof NodeList || Array.isArray(option)) {\n    elements = Array.from(option);\n  } else {\n    const selector = typeof option === 'string' ? option : legacySelector;\n\n    if (selector) {\n      elements = Array.from(parent.querySelectorAll(selector));\n    }\n  }\n\n  return elements;\n}\n/**\r\n * Check if variable is PhotoSwipe class\r\n *\r\n * @param {any} fn\r\n * @returns {boolean}\r\n */\n\nfunction isPswpClass(fn) {\n  return typeof fn === 'function' && fn.prototype && fn.prototype.goTo;\n}\n/**\r\n * Check if browser is Safari\r\n *\r\n * @returns {boolean}\r\n */\n\nfunction isSafari() {\n  return !!(navigator.vendor && navigator.vendor.match(/apple/i));\n}\n\n/** @typedef {import('../lightbox/lightbox.js').default} PhotoSwipeLightbox */\n\n/** @typedef {import('../photoswipe.js').default} PhotoSwipe */\n\n/** @typedef {import('../photoswipe.js').PhotoSwipeOptions} PhotoSwipeOptions */\n\n/** @typedef {import('../photoswipe.js').DataSource} DataSource */\n\n/** @typedef {import('../ui/ui-element.js').UIElementData} UIElementData */\n\n/** @typedef {import('../slide/content.js').default} ContentDefault */\n\n/** @typedef {import('../slide/slide.js').default} Slide */\n\n/** @typedef {import('../slide/slide.js').SlideData} SlideData */\n\n/** @typedef {import('../slide/zoom-level.js').default} ZoomLevel */\n\n/** @typedef {import('../slide/get-thumb-bounds.js').Bounds} Bounds */\n\n/**\r\n * Allow adding an arbitrary props to the Content\r\n * https://photoswipe.com/custom-content/#using-webp-image-format\r\n * @typedef {ContentDefault & Record<string, any>} Content\r\n */\n\n/** @typedef {{ x?: number; y?: number }} Point */\n\n/**\r\n * @typedef {Object} PhotoSwipeEventsMap https://photoswipe.com/events/\r\n *\r\n *\r\n * https://photoswipe.com/adding-ui-elements/\r\n *\r\n * @prop {undefined} uiRegister\r\n * @prop {{ data: UIElementData }} uiElementCreate\r\n *\r\n *\r\n * https://photoswipe.com/events/#initialization-events\r\n *\r\n * @prop {undefined} beforeOpen\r\n * @prop {undefined} firstUpdate\r\n * @prop {undefined} initialLayout\r\n * @prop {undefined} change\r\n * @prop {undefined} afterInit\r\n * @prop {undefined} bindEvents\r\n *\r\n *\r\n * https://photoswipe.com/events/#opening-or-closing-transition-events\r\n *\r\n * @prop {undefined} openingAnimationStart\r\n * @prop {undefined} openingAnimationEnd\r\n * @prop {undefined} closingAnimationStart\r\n * @prop {undefined} closingAnimationEnd\r\n *\r\n *\r\n * https://photoswipe.com/events/#closing-events\r\n *\r\n * @prop {undefined} close\r\n * @prop {undefined} destroy\r\n *\r\n *\r\n * https://photoswipe.com/events/#pointer-and-gesture-events\r\n *\r\n * @prop {{ originalEvent: PointerEvent }} pointerDown\r\n * @prop {{ originalEvent: PointerEvent }} pointerMove\r\n * @prop {{ originalEvent: PointerEvent }} pointerUp\r\n * @prop {{ bgOpacity: number }} pinchClose can be default prevented\r\n * @prop {{ panY: number }} verticalDrag can be default prevented\r\n *\r\n *\r\n * https://photoswipe.com/events/#slide-content-events\r\n *\r\n * @prop {{ content: Content }} contentInit\r\n * @prop {{ content: Content; isLazy: boolean }} contentLoad can be default prevented\r\n * @prop {{ content: Content; isLazy: boolean }} contentLoadImage can be default prevented\r\n * @prop {{ content: Content; slide: Slide; isError?: boolean }} loadComplete\r\n * @prop {{ content: Content; slide: Slide }} loadError\r\n * @prop {{ content: Content; width: number; height: number }} contentResize can be default prevented\r\n * @prop {{ content: Content; width: number; height: number; slide: Slide }} imageSizeChange\r\n * @prop {{ content: Content }} contentLazyLoad can be default prevented\r\n * @prop {{ content: Content }} contentAppend can be default prevented\r\n * @prop {{ content: Content }} contentActivate can be default prevented\r\n * @prop {{ content: Content }} contentDeactivate can be default prevented\r\n * @prop {{ content: Content }} contentRemove can be default prevented\r\n * @prop {{ content: Content }} contentDestroy can be default prevented\r\n *\r\n *\r\n * undocumented\r\n *\r\n * @prop {{ point: Point; originalEvent: PointerEvent }} imageClickAction can be default prevented\r\n * @prop {{ point: Point; originalEvent: PointerEvent }} bgClickAction can be default prevented\r\n * @prop {{ point: Point; originalEvent: PointerEvent }} tapAction can be default prevented\r\n * @prop {{ point: Point; originalEvent: PointerEvent }} doubleTapAction can be default prevented\r\n *\r\n * @prop {{ originalEvent: KeyboardEvent }} keydown can be default prevented\r\n * @prop {{ x: number; dragging: boolean }} moveMainScroll\r\n * @prop {{ slide: Slide }} firstZoomPan\r\n * @prop {{ slide: Slide | undefined, data: SlideData, index: number }} gettingData\r\n * @prop {undefined} beforeResize\r\n * @prop {undefined} resize\r\n * @prop {undefined} viewportSize\r\n * @prop {undefined} updateScrollOffset\r\n * @prop {{ slide: Slide }} slideInit\r\n * @prop {{ slide: Slide }} afterSetContent\r\n * @prop {{ slide: Slide }} slideLoad\r\n * @prop {{ slide: Slide }} appendHeavy can be default prevented\r\n * @prop {{ slide: Slide }} appendHeavyContent\r\n * @prop {{ slide: Slide }} slideActivate\r\n * @prop {{ slide: Slide }} slideDeactivate\r\n * @prop {{ slide: Slide }} slideDestroy\r\n * @prop {{ destZoomLevel: number, centerPoint: Point | undefined, transitionDuration: number | false | undefined }} beforeZoomTo\r\n * @prop {{ slide: Slide }} zoomPanUpdate\r\n * @prop {{ slide: Slide }} initialZoomPan\r\n * @prop {{ slide: Slide }} calcSlideSize\r\n * @prop {undefined} resolutionChanged\r\n * @prop {{ originalEvent: WheelEvent }} wheel can be default prevented\r\n * @prop {{ content: Content }} contentAppendImage can be default prevented\r\n * @prop {{ index: number; itemData: SlideData }} lazyLoadSlide can be default prevented\r\n * @prop {undefined} lazyLoad\r\n * @prop {{ slide: Slide }} calcBounds\r\n * @prop {{ zoomLevels: ZoomLevel, slideData: SlideData }} zoomLevelsUpdate\r\n *\r\n *\r\n * legacy\r\n *\r\n * @prop {undefined} init\r\n * @prop {undefined} initialZoomIn\r\n * @prop {undefined} initialZoomOut\r\n * @prop {undefined} initialZoomInEnd\r\n * @prop {undefined} initialZoomOutEnd\r\n * @prop {{ dataSource: DataSource | undefined, numItems: number }} numItems\r\n * @prop {{ itemData: SlideData; index: number }} itemData\r\n * @prop {{ index: number, itemData: SlideData, instance: PhotoSwipe }} thumbBounds\r\n */\n\n/**\r\n * @typedef {Object} PhotoSwipeFiltersMap https://photoswipe.com/filters/\r\n *\r\n * @prop {(numItems: number, dataSource: DataSource | undefined) => number} numItems\r\n * Modify the total amount of slides. Example on Data sources page.\r\n * https://photoswipe.com/filters/#numitems\r\n *\r\n * @prop {(itemData: SlideData, index: number) => SlideData} itemData\r\n * Modify slide item data. Example on Data sources page.\r\n * https://photoswipe.com/filters/#itemdata\r\n *\r\n * @prop {(itemData: SlideData, element: HTMLElement, linkEl: HTMLAnchorElement) => SlideData} domItemData\r\n * Modify item data when it's parsed from DOM element. Example on Data sources page.\r\n * https://photoswipe.com/filters/#domitemdata\r\n *\r\n * @prop {(clickedIndex: number, e: MouseEvent, instance: PhotoSwipeLightbox) => number} clickedIndex\r\n * Modify clicked gallery item index.\r\n * https://photoswipe.com/filters/#clickedindex\r\n *\r\n * @prop {(placeholderSrc: string | false, content: Content) => string | false} placeholderSrc\r\n * Modify placeholder image source.\r\n * https://photoswipe.com/filters/#placeholdersrc\r\n *\r\n * @prop {(isContentLoading: boolean, content: Content) => boolean} isContentLoading\r\n * Modify if the content is currently loading.\r\n * https://photoswipe.com/filters/#iscontentloading\r\n *\r\n * @prop {(isContentZoomable: boolean, content: Content) => boolean} isContentZoomable\r\n * Modify if the content can be zoomed.\r\n * https://photoswipe.com/filters/#iscontentzoomable\r\n *\r\n * @prop {(useContentPlaceholder: boolean, content: Content) => boolean} useContentPlaceholder\r\n * Modify if the placeholder should be used for the content.\r\n * https://photoswipe.com/filters/#usecontentplaceholder\r\n *\r\n * @prop {(isKeepingPlaceholder: boolean, content: Content) => boolean} isKeepingPlaceholder\r\n * Modify if the placeholder should be kept after the content is loaded.\r\n * https://photoswipe.com/filters/#iskeepingplaceholder\r\n *\r\n *\r\n * @prop {(contentErrorElement: HTMLElement, content: Content) => HTMLElement} contentErrorElement\r\n * Modify an element when the content has error state (for example, if image cannot be loaded).\r\n * https://photoswipe.com/filters/#contenterrorelement\r\n *\r\n * @prop {(element: HTMLElement, data: UIElementData) => HTMLElement} uiElement\r\n * Modify a UI element that's being created.\r\n * https://photoswipe.com/filters/#uielement\r\n *\r\n * @prop {(thumbnail: HTMLElement | null | undefined, itemData: SlideData, index: number) => HTMLElement} thumbEl\r\n * Modify the thumbnail element from which opening zoom animation starts or ends.\r\n * https://photoswipe.com/filters/#thumbel\r\n *\r\n * @prop {(thumbBounds: Bounds | undefined, itemData: SlideData, index: number) => Bounds} thumbBounds\r\n * Modify the thumbnail bounds from which opening zoom animation starts or ends.\r\n * https://photoswipe.com/filters/#thumbbounds\r\n *\r\n * @prop {(srcsetSizesWidth: number, content: Content) => number} srcsetSizesWidth\r\n *\r\n * @prop {(preventPointerEvent: boolean, event: PointerEvent, pointerType: string) => boolean} preventPointerEvent\r\n *\r\n */\n\n/**\r\n * @template {keyof PhotoSwipeFiltersMap} T\r\n * @typedef {{ fn: PhotoSwipeFiltersMap[T], priority: number }} Filter\r\n */\n\n/**\r\n * @template {keyof PhotoSwipeEventsMap} T\r\n * @typedef {PhotoSwipeEventsMap[T] extends undefined ? PhotoSwipeEvent<T> : PhotoSwipeEvent<T> & PhotoSwipeEventsMap[T]} AugmentedEvent\r\n */\n\n/**\r\n * @template {keyof PhotoSwipeEventsMap} T\r\n * @typedef {(event: AugmentedEvent<T>) => void} EventCallback\r\n */\n\n/**\r\n * Base PhotoSwipe event object\r\n *\r\n * @template {keyof PhotoSwipeEventsMap} T\r\n */\nclass PhotoSwipeEvent {\n  /**\r\n   * @param {T} type\r\n   * @param {PhotoSwipeEventsMap[T]} [details]\r\n   */\n  constructor(type, details) {\n    this.type = type;\n    this.defaultPrevented = false;\n\n    if (details) {\n      Object.assign(this, details);\n    }\n  }\n\n  preventDefault() {\n    this.defaultPrevented = true;\n  }\n\n}\n/**\r\n * PhotoSwipe base class that can listen and dispatch for events.\r\n * Shared by PhotoSwipe Core and PhotoSwipe Lightbox, extended by base.js\r\n */\n\n\nclass Eventable {\n  constructor() {\n    /**\r\n     * @type {{ [T in keyof PhotoSwipeEventsMap]?: ((event: AugmentedEvent<T>) => void)[] }}\r\n     */\n    this._listeners = {};\n    /**\r\n     * @type {{ [T in keyof PhotoSwipeFiltersMap]?: Filter<T>[] }}\r\n     */\n\n    this._filters = {};\n    /** @type {PhotoSwipe | undefined} */\n\n    this.pswp = undefined;\n    /** @type {PhotoSwipeOptions | undefined} */\n\n    this.options = undefined;\n  }\n  /**\r\n   * @template {keyof PhotoSwipeFiltersMap} T\r\n   * @param {T} name\r\n   * @param {PhotoSwipeFiltersMap[T]} fn\r\n   * @param {number} priority\r\n   */\n\n\n  addFilter(name, fn, priority = 100) {\n    var _this$_filters$name, _this$_filters$name2, _this$pswp;\n\n    if (!this._filters[name]) {\n      this._filters[name] = [];\n    }\n\n    (_this$_filters$name = this._filters[name]) === null || _this$_filters$name === void 0 || _this$_filters$name.push({\n      fn,\n      priority\n    });\n    (_this$_filters$name2 = this._filters[name]) === null || _this$_filters$name2 === void 0 || _this$_filters$name2.sort((f1, f2) => f1.priority - f2.priority);\n    (_this$pswp = this.pswp) === null || _this$pswp === void 0 || _this$pswp.addFilter(name, fn, priority);\n  }\n  /**\r\n   * @template {keyof PhotoSwipeFiltersMap} T\r\n   * @param {T} name\r\n   * @param {PhotoSwipeFiltersMap[T]} fn\r\n   */\n\n\n  removeFilter(name, fn) {\n    if (this._filters[name]) {\n      // @ts-expect-error\n      this._filters[name] = this._filters[name].filter(filter => filter.fn !== fn);\n    }\n\n    if (this.pswp) {\n      this.pswp.removeFilter(name, fn);\n    }\n  }\n  /**\r\n   * @template {keyof PhotoSwipeFiltersMap} T\r\n   * @param {T} name\r\n   * @param {Parameters<PhotoSwipeFiltersMap[T]>} args\r\n   * @returns {Parameters<PhotoSwipeFiltersMap[T]>[0]}\r\n   */\n\n\n  applyFilters(name, ...args) {\n    var _this$_filters$name3;\n\n    (_this$_filters$name3 = this._filters[name]) === null || _this$_filters$name3 === void 0 || _this$_filters$name3.forEach(filter => {\n      // @ts-expect-error\n      args[0] = filter.fn.apply(this, args);\n    });\n    return args[0];\n  }\n  /**\r\n   * @template {keyof PhotoSwipeEventsMap} T\r\n   * @param {T} name\r\n   * @param {EventCallback<T>} fn\r\n   */\n\n\n  on(name, fn) {\n    var _this$_listeners$name, _this$pswp2;\n\n    if (!this._listeners[name]) {\n      this._listeners[name] = [];\n    }\n\n    (_this$_listeners$name = this._listeners[name]) === null || _this$_listeners$name === void 0 || _this$_listeners$name.push(fn); // When binding events to lightbox,\n    // also bind events to PhotoSwipe Core,\n    // if it's open.\n\n    (_this$pswp2 = this.pswp) === null || _this$pswp2 === void 0 || _this$pswp2.on(name, fn);\n  }\n  /**\r\n   * @template {keyof PhotoSwipeEventsMap} T\r\n   * @param {T} name\r\n   * @param {EventCallback<T>} fn\r\n   */\n\n\n  off(name, fn) {\n    var _this$pswp3;\n\n    if (this._listeners[name]) {\n      // @ts-expect-error\n      this._listeners[name] = this._listeners[name].filter(listener => fn !== listener);\n    }\n\n    (_this$pswp3 = this.pswp) === null || _this$pswp3 === void 0 || _this$pswp3.off(name, fn);\n  }\n  /**\r\n   * @template {keyof PhotoSwipeEventsMap} T\r\n   * @param {T} name\r\n   * @param {PhotoSwipeEventsMap[T]} [details]\r\n   * @returns {AugmentedEvent<T>}\r\n   */\n\n\n  dispatch(name, details) {\n    var _this$_listeners$name2;\n\n    if (this.pswp) {\n      return this.pswp.dispatch(name, details);\n    }\n\n    const event =\n    /** @type {AugmentedEvent<T>} */\n    new PhotoSwipeEvent(name, details);\n    (_this$_listeners$name2 = this._listeners[name]) === null || _this$_listeners$name2 === void 0 || _this$_listeners$name2.forEach(listener => {\n      listener.call(this, event);\n    });\n    return event;\n  }\n\n}\n\nclass Placeholder {\n  /**\r\n   * @param {string | false} imageSrc\r\n   * @param {HTMLElement} container\r\n   */\n  constructor(imageSrc, container) {\n    // Create placeholder\n    // (stretched thumbnail or simple div behind the main image)\n\n    /** @type {HTMLImageElement | HTMLDivElement | null} */\n    this.element = createElement('pswp__img pswp__img--placeholder', imageSrc ? 'img' : 'div', container);\n\n    if (imageSrc) {\n      const imgEl =\n      /** @type {HTMLImageElement} */\n      this.element;\n      imgEl.decoding = 'async';\n      imgEl.alt = '';\n      imgEl.src = imageSrc;\n      imgEl.setAttribute('role', 'presentation');\n    }\n\n    this.element.setAttribute('aria-hidden', 'true');\n  }\n  /**\r\n   * @param {number} width\r\n   * @param {number} height\r\n   */\n\n\n  setDisplayedSize(width, height) {\n    if (!this.element) {\n      return;\n    }\n\n    if (this.element.tagName === 'IMG') {\n      // Use transform scale() to modify img placeholder size\n      // (instead of changing width/height directly).\n      // This helps with performance, specifically in iOS15 Safari.\n      setWidthHeight(this.element, 250, 'auto');\n      this.element.style.transformOrigin = '0 0';\n      this.element.style.transform = toTransformString(0, 0, width / 250);\n    } else {\n      setWidthHeight(this.element, width, height);\n    }\n  }\n\n  destroy() {\n    var _this$element;\n\n    if ((_this$element = this.element) !== null && _this$element !== void 0 && _this$element.parentNode) {\n      this.element.remove();\n    }\n\n    this.element = null;\n  }\n\n}\n\n/** @typedef {import('./slide.js').default} Slide */\n\n/** @typedef {import('./slide.js').SlideData} SlideData */\n\n/** @typedef {import('../core/base.js').default} PhotoSwipeBase */\n\n/** @typedef {import('../util/util.js').LoadState} LoadState */\n\nclass Content {\n  /**\r\n   * @param {SlideData} itemData Slide data\r\n   * @param {PhotoSwipeBase} instance PhotoSwipe or PhotoSwipeLightbox instance\r\n   * @param {number} index\r\n   */\n  constructor(itemData, instance, index) {\n    this.instance = instance;\n    this.data = itemData;\n    this.index = index;\n    /** @type {HTMLImageElement | HTMLDivElement | undefined} */\n\n    this.element = undefined;\n    /** @type {Placeholder | undefined} */\n\n    this.placeholder = undefined;\n    /** @type {Slide | undefined} */\n\n    this.slide = undefined;\n    this.displayedImageWidth = 0;\n    this.displayedImageHeight = 0;\n    this.width = Number(this.data.w) || Number(this.data.width) || 0;\n    this.height = Number(this.data.h) || Number(this.data.height) || 0;\n    this.isAttached = false;\n    this.hasSlide = false;\n    this.isDecoding = false;\n    /** @type {LoadState} */\n\n    this.state = LOAD_STATE.IDLE;\n\n    if (this.data.type) {\n      this.type = this.data.type;\n    } else if (this.data.src) {\n      this.type = 'image';\n    } else {\n      this.type = 'html';\n    }\n\n    this.instance.dispatch('contentInit', {\n      content: this\n    });\n  }\n\n  removePlaceholder() {\n    if (this.placeholder && !this.keepPlaceholder()) {\n      // With delay, as image might be loaded, but not rendered\n      setTimeout(() => {\n        if (this.placeholder) {\n          this.placeholder.destroy();\n          this.placeholder = undefined;\n        }\n      }, 1000);\n    }\n  }\n  /**\r\n   * Preload content\r\n   *\r\n   * @param {boolean} isLazy\r\n   * @param {boolean} [reload]\r\n   */\n\n\n  load(isLazy, reload) {\n    if (this.slide && this.usePlaceholder()) {\n      if (!this.placeholder) {\n        const placeholderSrc = this.instance.applyFilters('placeholderSrc', // use  image-based placeholder only for the first slide,\n        // as rendering (even small stretched thumbnail) is an expensive operation\n        this.data.msrc && this.slide.isFirstSlide ? this.data.msrc : false, this);\n        this.placeholder = new Placeholder(placeholderSrc, this.slide.container);\n      } else {\n        const placeholderEl = this.placeholder.element; // Add placeholder to DOM if it was already created\n\n        if (placeholderEl && !placeholderEl.parentElement) {\n          this.slide.container.prepend(placeholderEl);\n        }\n      }\n    }\n\n    if (this.element && !reload) {\n      return;\n    }\n\n    if (this.instance.dispatch('contentLoad', {\n      content: this,\n      isLazy\n    }).defaultPrevented) {\n      return;\n    }\n\n    if (this.isImageContent()) {\n      this.element = createElement('pswp__img', 'img'); // Start loading only after width is defined, as sizes might depend on it.\n      // Due to Safari feature, we must define sizes before srcset.\n\n      if (this.displayedImageWidth) {\n        this.loadImage(isLazy);\n      }\n    } else {\n      this.element = createElement('pswp__content', 'div');\n      this.element.innerHTML = this.data.html || '';\n    }\n\n    if (reload && this.slide) {\n      this.slide.updateContentSize(true);\n    }\n  }\n  /**\r\n   * Preload image\r\n   *\r\n   * @param {boolean} isLazy\r\n   */\n\n\n  loadImage(isLazy) {\n    var _this$data$src, _this$data$alt;\n\n    if (!this.isImageContent() || !this.element || this.instance.dispatch('contentLoadImage', {\n      content: this,\n      isLazy\n    }).defaultPrevented) {\n      return;\n    }\n\n    const imageElement =\n    /** @type HTMLImageElement */\n    this.element;\n    this.updateSrcsetSizes();\n\n    if (this.data.srcset) {\n      imageElement.srcset = this.data.srcset;\n    }\n\n    imageElement.src = (_this$data$src = this.data.src) !== null && _this$data$src !== void 0 ? _this$data$src : '';\n    imageElement.alt = (_this$data$alt = this.data.alt) !== null && _this$data$alt !== void 0 ? _this$data$alt : '';\n    this.state = LOAD_STATE.LOADING;\n\n    if (imageElement.complete) {\n      this.onLoaded();\n    } else {\n      imageElement.onload = () => {\n        this.onLoaded();\n      };\n\n      imageElement.onerror = () => {\n        this.onError();\n      };\n    }\n  }\n  /**\r\n   * Assign slide to content\r\n   *\r\n   * @param {Slide} slide\r\n   */\n\n\n  setSlide(slide) {\n    this.slide = slide;\n    this.hasSlide = true;\n    this.instance = slide.pswp; // todo: do we need to unset slide?\n  }\n  /**\r\n   * Content load success handler\r\n   */\n\n\n  onLoaded() {\n    this.state = LOAD_STATE.LOADED;\n\n    if (this.slide && this.element) {\n      this.instance.dispatch('loadComplete', {\n        slide: this.slide,\n        content: this\n      }); // if content is reloaded\n\n      if (this.slide.isActive && this.slide.heavyAppended && !this.element.parentNode) {\n        this.append();\n        this.slide.updateContentSize(true);\n      }\n\n      if (this.state === LOAD_STATE.LOADED || this.state === LOAD_STATE.ERROR) {\n        this.removePlaceholder();\n      }\n    }\n  }\n  /**\r\n   * Content load error handler\r\n   */\n\n\n  onError() {\n    this.state = LOAD_STATE.ERROR;\n\n    if (this.slide) {\n      this.displayError();\n      this.instance.dispatch('loadComplete', {\n        slide: this.slide,\n        isError: true,\n        content: this\n      });\n      this.instance.dispatch('loadError', {\n        slide: this.slide,\n        content: this\n      });\n    }\n  }\n  /**\r\n   * @returns {Boolean} If the content is currently loading\r\n   */\n\n\n  isLoading() {\n    return this.instance.applyFilters('isContentLoading', this.state === LOAD_STATE.LOADING, this);\n  }\n  /**\r\n   * @returns {Boolean} If the content is in error state\r\n   */\n\n\n  isError() {\n    return this.state === LOAD_STATE.ERROR;\n  }\n  /**\r\n   * @returns {boolean} If the content is image\r\n   */\n\n\n  isImageContent() {\n    return this.type === 'image';\n  }\n  /**\r\n   * Update content size\r\n   *\r\n   * @param {Number} width\r\n   * @param {Number} height\r\n   */\n\n\n  setDisplayedSize(width, height) {\n    if (!this.element) {\n      return;\n    }\n\n    if (this.placeholder) {\n      this.placeholder.setDisplayedSize(width, height);\n    }\n\n    if (this.instance.dispatch('contentResize', {\n      content: this,\n      width,\n      height\n    }).defaultPrevented) {\n      return;\n    }\n\n    setWidthHeight(this.element, width, height);\n\n    if (this.isImageContent() && !this.isError()) {\n      const isInitialSizeUpdate = !this.displayedImageWidth && width;\n      this.displayedImageWidth = width;\n      this.displayedImageHeight = height;\n\n      if (isInitialSizeUpdate) {\n        this.loadImage(false);\n      } else {\n        this.updateSrcsetSizes();\n      }\n\n      if (this.slide) {\n        this.instance.dispatch('imageSizeChange', {\n          slide: this.slide,\n          width,\n          height,\n          content: this\n        });\n      }\n    }\n  }\n  /**\r\n   * @returns {boolean} If the content can be zoomed\r\n   */\n\n\n  isZoomable() {\n    return this.instance.applyFilters('isContentZoomable', this.isImageContent() && this.state !== LOAD_STATE.ERROR, this);\n  }\n  /**\r\n   * Update image srcset sizes attribute based on width and height\r\n   */\n\n\n  updateSrcsetSizes() {\n    // Handle srcset sizes attribute.\n    //\n    // Never lower quality, if it was increased previously.\n    // Chrome does this automatically, Firefox and Safari do not,\n    // so we store largest used size in dataset.\n    if (!this.isImageContent() || !this.element || !this.data.srcset) {\n      return;\n    }\n\n    const image =\n    /** @type HTMLImageElement */\n    this.element;\n    const sizesWidth = this.instance.applyFilters('srcsetSizesWidth', this.displayedImageWidth, this);\n\n    if (!image.dataset.largestUsedSize || sizesWidth > parseInt(image.dataset.largestUsedSize, 10)) {\n      image.sizes = sizesWidth + 'px';\n      image.dataset.largestUsedSize = String(sizesWidth);\n    }\n  }\n  /**\r\n   * @returns {boolean} If content should use a placeholder (from msrc by default)\r\n   */\n\n\n  usePlaceholder() {\n    return this.instance.applyFilters('useContentPlaceholder', this.isImageContent(), this);\n  }\n  /**\r\n   * Preload content with lazy-loading param\r\n   */\n\n\n  lazyLoad() {\n    if (this.instance.dispatch('contentLazyLoad', {\n      content: this\n    }).defaultPrevented) {\n      return;\n    }\n\n    this.load(true);\n  }\n  /**\r\n   * @returns {boolean} If placeholder should be kept after content is loaded\r\n   */\n\n\n  keepPlaceholder() {\n    return this.instance.applyFilters('isKeepingPlaceholder', this.isLoading(), this);\n  }\n  /**\r\n   * Destroy the content\r\n   */\n\n\n  destroy() {\n    this.hasSlide = false;\n    this.slide = undefined;\n\n    if (this.instance.dispatch('contentDestroy', {\n      content: this\n    }).defaultPrevented) {\n      return;\n    }\n\n    this.remove();\n\n    if (this.placeholder) {\n      this.placeholder.destroy();\n      this.placeholder = undefined;\n    }\n\n    if (this.isImageContent() && this.element) {\n      this.element.onload = null;\n      this.element.onerror = null;\n      this.element = undefined;\n    }\n  }\n  /**\r\n   * Display error message\r\n   */\n\n\n  displayError() {\n    if (this.slide) {\n      var _this$instance$option, _this$instance$option2;\n\n      let errorMsgEl = createElement('pswp__error-msg', 'div');\n      errorMsgEl.innerText = (_this$instance$option = (_this$instance$option2 = this.instance.options) === null || _this$instance$option2 === void 0 ? void 0 : _this$instance$option2.errorMsg) !== null && _this$instance$option !== void 0 ? _this$instance$option : '';\n      errorMsgEl =\n      /** @type {HTMLDivElement} */\n      this.instance.applyFilters('contentErrorElement', errorMsgEl, this);\n      this.element = createElement('pswp__content pswp__error-msg-container', 'div');\n      this.element.appendChild(errorMsgEl);\n      this.slide.container.innerText = '';\n      this.slide.container.appendChild(this.element);\n      this.slide.updateContentSize(true);\n      this.removePlaceholder();\n    }\n  }\n  /**\r\n   * Append the content\r\n   */\n\n\n  append() {\n    if (this.isAttached || !this.element) {\n      return;\n    }\n\n    this.isAttached = true;\n\n    if (this.state === LOAD_STATE.ERROR) {\n      this.displayError();\n      return;\n    }\n\n    if (this.instance.dispatch('contentAppend', {\n      content: this\n    }).defaultPrevented) {\n      return;\n    }\n\n    const supportsDecode = ('decode' in this.element);\n\n    if (this.isImageContent()) {\n      // Use decode() on nearby slides\n      //\n      // Nearby slide images are in DOM and not hidden via display:none.\n      // However, they are placed offscreen (to the left and right side).\n      //\n      // Some browsers do not composite the image until it's actually visible,\n      // using decode() helps.\n      //\n      // You might ask \"why dont you just decode() and then append all images\",\n      // that's because I want to show image before it's fully loaded,\n      // as browser can render parts of image while it is loading.\n      // We do not do this in Safari due to partial loading bug.\n      if (supportsDecode && this.slide && (!this.slide.isActive || isSafari())) {\n        this.isDecoding = true; // purposefully using finally instead of then,\n        // as if srcset sizes changes dynamically - it may cause decode error\n\n        /** @type {HTMLImageElement} */\n\n        this.element.decode().catch(() => {}).finally(() => {\n          this.isDecoding = false;\n          this.appendImage();\n        });\n      } else {\n        this.appendImage();\n      }\n    } else if (this.slide && !this.element.parentNode) {\n      this.slide.container.appendChild(this.element);\n    }\n  }\n  /**\r\n   * Activate the slide,\r\n   * active slide is generally the current one,\r\n   * meaning the user can see it.\r\n   */\n\n\n  activate() {\n    if (this.instance.dispatch('contentActivate', {\n      content: this\n    }).defaultPrevented || !this.slide) {\n      return;\n    }\n\n    if (this.isImageContent() && this.isDecoding && !isSafari()) {\n      // add image to slide when it becomes active,\n      // even if it's not finished decoding\n      this.appendImage();\n    } else if (this.isError()) {\n      this.load(false, true); // try to reload\n    }\n\n    if (this.slide.holderElement) {\n      this.slide.holderElement.setAttribute('aria-hidden', 'false');\n    }\n  }\n  /**\r\n   * Deactivate the content\r\n   */\n\n\n  deactivate() {\n    this.instance.dispatch('contentDeactivate', {\n      content: this\n    });\n\n    if (this.slide && this.slide.holderElement) {\n      this.slide.holderElement.setAttribute('aria-hidden', 'true');\n    }\n  }\n  /**\r\n   * Remove the content from DOM\r\n   */\n\n\n  remove() {\n    this.isAttached = false;\n\n    if (this.instance.dispatch('contentRemove', {\n      content: this\n    }).defaultPrevented) {\n      return;\n    }\n\n    if (this.element && this.element.parentNode) {\n      this.element.remove();\n    }\n\n    if (this.placeholder && this.placeholder.element) {\n      this.placeholder.element.remove();\n    }\n  }\n  /**\r\n   * Append the image content to slide container\r\n   */\n\n\n  appendImage() {\n    if (!this.isAttached) {\n      return;\n    }\n\n    if (this.instance.dispatch('contentAppendImage', {\n      content: this\n    }).defaultPrevented) {\n      return;\n    } // ensure that element exists and is not already appended\n\n\n    if (this.slide && this.element && !this.element.parentNode) {\n      this.slide.container.appendChild(this.element);\n    }\n\n    if (this.state === LOAD_STATE.LOADED || this.state === LOAD_STATE.ERROR) {\n      this.removePlaceholder();\n    }\n  }\n\n}\n\n/** @typedef {import('../photoswipe.js').PhotoSwipeOptions} PhotoSwipeOptions */\n\n/** @typedef {import('../core/base.js').default} PhotoSwipeBase */\n\n/** @typedef {import('../photoswipe.js').Point} Point */\n\n/** @typedef {import('../slide/slide.js').SlideData} SlideData */\n\n/**\r\n * @param {PhotoSwipeOptions} options\r\n * @param {PhotoSwipeBase} pswp\r\n * @returns {Point}\r\n */\nfunction getViewportSize(options, pswp) {\n  if (options.getViewportSizeFn) {\n    const newViewportSize = options.getViewportSizeFn(options, pswp);\n\n    if (newViewportSize) {\n      return newViewportSize;\n    }\n  }\n\n  return {\n    x: document.documentElement.clientWidth,\n    // TODO: height on mobile is very incosistent due to toolbar\n    // find a way to improve this\n    //\n    // document.documentElement.clientHeight - doesn't seem to work well\n    y: window.innerHeight\n  };\n}\n/**\r\n * Parses padding option.\r\n * Supported formats:\r\n *\r\n * // Object\r\n * padding: {\r\n *  top: 0,\r\n *  bottom: 0,\r\n *  left: 0,\r\n *  right: 0\r\n * }\r\n *\r\n * // A function that returns the object\r\n * paddingFn: (viewportSize, itemData, index) => {\r\n *  return {\r\n *    top: 0,\r\n *    bottom: 0,\r\n *    left: 0,\r\n *    right: 0\r\n *  };\r\n * }\r\n *\r\n * // Legacy variant\r\n * paddingLeft: 0,\r\n * paddingRight: 0,\r\n * paddingTop: 0,\r\n * paddingBottom: 0,\r\n *\r\n * @param {'left' | 'top' | 'bottom' | 'right'} prop\r\n * @param {PhotoSwipeOptions} options PhotoSwipe options\r\n * @param {Point} viewportSize PhotoSwipe viewport size, for example: { x:800, y:600 }\r\n * @param {SlideData} itemData Data about the slide\r\n * @param {number} index Slide index\r\n * @returns {number}\r\n */\n\nfunction parsePaddingOption(prop, options, viewportSize, itemData, index) {\n  let paddingValue = 0;\n\n  if (options.paddingFn) {\n    paddingValue = options.paddingFn(viewportSize, itemData, index)[prop];\n  } else if (options.padding) {\n    paddingValue = options.padding[prop];\n  } else {\n    const legacyPropName = 'padding' + prop[0].toUpperCase() + prop.slice(1); // @ts-expect-error\n\n    if (options[legacyPropName]) {\n      // @ts-expect-error\n      paddingValue = options[legacyPropName];\n    }\n  }\n\n  return Number(paddingValue) || 0;\n}\n/**\r\n * @param {PhotoSwipeOptions} options\r\n * @param {Point} viewportSize\r\n * @param {SlideData} itemData\r\n * @param {number} index\r\n * @returns {Point}\r\n */\n\nfunction getPanAreaSize(options, viewportSize, itemData, index) {\n  return {\n    x: viewportSize.x - parsePaddingOption('left', options, viewportSize, itemData, index) - parsePaddingOption('right', options, viewportSize, itemData, index),\n    y: viewportSize.y - parsePaddingOption('top', options, viewportSize, itemData, index) - parsePaddingOption('bottom', options, viewportSize, itemData, index)\n  };\n}\n\nconst MAX_IMAGE_WIDTH = 4000;\n/** @typedef {import('../photoswipe.js').default} PhotoSwipe */\n\n/** @typedef {import('../photoswipe.js').PhotoSwipeOptions} PhotoSwipeOptions */\n\n/** @typedef {import('../photoswipe.js').Point} Point */\n\n/** @typedef {import('../slide/slide.js').SlideData} SlideData */\n\n/** @typedef {'fit' | 'fill' | number | ((zoomLevelObject: ZoomLevel) => number)} ZoomLevelOption */\n\n/**\r\n * Calculates zoom levels for specific slide.\r\n * Depends on viewport size and image size.\r\n */\n\nclass ZoomLevel {\n  /**\r\n   * @param {PhotoSwipeOptions} options PhotoSwipe options\r\n   * @param {SlideData} itemData Slide data\r\n   * @param {number} index Slide index\r\n   * @param {PhotoSwipe} [pswp] PhotoSwipe instance, can be undefined if not initialized yet\r\n   */\n  constructor(options, itemData, index, pswp) {\n    this.pswp = pswp;\n    this.options = options;\n    this.itemData = itemData;\n    this.index = index;\n    /** @type { Point | null } */\n\n    this.panAreaSize = null;\n    /** @type { Point | null } */\n\n    this.elementSize = null;\n    this.fit = 1;\n    this.fill = 1;\n    this.vFill = 1;\n    this.initial = 1;\n    this.secondary = 1;\n    this.max = 1;\n    this.min = 1;\n  }\n  /**\r\n   * Calculate initial, secondary and maximum zoom level for the specified slide.\r\n   *\r\n   * It should be called when either image or viewport size changes.\r\n   *\r\n   * @param {number} maxWidth\r\n   * @param {number} maxHeight\r\n   * @param {Point} panAreaSize\r\n   */\n\n\n  update(maxWidth, maxHeight, panAreaSize) {\n    /** @type {Point} */\n    const elementSize = {\n      x: maxWidth,\n      y: maxHeight\n    };\n    this.elementSize = elementSize;\n    this.panAreaSize = panAreaSize;\n    const hRatio = panAreaSize.x / elementSize.x;\n    const vRatio = panAreaSize.y / elementSize.y;\n    this.fit = Math.min(1, hRatio < vRatio ? hRatio : vRatio);\n    this.fill = Math.min(1, hRatio > vRatio ? hRatio : vRatio); // zoom.vFill defines zoom level of the image\n    // when it has 100% of viewport vertical space (height)\n\n    this.vFill = Math.min(1, vRatio);\n    this.initial = this._getInitial();\n    this.secondary = this._getSecondary();\n    this.max = Math.max(this.initial, this.secondary, this._getMax());\n    this.min = Math.min(this.fit, this.initial, this.secondary);\n\n    if (this.pswp) {\n      this.pswp.dispatch('zoomLevelsUpdate', {\n        zoomLevels: this,\n        slideData: this.itemData\n      });\n    }\n  }\n  /**\r\n   * Parses user-defined zoom option.\r\n   *\r\n   * @private\r\n   * @param {'initial' | 'secondary' | 'max'} optionPrefix Zoom level option prefix (initial, secondary, max)\r\n   * @returns { number | undefined }\r\n   */\n\n\n  _parseZoomLevelOption(optionPrefix) {\n    const optionName =\n    /** @type {'initialZoomLevel' | 'secondaryZoomLevel' | 'maxZoomLevel'} */\n    optionPrefix + 'ZoomLevel';\n    const optionValue = this.options[optionName];\n\n    if (!optionValue) {\n      return;\n    }\n\n    if (typeof optionValue === 'function') {\n      return optionValue(this);\n    }\n\n    if (optionValue === 'fill') {\n      return this.fill;\n    }\n\n    if (optionValue === 'fit') {\n      return this.fit;\n    }\n\n    return Number(optionValue);\n  }\n  /**\r\n   * Get zoom level to which image will be zoomed after double-tap gesture,\r\n   * or when user clicks on zoom icon,\r\n   * or mouse-click on image itself.\r\n   * If you return 1 image will be zoomed to its original size.\r\n   *\r\n   * @private\r\n   * @return {number}\r\n   */\n\n\n  _getSecondary() {\n    let currZoomLevel = this._parseZoomLevelOption('secondary');\n\n    if (currZoomLevel) {\n      return currZoomLevel;\n    } // 3x of \"fit\" state, but not larger than original\n\n\n    currZoomLevel = Math.min(1, this.fit * 3);\n\n    if (this.elementSize && currZoomLevel * this.elementSize.x > MAX_IMAGE_WIDTH) {\n      currZoomLevel = MAX_IMAGE_WIDTH / this.elementSize.x;\n    }\n\n    return currZoomLevel;\n  }\n  /**\r\n   * Get initial image zoom level.\r\n   *\r\n   * @private\r\n   * @return {number}\r\n   */\n\n\n  _getInitial() {\n    return this._parseZoomLevelOption('initial') || this.fit;\n  }\n  /**\r\n   * Maximum zoom level when user zooms\r\n   * via zoom/pinch gesture,\r\n   * via cmd/ctrl-wheel or via trackpad.\r\n   *\r\n   * @private\r\n   * @return {number}\r\n   */\n\n\n  _getMax() {\n    // max zoom level is x4 from \"fit state\",\n    // used for zoom gesture and ctrl/trackpad zoom\n    return this._parseZoomLevelOption('max') || Math.max(1, this.fit * 4);\n  }\n\n}\n\n/**\r\n * Lazy-load an image\r\n * This function is used both by Lightbox and PhotoSwipe core,\r\n * thus it can be called before dialog is opened.\r\n *\r\n * @param {SlideData} itemData Data about the slide\r\n * @param {PhotoSwipeBase} instance PhotoSwipe or PhotoSwipeLightbox instance\r\n * @param {number} index\r\n * @returns {Content} Image that is being decoded or false.\r\n */\n\nfunction lazyLoadData(itemData, instance, index) {\n  const content = instance.createContentFromData(itemData, index);\n  /** @type {ZoomLevel | undefined} */\n\n  let zoomLevel;\n  const {\n    options\n  } = instance; // We need to know dimensions of the image to preload it,\n  // as it might use srcset, and we need to define sizes\n\n  if (options) {\n    zoomLevel = new ZoomLevel(options, itemData, -1);\n    let viewportSize;\n\n    if (instance.pswp) {\n      viewportSize = instance.pswp.viewportSize;\n    } else {\n      viewportSize = getViewportSize(options, instance);\n    }\n\n    const panAreaSize = getPanAreaSize(options, viewportSize, itemData, index);\n    zoomLevel.update(content.width, content.height, panAreaSize);\n  }\n\n  content.lazyLoad();\n\n  if (zoomLevel) {\n    content.setDisplayedSize(Math.ceil(content.width * zoomLevel.initial), Math.ceil(content.height * zoomLevel.initial));\n  }\n\n  return content;\n}\n/**\r\n * Lazy-loads specific slide.\r\n * This function is used both by Lightbox and PhotoSwipe core,\r\n * thus it can be called before dialog is opened.\r\n *\r\n * By default, it loads image based on viewport size and initial zoom level.\r\n *\r\n * @param {number} index Slide index\r\n * @param {PhotoSwipeBase} instance PhotoSwipe or PhotoSwipeLightbox eventable instance\r\n * @returns {Content | undefined}\r\n */\n\nfunction lazyLoadSlide(index, instance) {\n  const itemData = instance.getItemData(index);\n\n  if (instance.dispatch('lazyLoadSlide', {\n    index,\n    itemData\n  }).defaultPrevented) {\n    return;\n  }\n\n  return lazyLoadData(itemData, instance, index);\n}\n\n/** @typedef {import(\"../photoswipe.js\").default} PhotoSwipe */\n\n/** @typedef {import(\"../slide/slide.js\").SlideData} SlideData */\n\n/**\r\n * PhotoSwipe base class that can retrieve data about every slide.\r\n * Shared by PhotoSwipe Core and PhotoSwipe Lightbox\r\n */\n\nclass PhotoSwipeBase extends Eventable {\n  /**\r\n   * Get total number of slides\r\n   *\r\n   * @returns {number}\r\n   */\n  getNumItems() {\n    var _this$options;\n\n    let numItems = 0;\n    const dataSource = (_this$options = this.options) === null || _this$options === void 0 ? void 0 : _this$options.dataSource;\n\n    if (dataSource && 'length' in dataSource) {\n      // may be an array or just object with length property\n      numItems = dataSource.length;\n    } else if (dataSource && 'gallery' in dataSource) {\n      // query DOM elements\n      if (!dataSource.items) {\n        dataSource.items = this._getGalleryDOMElements(dataSource.gallery);\n      }\n\n      if (dataSource.items) {\n        numItems = dataSource.items.length;\n      }\n    } // legacy event, before filters were introduced\n\n\n    const event = this.dispatch('numItems', {\n      dataSource,\n      numItems\n    });\n    return this.applyFilters('numItems', event.numItems, dataSource);\n  }\n  /**\r\n   * @param {SlideData} slideData\r\n   * @param {number} index\r\n   * @returns {Content}\r\n   */\n\n\n  createContentFromData(slideData, index) {\n    return new Content(slideData, this, index);\n  }\n  /**\r\n   * Get item data by index.\r\n   *\r\n   * \"item data\" should contain normalized information that PhotoSwipe needs to generate a slide.\r\n   * For example, it may contain properties like\r\n   * `src`, `srcset`, `w`, `h`, which will be used to generate a slide with image.\r\n   *\r\n   * @param {number} index\r\n   * @returns {SlideData}\r\n   */\n\n\n  getItemData(index) {\n    var _this$options2;\n\n    const dataSource = (_this$options2 = this.options) === null || _this$options2 === void 0 ? void 0 : _this$options2.dataSource;\n    /** @type {SlideData | HTMLElement} */\n\n    let dataSourceItem = {};\n\n    if (Array.isArray(dataSource)) {\n      // Datasource is an array of elements\n      dataSourceItem = dataSource[index];\n    } else if (dataSource && 'gallery' in dataSource) {\n      // dataSource has gallery property,\n      // thus it was created by Lightbox, based on\n      // gallery and children options\n      // query DOM elements\n      if (!dataSource.items) {\n        dataSource.items = this._getGalleryDOMElements(dataSource.gallery);\n      }\n\n      dataSourceItem = dataSource.items[index];\n    }\n\n    let itemData = dataSourceItem;\n\n    if (itemData instanceof Element) {\n      itemData = this._domElementToItemData(itemData);\n    } // Dispatching the itemData event,\n    // it's a legacy verion before filters were introduced\n\n\n    const event = this.dispatch('itemData', {\n      itemData: itemData || {},\n      index\n    });\n    return this.applyFilters('itemData', event.itemData, index);\n  }\n  /**\r\n   * Get array of gallery DOM elements,\r\n   * based on childSelector and gallery element.\r\n   *\r\n   * @param {HTMLElement} galleryElement\r\n   * @returns {HTMLElement[]}\r\n   */\n\n\n  _getGalleryDOMElements(galleryElement) {\n    var _this$options3, _this$options4;\n\n    if ((_this$options3 = this.options) !== null && _this$options3 !== void 0 && _this$options3.children || (_this$options4 = this.options) !== null && _this$options4 !== void 0 && _this$options4.childSelector) {\n      return getElementsFromOption(this.options.children, this.options.childSelector, galleryElement) || [];\n    }\n\n    return [galleryElement];\n  }\n  /**\r\n   * Converts DOM element to item data object.\r\n   *\r\n   * @param {HTMLElement} element DOM element\r\n   * @returns {SlideData}\r\n   */\n\n\n  _domElementToItemData(element) {\n    /** @type {SlideData} */\n    const itemData = {\n      element\n    };\n    const linkEl =\n    /** @type {HTMLAnchorElement} */\n    element.tagName === 'A' ? element : element.querySelector('a');\n\n    if (linkEl) {\n      // src comes from data-pswp-src attribute,\n      // if it's empty link href is used\n      itemData.src = linkEl.dataset.pswpSrc || linkEl.href;\n\n      if (linkEl.dataset.pswpSrcset) {\n        itemData.srcset = linkEl.dataset.pswpSrcset;\n      }\n\n      itemData.width = linkEl.dataset.pswpWidth ? parseInt(linkEl.dataset.pswpWidth, 10) : 0;\n      itemData.height = linkEl.dataset.pswpHeight ? parseInt(linkEl.dataset.pswpHeight, 10) : 0; // support legacy w & h properties\n\n      itemData.w = itemData.width;\n      itemData.h = itemData.height;\n\n      if (linkEl.dataset.pswpType) {\n        itemData.type = linkEl.dataset.pswpType;\n      }\n\n      const thumbnailEl = element.querySelector('img');\n\n      if (thumbnailEl) {\n        var _thumbnailEl$getAttri;\n\n        // msrc is URL to placeholder image that's displayed before large image is loaded\n        // by default it's displayed only for the first slide\n        itemData.msrc = thumbnailEl.currentSrc || thumbnailEl.src;\n        itemData.alt = (_thumbnailEl$getAttri = thumbnailEl.getAttribute('alt')) !== null && _thumbnailEl$getAttri !== void 0 ? _thumbnailEl$getAttri : '';\n      }\n\n      if (linkEl.dataset.pswpCropped || linkEl.dataset.cropped) {\n        itemData.thumbCropped = true;\n      }\n    }\n\n    return this.applyFilters('domItemData', itemData, element, linkEl);\n  }\n  /**\r\n   * Lazy-load by slide data\r\n   *\r\n   * @param {SlideData} itemData Data about the slide\r\n   * @param {number} index\r\n   * @returns {Content} Image that is being decoded or false.\r\n   */\n\n\n  lazyLoadData(itemData, index) {\n    return lazyLoadData(itemData, this, index);\n  }\n\n}\n\n/**\r\n * @template T\r\n * @typedef {import('../types.js').Type<T>} Type<T>\r\n */\n\n/** @typedef {import('../photoswipe.js').default} PhotoSwipe */\n\n/** @typedef {import('../photoswipe.js').PhotoSwipeOptions} PhotoSwipeOptions */\n\n/** @typedef {import('../photoswipe.js').DataSource} DataSource */\n\n/** @typedef {import('../photoswipe.js').Point} Point */\n\n/** @typedef {import('../slide/content.js').default} Content */\n\n/** @typedef {import('../core/eventable.js').PhotoSwipeEventsMap} PhotoSwipeEventsMap */\n\n/** @typedef {import('../core/eventable.js').PhotoSwipeFiltersMap} PhotoSwipeFiltersMap */\n\n/**\r\n * @template {keyof PhotoSwipeEventsMap} T\r\n * @typedef {import('../core/eventable.js').EventCallback<T>} EventCallback<T>\r\n */\n\n/**\r\n * PhotoSwipe Lightbox\r\n *\r\n * - If user has unsupported browser it falls back to default browser action (just opens URL)\r\n * - Binds click event to links that should open PhotoSwipe\r\n * - parses DOM strcture for PhotoSwipe (retrieves large image URLs and sizes)\r\n * - Initializes PhotoSwipe\r\n *\r\n *\r\n * Loader options use the same object as PhotoSwipe, and supports such options:\r\n *\r\n * gallery - Element | Element[] | NodeList | string selector for the gallery element\r\n * children - Element | Element[] | NodeList | string selector for the gallery children\r\n *\r\n */\n\nclass PhotoSwipeLightbox extends PhotoSwipeBase {\n  /**\r\n   * @param {PhotoSwipeOptions} [options]\r\n   */\n  constructor(options) {\n    super();\n    /** @type {PhotoSwipeOptions} */\n\n    this.options = options || {};\n    this._uid = 0;\n    this.shouldOpen = false;\n    /**\r\n     * @private\r\n     * @type {Content | undefined}\r\n     */\n\n    this._preloadedContent = undefined;\n    this.onThumbnailsClick = this.onThumbnailsClick.bind(this);\n  }\n  /**\r\n   * Initialize lightbox, should be called only once.\r\n   * It's not included in the main constructor, so you may bind events before it.\r\n   */\n\n\n  init() {\n    // Bind click events to each gallery\n    getElementsFromOption(this.options.gallery, this.options.gallerySelector).forEach(galleryElement => {\n      galleryElement.addEventListener('click', this.onThumbnailsClick, false);\n    });\n  }\n  /**\r\n   * @param {MouseEvent} e\r\n   */\n\n\n  onThumbnailsClick(e) {\n    // Exit and allow default browser action if:\n    if (specialKeyUsed(e) // ... if clicked with a special key (ctrl/cmd...)\n    || window.pswp) {\n      // ... if PhotoSwipe is already open\n      return;\n    } // If both clientX and clientY are 0 or not defined,\n    // the event is likely triggered by keyboard,\n    // so we do not pass the initialPoint\n    //\n    // Note that some screen readers emulate the mouse position,\n    // so it's not the ideal way to detect them.\n    //\n\n    /** @type {Point | null} */\n\n\n    let initialPoint = {\n      x: e.clientX,\n      y: e.clientY\n    };\n\n    if (!initialPoint.x && !initialPoint.y) {\n      initialPoint = null;\n    }\n\n    let clickedIndex = this.getClickedIndex(e);\n    clickedIndex = this.applyFilters('clickedIndex', clickedIndex, e, this);\n    /** @type {DataSource} */\n\n    const dataSource = {\n      gallery:\n      /** @type {HTMLElement} */\n      e.currentTarget\n    };\n\n    if (clickedIndex >= 0) {\n      e.preventDefault();\n      this.loadAndOpen(clickedIndex, dataSource, initialPoint);\n    }\n  }\n  /**\r\n   * Get index of gallery item that was clicked.\r\n   *\r\n   * @param {MouseEvent} e click event\r\n   * @returns {number}\r\n   */\n\n\n  getClickedIndex(e) {\n    // legacy option\n    if (this.options.getClickedIndexFn) {\n      return this.options.getClickedIndexFn.call(this, e);\n    }\n\n    const clickedTarget =\n    /** @type {HTMLElement} */\n    e.target;\n    const childElements = getElementsFromOption(this.options.children, this.options.childSelector,\n    /** @type {HTMLElement} */\n    e.currentTarget);\n    const clickedChildIndex = childElements.findIndex(child => child === clickedTarget || child.contains(clickedTarget));\n\n    if (clickedChildIndex !== -1) {\n      return clickedChildIndex;\n    } else if (this.options.children || this.options.childSelector) {\n      // click wasn't on a child element\n      return -1;\n    } // There is only one item (which is the gallery)\n\n\n    return 0;\n  }\n  /**\r\n   * Load and open PhotoSwipe\r\n   *\r\n   * @param {number} index\r\n   * @param {DataSource} [dataSource]\r\n   * @param {Point | null} [initialPoint]\r\n   * @returns {boolean}\r\n   */\n\n\n  loadAndOpen(index, dataSource, initialPoint) {\n    // Check if the gallery is already open\n    if (window.pswp || !this.options) {\n      return false;\n    } // Use the first gallery element if dataSource is not provided\n\n\n    if (!dataSource && this.options.gallery && this.options.children) {\n      const galleryElements = getElementsFromOption(this.options.gallery);\n\n      if (galleryElements[0]) {\n        dataSource = {\n          gallery: galleryElements[0]\n        };\n      }\n    } // set initial index\n\n\n    this.options.index = index; // define options for PhotoSwipe constructor\n\n    this.options.initialPointerPos = initialPoint;\n    this.shouldOpen = true;\n    this.preload(index, dataSource);\n    return true;\n  }\n  /**\r\n   * Load the main module and the slide content by index\r\n   *\r\n   * @param {number} index\r\n   * @param {DataSource} [dataSource]\r\n   */\n\n\n  preload(index, dataSource) {\n    const {\n      options\n    } = this;\n\n    if (dataSource) {\n      options.dataSource = dataSource;\n    } // Add the main module\n\n    /** @type {Promise<Type<PhotoSwipe>>[]} */\n\n\n    const promiseArray = [];\n    const pswpModuleType = typeof options.pswpModule;\n\n    if (isPswpClass(options.pswpModule)) {\n      promiseArray.push(Promise.resolve(\n      /** @type {Type<PhotoSwipe>} */\n      options.pswpModule));\n    } else if (pswpModuleType === 'string') {\n      throw new Error('pswpModule as string is no longer supported');\n    } else if (pswpModuleType === 'function') {\n      promiseArray.push(\n      /** @type {() => Promise<Type<PhotoSwipe>>} */\n      options.pswpModule());\n    } else {\n      throw new Error('pswpModule is not valid');\n    } // Add custom-defined promise, if any\n\n\n    if (typeof options.openPromise === 'function') {\n      // allow developers to perform some task before opening\n      promiseArray.push(options.openPromise());\n    }\n\n    if (options.preloadFirstSlide !== false && index >= 0) {\n      this._preloadedContent = lazyLoadSlide(index, this);\n    } // Wait till all promises resolve and open PhotoSwipe\n\n\n    const uid = ++this._uid;\n    Promise.all(promiseArray).then(iterableModules => {\n      if (this.shouldOpen) {\n        const mainModule = iterableModules[0];\n\n        this._openPhotoswipe(mainModule, uid);\n      }\n    });\n  }\n  /**\r\n   * @private\r\n   * @param {Type<PhotoSwipe> | { default: Type<PhotoSwipe> }} module\r\n   * @param {number} uid\r\n   */\n\n\n  _openPhotoswipe(module, uid) {\n    // Cancel opening if UID doesn't match the current one\n    // (if user clicked on another gallery item before current was loaded).\n    //\n    // Or if shouldOpen flag is set to false\n    // (developer may modify it via public API)\n    if (uid !== this._uid && this.shouldOpen) {\n      return;\n    }\n\n    this.shouldOpen = false; // PhotoSwipe is already open\n\n    if (window.pswp) {\n      return;\n    }\n    /**\r\n     * Pass data to PhotoSwipe and open init\r\n     *\r\n     * @type {PhotoSwipe}\r\n     */\n\n\n    const pswp = typeof module === 'object' ? new module.default(this.options) // eslint-disable-line\n    : new module(this.options); // eslint-disable-line\n\n    this.pswp = pswp;\n    window.pswp = pswp; // map listeners from Lightbox to PhotoSwipe Core\n\n    /** @type {(keyof PhotoSwipeEventsMap)[]} */\n\n    Object.keys(this._listeners).forEach(name => {\n      var _this$_listeners$name;\n\n      (_this$_listeners$name = this._listeners[name]) === null || _this$_listeners$name === void 0 || _this$_listeners$name.forEach(fn => {\n        pswp.on(name,\n        /** @type {EventCallback<typeof name>} */\n        fn);\n      });\n    }); // same with filters\n\n    /** @type {(keyof PhotoSwipeFiltersMap)[]} */\n\n    Object.keys(this._filters).forEach(name => {\n      var _this$_filters$name;\n\n      (_this$_filters$name = this._filters[name]) === null || _this$_filters$name === void 0 || _this$_filters$name.forEach(filter => {\n        pswp.addFilter(name, filter.fn, filter.priority);\n      });\n    });\n\n    if (this._preloadedContent) {\n      pswp.contentLoader.addToCache(this._preloadedContent);\n      this._preloadedContent = undefined;\n    }\n\n    pswp.on('destroy', () => {\n      // clean up public variables\n      this.pswp = undefined;\n      delete window.pswp;\n    });\n    pswp.init();\n  }\n  /**\r\n   * Unbinds all events, closes PhotoSwipe if it's open.\r\n   */\n\n\n  destroy() {\n    var _this$pswp;\n\n    (_this$pswp = this.pswp) === null || _this$pswp === void 0 || _this$pswp.destroy();\n    this.shouldOpen = false;\n    this._listeners = {};\n    getElementsFromOption(this.options.gallery, this.options.gallerySelector).forEach(galleryElement => {\n      galleryElement.removeEventListener('click', this.onThumbnailsClick, false);\n    });\n  }\n\n}\n\nexport { PhotoSwipeLightbox as default };\n//# sourceMappingURL=photoswipe-lightbox.esm.js.map\n","\"use strict\";\n/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.bytes = exports.stringToBytes = exports.str = exports.bytesToString = exports.hex = exports.utf8 = exports.bech32m = exports.bech32 = exports.base58check = exports.base58xmr = exports.base58xrp = exports.base58flickr = exports.base58 = exports.base64url = exports.base64 = exports.base32crockford = exports.base32hex = exports.base32 = exports.base16 = exports.utils = exports.assertNumber = void 0;\nfunction assertNumber(n) {\n    if (!Number.isSafeInteger(n))\n        throw new Error(`Wrong integer: ${n}`);\n}\nexports.assertNumber = assertNumber;\nfunction chain(...args) {\n    const wrap = (a, b) => (c) => a(b(c));\n    const encode = Array.from(args)\n        .reverse()\n        .reduce((acc, i) => (acc ? wrap(acc, i.encode) : i.encode), undefined);\n    const decode = args.reduce((acc, i) => (acc ? wrap(acc, i.decode) : i.decode), undefined);\n    return { encode, decode };\n}\nfunction alphabet(alphabet) {\n    return {\n        encode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('alphabet.encode input should be an array of numbers');\n            return digits.map((i) => {\n                assertNumber(i);\n                if (i < 0 || i >= alphabet.length)\n                    throw new Error(`Digit index outside alphabet: ${i} (alphabet: ${alphabet.length})`);\n                return alphabet[i];\n            });\n        },\n        decode: (input) => {\n            if (!Array.isArray(input) || (input.length && typeof input[0] !== 'string'))\n                throw new Error('alphabet.decode input should be array of strings');\n            return input.map((letter) => {\n                if (typeof letter !== 'string')\n                    throw new Error(`alphabet.decode: not string element=${letter}`);\n                const index = alphabet.indexOf(letter);\n                if (index === -1)\n                    throw new Error(`Unknown letter: \"${letter}\". Allowed: ${alphabet}`);\n                return index;\n            });\n        },\n    };\n}\nfunction join(separator = '') {\n    if (typeof separator !== 'string')\n        throw new Error('join separator should be string');\n    return {\n        encode: (from) => {\n            if (!Array.isArray(from) || (from.length && typeof from[0] !== 'string'))\n                throw new Error('join.encode input should be array of strings');\n            for (let i of from)\n                if (typeof i !== 'string')\n                    throw new Error(`join.encode: non-string input=${i}`);\n            return from.join(separator);\n        },\n        decode: (to) => {\n            if (typeof to !== 'string')\n                throw new Error('join.decode input should be string');\n            return to.split(separator);\n        },\n    };\n}\nfunction padding(bits, chr = '=') {\n    assertNumber(bits);\n    if (typeof chr !== 'string')\n        throw new Error('padding chr should be string');\n    return {\n        encode(data) {\n            if (!Array.isArray(data) || (data.length && typeof data[0] !== 'string'))\n                throw new Error('padding.encode input should be array of strings');\n            for (let i of data)\n                if (typeof i !== 'string')\n                    throw new Error(`padding.encode: non-string input=${i}`);\n            while ((data.length * bits) % 8)\n                data.push(chr);\n            return data;\n        },\n        decode(input) {\n            if (!Array.isArray(input) || (input.length && typeof input[0] !== 'string'))\n                throw new Error('padding.encode input should be array of strings');\n            for (let i of input)\n                if (typeof i !== 'string')\n                    throw new Error(`padding.decode: non-string input=${i}`);\n            let end = input.length;\n            if ((end * bits) % 8)\n                throw new Error('Invalid padding: string should have whole number of bytes');\n            for (; end > 0 && input[end - 1] === chr; end--) {\n                if (!(((end - 1) * bits) % 8))\n                    throw new Error('Invalid padding: string has too much padding');\n            }\n            return input.slice(0, end);\n        },\n    };\n}\nfunction normalize(fn) {\n    if (typeof fn !== 'function')\n        throw new Error('normalize fn should be function');\n    return { encode: (from) => from, decode: (to) => fn(to) };\n}\nfunction convertRadix(data, from, to) {\n    if (from < 2)\n        throw new Error(`convertRadix: wrong from=${from}, base cannot be less than 2`);\n    if (to < 2)\n        throw new Error(`convertRadix: wrong to=${to}, base cannot be less than 2`);\n    if (!Array.isArray(data))\n        throw new Error('convertRadix: data should be array');\n    if (!data.length)\n        return [];\n    let pos = 0;\n    const res = [];\n    const digits = Array.from(data);\n    digits.forEach((d) => {\n        assertNumber(d);\n        if (d < 0 || d >= from)\n            throw new Error(`Wrong integer: ${d}`);\n    });\n    while (true) {\n        let carry = 0;\n        let done = true;\n        for (let i = pos; i < digits.length; i++) {\n            const digit = digits[i];\n            const digitBase = from * carry + digit;\n            if (!Number.isSafeInteger(digitBase) ||\n                (from * carry) / from !== carry ||\n                digitBase - digit !== from * carry) {\n                throw new Error('convertRadix: carry overflow');\n            }\n            carry = digitBase % to;\n            digits[i] = Math.floor(digitBase / to);\n            if (!Number.isSafeInteger(digits[i]) || digits[i] * to + carry !== digitBase)\n                throw new Error('convertRadix: carry overflow');\n            if (!done)\n                continue;\n            else if (!digits[i])\n                pos = i;\n            else\n                done = false;\n        }\n        res.push(carry);\n        if (done)\n            break;\n    }\n    for (let i = 0; i < data.length - 1 && data[i] === 0; i++)\n        res.push(0);\n    return res.reverse();\n}\nconst gcd = (a, b) => (!b ? a : gcd(b, a % b));\nconst radix2carry = (from, to) => from + (to - gcd(from, to));\nfunction convertRadix2(data, from, to, padding) {\n    if (!Array.isArray(data))\n        throw new Error('convertRadix2: data should be array');\n    if (from <= 0 || from > 32)\n        throw new Error(`convertRadix2: wrong from=${from}`);\n    if (to <= 0 || to > 32)\n        throw new Error(`convertRadix2: wrong to=${to}`);\n    if (radix2carry(from, to) > 32) {\n        throw new Error(`convertRadix2: carry overflow from=${from} to=${to} carryBits=${radix2carry(from, to)}`);\n    }\n    let carry = 0;\n    let pos = 0;\n    const mask = 2 ** to - 1;\n    const res = [];\n    for (const n of data) {\n        assertNumber(n);\n        if (n >= 2 ** from)\n            throw new Error(`convertRadix2: invalid data word=${n} from=${from}`);\n        carry = (carry << from) | n;\n        if (pos + from > 32)\n            throw new Error(`convertRadix2: carry overflow pos=${pos} from=${from}`);\n        pos += from;\n        for (; pos >= to; pos -= to)\n            res.push(((carry >> (pos - to)) & mask) >>> 0);\n        carry &= 2 ** pos - 1;\n    }\n    carry = (carry << (to - pos)) & mask;\n    if (!padding && pos >= from)\n        throw new Error('Excess padding');\n    if (!padding && carry)\n        throw new Error(`Non-zero padding: ${carry}`);\n    if (padding && pos > 0)\n        res.push(carry >>> 0);\n    return res;\n}\nfunction radix(num) {\n    assertNumber(num);\n    return {\n        encode: (bytes) => {\n            if (!(bytes instanceof Uint8Array))\n                throw new Error('radix.encode input should be Uint8Array');\n            return convertRadix(Array.from(bytes), 2 ** 8, num);\n        },\n        decode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('radix.decode input should be array of strings');\n            return Uint8Array.from(convertRadix(digits, num, 2 ** 8));\n        },\n    };\n}\nfunction radix2(bits, revPadding = false) {\n    assertNumber(bits);\n    if (bits <= 0 || bits > 32)\n        throw new Error('radix2: bits should be in (0..32]');\n    if (radix2carry(8, bits) > 32 || radix2carry(bits, 8) > 32)\n        throw new Error('radix2: carry overflow');\n    return {\n        encode: (bytes) => {\n            if (!(bytes instanceof Uint8Array))\n                throw new Error('radix2.encode input should be Uint8Array');\n            return convertRadix2(Array.from(bytes), 8, bits, !revPadding);\n        },\n        decode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('radix2.decode input should be array of strings');\n            return Uint8Array.from(convertRadix2(digits, bits, 8, revPadding));\n        },\n    };\n}\nfunction unsafeWrapper(fn) {\n    if (typeof fn !== 'function')\n        throw new Error('unsafeWrapper fn should be function');\n    return function (...args) {\n        try {\n            return fn.apply(null, args);\n        }\n        catch (e) { }\n    };\n}\nfunction checksum(len, fn) {\n    assertNumber(len);\n    if (typeof fn !== 'function')\n        throw new Error('checksum fn should be function');\n    return {\n        encode(data) {\n            if (!(data instanceof Uint8Array))\n                throw new Error('checksum.encode: input should be Uint8Array');\n            const checksum = fn(data).slice(0, len);\n            const res = new Uint8Array(data.length + len);\n            res.set(data);\n            res.set(checksum, data.length);\n            return res;\n        },\n        decode(data) {\n            if (!(data instanceof Uint8Array))\n                throw new Error('checksum.decode: input should be Uint8Array');\n            const payload = data.slice(0, -len);\n            const newChecksum = fn(payload).slice(0, len);\n            const oldChecksum = data.slice(-len);\n            for (let i = 0; i < len; i++)\n                if (newChecksum[i] !== oldChecksum[i])\n                    throw new Error('Invalid checksum');\n            return payload;\n        },\n    };\n}\nexports.utils = { alphabet, chain, checksum, radix, radix2, join, padding };\nexports.base16 = chain(radix2(4), alphabet('0123456789ABCDEF'), join(''));\nexports.base32 = chain(radix2(5), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZ234567'), padding(5), join(''));\nexports.base32hex = chain(radix2(5), alphabet('0123456789ABCDEFGHIJKLMNOPQRSTUV'), padding(5), join(''));\nexports.base32crockford = chain(radix2(5), alphabet('0123456789ABCDEFGHJKMNPQRSTVWXYZ'), join(''), normalize((s) => s.toUpperCase().replace(/O/g, '0').replace(/[IL]/g, '1')));\nexports.base64 = chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'), padding(6), join(''));\nexports.base64url = chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'), padding(6), join(''));\nconst genBase58 = (abc) => chain(radix(58), alphabet(abc), join(''));\nexports.base58 = genBase58('123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz');\nexports.base58flickr = genBase58('123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ');\nexports.base58xrp = genBase58('rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz');\nconst XMR_BLOCK_LEN = [0, 2, 3, 5, 6, 7, 9, 10, 11];\nexports.base58xmr = {\n    encode(data) {\n        let res = '';\n        for (let i = 0; i < data.length; i += 8) {\n            const block = data.subarray(i, i + 8);\n            res += exports.base58.encode(block).padStart(XMR_BLOCK_LEN[block.length], '1');\n        }\n        return res;\n    },\n    decode(str) {\n        let res = [];\n        for (let i = 0; i < str.length; i += 11) {\n            const slice = str.slice(i, i + 11);\n            const blockLen = XMR_BLOCK_LEN.indexOf(slice.length);\n            const block = exports.base58.decode(slice);\n            for (let j = 0; j < block.length - blockLen; j++) {\n                if (block[j] !== 0)\n                    throw new Error('base58xmr: wrong padding');\n            }\n            res = res.concat(Array.from(block.slice(block.length - blockLen)));\n        }\n        return Uint8Array.from(res);\n    },\n};\nconst base58check = (sha256) => chain(checksum(4, (data) => sha256(sha256(data))), exports.base58);\nexports.base58check = base58check;\nconst BECH_ALPHABET = chain(alphabet('qpzry9x8gf2tvdw0s3jn54khce6mua7l'), join(''));\nconst POLYMOD_GENERATORS = [0x3b6a57b2, 0x26508e6d, 0x1ea119fa, 0x3d4233dd, 0x2a1462b3];\nfunction bech32Polymod(pre) {\n    const b = pre >> 25;\n    let chk = (pre & 0x1ffffff) << 5;\n    for (let i = 0; i < POLYMOD_GENERATORS.length; i++) {\n        if (((b >> i) & 1) === 1)\n            chk ^= POLYMOD_GENERATORS[i];\n    }\n    return chk;\n}\nfunction bechChecksum(prefix, words, encodingConst = 1) {\n    const len = prefix.length;\n    let chk = 1;\n    for (let i = 0; i < len; i++) {\n        const c = prefix.charCodeAt(i);\n        if (c < 33 || c > 126)\n            throw new Error(`Invalid prefix (${prefix})`);\n        chk = bech32Polymod(chk) ^ (c >> 5);\n    }\n    chk = bech32Polymod(chk);\n    for (let i = 0; i < len; i++)\n        chk = bech32Polymod(chk) ^ (prefix.charCodeAt(i) & 0x1f);\n    for (let v of words)\n        chk = bech32Polymod(chk) ^ v;\n    for (let i = 0; i < 6; i++)\n        chk = bech32Polymod(chk);\n    chk ^= encodingConst;\n    return BECH_ALPHABET.encode(convertRadix2([chk % 2 ** 30], 30, 5, false));\n}\nfunction genBech32(encoding) {\n    const ENCODING_CONST = encoding === 'bech32' ? 1 : 0x2bc830a3;\n    const _words = radix2(5);\n    const fromWords = _words.decode;\n    const toWords = _words.encode;\n    const fromWordsUnsafe = unsafeWrapper(fromWords);\n    function encode(prefix, words, limit = 90) {\n        if (typeof prefix !== 'string')\n            throw new Error(`bech32.encode prefix should be string, not ${typeof prefix}`);\n        if (!Array.isArray(words) || (words.length && typeof words[0] !== 'number'))\n            throw new Error(`bech32.encode words should be array of numbers, not ${typeof words}`);\n        const actualLength = prefix.length + 7 + words.length;\n        if (limit !== false && actualLength > limit)\n            throw new TypeError(`Length ${actualLength} exceeds limit ${limit}`);\n        prefix = prefix.toLowerCase();\n        return `${prefix}1${BECH_ALPHABET.encode(words)}${bechChecksum(prefix, words, ENCODING_CONST)}`;\n    }\n    function decode(str, limit = 90) {\n        if (typeof str !== 'string')\n            throw new Error(`bech32.decode input should be string, not ${typeof str}`);\n        if (str.length < 8 || (limit !== false && str.length > limit))\n            throw new TypeError(`Wrong string length: ${str.length} (${str}). Expected (8..${limit})`);\n        const lowered = str.toLowerCase();\n        if (str !== lowered && str !== str.toUpperCase())\n            throw new Error(`String must be lowercase or uppercase`);\n        str = lowered;\n        const sepIndex = str.lastIndexOf('1');\n        if (sepIndex === 0 || sepIndex === -1)\n            throw new Error(`Letter \"1\" must be present between prefix and data only`);\n        const prefix = str.slice(0, sepIndex);\n        const _words = str.slice(sepIndex + 1);\n        if (_words.length < 6)\n            throw new Error('Data must be at least 6 characters long');\n        const words = BECH_ALPHABET.decode(_words).slice(0, -6);\n        const sum = bechChecksum(prefix, words, ENCODING_CONST);\n        if (!_words.endsWith(sum))\n            throw new Error(`Invalid checksum in ${str}: expected \"${sum}\"`);\n        return { prefix, words };\n    }\n    const decodeUnsafe = unsafeWrapper(decode);\n    function decodeToBytes(str) {\n        const { prefix, words } = decode(str, false);\n        return { prefix, words, bytes: fromWords(words) };\n    }\n    return { encode, decode, decodeToBytes, decodeUnsafe, fromWords, fromWordsUnsafe, toWords };\n}\nexports.bech32 = genBech32('bech32');\nexports.bech32m = genBech32('bech32m');\nexports.utf8 = {\n    encode: (data) => new TextDecoder().decode(data),\n    decode: (str) => new TextEncoder().encode(str),\n};\nexports.hex = chain(radix2(4), alphabet('0123456789abcdef'), join(''), normalize((s) => {\n    if (typeof s !== 'string' || s.length % 2)\n        throw new TypeError(`hex.decode: expected string, got ${typeof s} with length ${s.length}`);\n    return s.toLowerCase();\n}));\nconst CODERS = {\n    utf8: exports.utf8, hex: exports.hex, base16: exports.base16, base32: exports.base32, base64: exports.base64, base64url: exports.base64url, base58: exports.base58, base58xmr: exports.base58xmr\n};\nconst coderTypeError = `Invalid encoding type. Available types: ${Object.keys(CODERS).join(', ')}`;\nconst bytesToString = (type, bytes) => {\n    if (typeof type !== 'string' || !CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (!(bytes instanceof Uint8Array))\n        throw new TypeError('bytesToString() expects Uint8Array');\n    return CODERS[type].encode(bytes);\n};\nexports.bytesToString = bytesToString;\nexports.str = exports.bytesToString;\nconst stringToBytes = (type, str) => {\n    if (!CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (typeof str !== 'string')\n        throw new TypeError('stringToBytes() expects string');\n    return CODERS[type].decode(str);\n};\nexports.stringToBytes = stringToBytes;\nexports.bytes = exports.stringToBytes;\n","const {bech32, hex, utf8} = require('@scure/base')\n\n// defaults for encode; default timestamp is current time at call\nconst DEFAULTNETWORK = {\n  // default network is bitcoin\n  bech32: 'bc',\n  pubKeyHash: 0x00,\n  scriptHash: 0x05,\n  validWitnessVersions: [0]\n}\nconst TESTNETWORK = {\n  bech32: 'tb',\n  pubKeyHash: 0x6f,\n  scriptHash: 0xc4,\n  validWitnessVersions: [0]\n}\nconst SIGNETNETWORK = {\n  bech32: 'tbs',\n  pubKeyHash: 0x6f,\n  scriptHash: 0xc4,\n  validWitnessVersions: [0]\n}\nconst REGTESTNETWORK = {\n  bech32: 'bcrt',\n  pubKeyHash: 0x6f,\n  scriptHash: 0xc4,\n  validWitnessVersions: [0]\n}\nconst SIMNETWORK = {\n  bech32: 'sb',\n  pubKeyHash: 0x3f,\n  scriptHash: 0x7b,\n  validWitnessVersions: [0]\n}\n\nconst FEATUREBIT_ORDER = [\n  'option_data_loss_protect',\n  'initial_routing_sync',\n  'option_upfront_shutdown_script',\n  'gossip_queries',\n  'var_onion_optin',\n  'gossip_queries_ex',\n  'option_static_remotekey',\n  'payment_secret',\n  'basic_mpp',\n  'option_support_large_channel'\n]\n\nconst DIVISORS = {\n  m: BigInt(1e3),\n  u: BigInt(1e6),\n  n: BigInt(1e9),\n  p: BigInt(1e12)\n}\n\nconst MAX_MILLISATS = BigInt('2100000000000000000')\n\nconst MILLISATS_PER_BTC = BigInt(1e11)\n\nconst TAGCODES = {\n  payment_hash: 1,\n  payment_secret: 16,\n  description: 13,\n  payee: 19,\n  description_hash: 23, // commit to longer descriptions (used by lnurl-pay)\n  expiry: 6, // default: 3600 (1 hour)\n  min_final_cltv_expiry: 24, // default: 9\n  fallback_address: 9,\n  route_hint: 3, // for extra routing info (private etc.)\n  feature_bits: 5,\n  metadata: 27\n}\n\n// reverse the keys and values of TAGCODES and insert into TAGNAMES\nconst TAGNAMES = {}\nfor (let i = 0, keys = Object.keys(TAGCODES); i < keys.length; i++) {\n  const currentName = keys[i]\n  const currentCode = TAGCODES[keys[i]].toString()\n  TAGNAMES[currentCode] = currentName\n}\n\nconst TAGPARSERS = {\n  1: words => hex.encode(bech32.fromWordsUnsafe(words)), // 256 bits\n  16: words => hex.encode(bech32.fromWordsUnsafe(words)), // 256 bits\n  13: words => utf8.encode(bech32.fromWordsUnsafe(words)), // string variable length\n  19: words => hex.encode(bech32.fromWordsUnsafe(words)), // 264 bits\n  23: words => hex.encode(bech32.fromWordsUnsafe(words)), // 256 bits\n  27: words => hex.encode(bech32.fromWordsUnsafe(words)), // variable\n  6: wordsToIntBE, // default: 3600 (1 hour)\n  24: wordsToIntBE, // default: 9\n  3: routingInfoParser, // for extra routing info (private etc.)\n  5: featureBitsParser // keep feature bits as array of 5 bit words\n}\n\nfunction getUnknownParser(tagCode) {\n  return words => ({\n    tagCode: parseInt(tagCode),\n    words: bech32.encode('unknown', words, Number.MAX_SAFE_INTEGER)\n  })\n}\n\nfunction wordsToIntBE(words) {\n  return words.reverse().reduce((total, item, index) => {\n    return total + item * Math.pow(32, index)\n  }, 0)\n}\n\n// first convert from words to buffer, trimming padding where necessary\n// parse in 51 byte chunks. See encoder for details.\nfunction routingInfoParser(words) {\n  const routes = []\n  let pubkey,\n    shortChannelId,\n    feeBaseMSats,\n    feeProportionalMillionths,\n    cltvExpiryDelta\n  let routesBuffer = bech32.fromWordsUnsafe(words)\n  while (routesBuffer.length > 0) {\n    pubkey = hex.encode(routesBuffer.slice(0, 33)) // 33 bytes\n    shortChannelId = hex.encode(routesBuffer.slice(33, 41)) // 8 bytes\n    feeBaseMSats = parseInt(hex.encode(routesBuffer.slice(41, 45)), 16) // 4 bytes\n    feeProportionalMillionths = parseInt(\n      hex.encode(routesBuffer.slice(45, 49)),\n      16\n    ) // 4 bytes\n    cltvExpiryDelta = parseInt(hex.encode(routesBuffer.slice(49, 51)), 16) // 2 bytes\n\n    routesBuffer = routesBuffer.slice(51)\n\n    routes.push({\n      pubkey,\n      short_channel_id: shortChannelId,\n      fee_base_msat: feeBaseMSats,\n      fee_proportional_millionths: feeProportionalMillionths,\n      cltv_expiry_delta: cltvExpiryDelta\n    })\n  }\n  return routes\n}\n\nfunction featureBitsParser(words) {\n  const bools = words\n    .slice()\n    .reverse()\n    .map(word => [\n      !!(word & 0b1),\n      !!(word & 0b10),\n      !!(word & 0b100),\n      !!(word & 0b1000),\n      !!(word & 0b10000)\n    ])\n    .reduce((finalArr, itemArr) => finalArr.concat(itemArr), [])\n  while (bools.length < FEATUREBIT_ORDER.length * 2) {\n    bools.push(false)\n  }\n\n  const featureBits = {}\n\n  FEATUREBIT_ORDER.forEach((featureName, index) => {\n    let status\n    if (bools[index * 2]) {\n      status = 'required'\n    } else if (bools[index * 2 + 1]) {\n      status = 'supported'\n    } else {\n      status = 'unsupported'\n    }\n    featureBits[featureName] = status\n  })\n\n  const extraBits = bools.slice(FEATUREBIT_ORDER.length * 2)\n  featureBits.extra_bits = {\n    start_bit: FEATUREBIT_ORDER.length * 2,\n    bits: extraBits,\n    has_required: extraBits.reduce(\n      (result, bit, index) =>\n        index % 2 !== 0 ? result || false : result || bit,\n      false\n    )\n  }\n\n  return featureBits\n}\n\nfunction hrpToMillisat(hrpString, outputString) {\n  let divisor, value\n  if (hrpString.slice(-1).match(/^[munp]$/)) {\n    divisor = hrpString.slice(-1)\n    value = hrpString.slice(0, -1)\n  } else if (hrpString.slice(-1).match(/^[^munp0-9]$/)) {\n    throw new Error('Not a valid multiplier for the amount')\n  } else {\n    value = hrpString\n  }\n\n  if (!value.match(/^\\d+$/))\n    throw new Error('Not a valid human readable amount')\n\n  const valueBN = BigInt(value)\n\n  const millisatoshisBN = divisor\n    ? (valueBN * MILLISATS_PER_BTC) / DIVISORS[divisor]\n    : valueBN * MILLISATS_PER_BTC\n\n  if (\n    (divisor === 'p' && !(valueBN % BigInt(10) === BigInt(0))) ||\n    millisatoshisBN > MAX_MILLISATS\n  ) {\n    throw new Error('Amount is outside of valid range')\n  }\n\n  return outputString ? millisatoshisBN.toString() : millisatoshisBN\n}\n\n// decode will only have extra comments that aren't covered in encode comments.\n// also if anything is hard to read I'll comment.\nfunction decode(paymentRequest, network) {\n  if (typeof paymentRequest !== 'string')\n    throw new Error('Lightning Payment Request must be string')\n  if (paymentRequest.slice(0, 2).toLowerCase() !== 'ln')\n    throw new Error('Not a proper lightning payment request')\n\n  const sections = []\n  const decoded = bech32.decode(paymentRequest, Number.MAX_SAFE_INTEGER)\n  paymentRequest = paymentRequest.toLowerCase()\n  const prefix = decoded.prefix\n  let words = decoded.words\n  let letters = paymentRequest.slice(prefix.length + 1)\n  let sigWords = words.slice(-104)\n  words = words.slice(0, -104)\n\n  // Without reverse lookups, can't say that the multipier at the end must\n  // have a number before it, so instead we parse, and if the second group\n  // doesn't have anything, there's a good chance the last letter of the\n  // coin type got captured by the third group, so just re-regex without\n  // the number.\n  let prefixMatches = prefix.match(/^ln(\\S+?)(\\d*)([a-zA-Z]?)$/)\n  if (prefixMatches && !prefixMatches[2])\n    prefixMatches = prefix.match(/^ln(\\S+)$/)\n  if (!prefixMatches) {\n    throw new Error('Not a proper lightning payment request')\n  }\n\n  // \"ln\" section\n  sections.push({\n    name: 'lightning_network',\n    letters: 'ln'\n  })\n\n  // \"bc\" section\n  const bech32Prefix = prefixMatches[1]\n  let coinNetwork\n  if (!network) {\n    switch (bech32Prefix) {\n      case DEFAULTNETWORK.bech32:\n        coinNetwork = DEFAULTNETWORK\n        break\n      case TESTNETWORK.bech32:\n        coinNetwork = TESTNETWORK\n        break\n      case SIGNETNETWORK.bech32:\n        coinNetwork = SIGNETNETWORK\n        break\n      case REGTESTNETWORK.bech32:\n        coinNetwork = REGTESTNETWORK\n        break\n      case SIMNETWORK.bech32:\n        coinNetwork = SIMNETWORK\n        break\n    }\n  } else {\n    if (\n      network.bech32 === undefined ||\n      network.pubKeyHash === undefined ||\n      network.scriptHash === undefined ||\n      !Array.isArray(network.validWitnessVersions)\n    )\n      throw new Error('Invalid network')\n    coinNetwork = network\n  }\n  if (!coinNetwork || coinNetwork.bech32 !== bech32Prefix) {\n    throw new Error('Unknown coin bech32 prefix')\n  }\n  sections.push({\n    name: 'coin_network',\n    letters: bech32Prefix,\n    value: coinNetwork\n  })\n\n  // amount section\n  const value = prefixMatches[2]\n  let millisatoshis\n  if (value) {\n    const divisor = prefixMatches[3]\n    millisatoshis = hrpToMillisat(value + divisor, true)\n    sections.push({\n      name: 'amount',\n      letters: prefixMatches[2] + prefixMatches[3],\n      value: millisatoshis\n    })\n  } else {\n    millisatoshis = null\n  }\n\n  // \"1\" separator\n  sections.push({\n    name: 'separator',\n    letters: '1'\n  })\n\n  // timestamp\n  const timestamp = wordsToIntBE(words.slice(0, 7))\n  words = words.slice(7) // trim off the left 7 words\n  sections.push({\n    name: 'timestamp',\n    letters: letters.slice(0, 7),\n    value: timestamp\n  })\n  letters = letters.slice(7)\n\n  let tagName, parser, tagLength, tagWords\n  // we have no tag count to go on, so just keep hacking off words\n  // until we have none.\n  while (words.length > 0) {\n    const tagCode = words[0].toString()\n    tagName = TAGNAMES[tagCode] || 'unknown_tag'\n    parser = TAGPARSERS[tagCode] || getUnknownParser(tagCode)\n    words = words.slice(1)\n\n    tagLength = wordsToIntBE(words.slice(0, 2))\n    words = words.slice(2)\n\n    tagWords = words.slice(0, tagLength)\n    words = words.slice(tagLength)\n\n    sections.push({\n      name: tagName,\n      tag: letters[0],\n      letters: letters.slice(0, 1 + 2 + tagLength),\n      value: parser(tagWords) // see: parsers for more comments\n    })\n    letters = letters.slice(1 + 2 + tagLength)\n  }\n\n  // signature\n  sections.push({\n    name: 'signature',\n    letters: letters.slice(0, 104),\n    value: hex.encode(bech32.fromWordsUnsafe(sigWords))\n  })\n  letters = letters.slice(104)\n\n  // checksum\n  sections.push({\n    name: 'checksum',\n    letters: letters\n  })\n\n  let result = {\n    paymentRequest,\n    sections,\n\n    get expiry() {\n      let exp = sections.find(s => s.name === 'expiry')\n      if (exp) return getValue('timestamp') + exp.value\n    },\n\n    get route_hints() {\n      return sections.filter(s => s.name === 'route_hint').map(s => s.value)\n    }\n  }\n\n  for (let name in TAGCODES) {\n    if (name === 'route_hint') {\n      // route hints can be multiple, so this won't work for them\n      continue\n    }\n\n    Object.defineProperty(result, name, {\n      get() {\n        return getValue(name)\n      }\n    })\n  }\n\n  return result\n\n  function getValue(name) {\n    let section = sections.find(s => s.name === name)\n    return section ? section.value : undefined\n  }\n}\n\nmodule.exports = {\n  decode,\n  hrpToMillisat\n}\n","import { NostrEventType, NostrEventContent, NostrEvent, NostrEOSE } from \"../types/primal\";\n\nexport const subTo = (socket: WebSocket, subId: string, cb: (type: NostrEventType, subId: string, content?: NostrEventContent) => void ) => {\n  const listener = (event: MessageEvent) => {\n    const message: NostrEvent | NostrEOSE = JSON.parse(event.data);\n    const [type, subscriptionId, content] = message;\n\n    if (subId === subscriptionId) {\n      cb(type, subscriptionId, content);\n    }\n\n  };\n\n  socket.addEventListener('message', listener);\n\n  return () => {\n    socket.removeEventListener('message', listener);\n  };\n};\n\nexport const sendMessage = (socket: WebSocket, message: string) => {\n  socket.readyState === WebSocket.OPEN && socket.send(message);\n}\n","import { Component, createEffect, createSignal, onMount, Show } from 'solid-js';\nimport { hookForDev } from '../../lib/devTools';\n// @ts-ignore\nimport { decode } from 'light-bolt11-decoder';\n\nimport styles from './Lnbc.module.scss';\nimport { createStore, reconcile } from 'solid-js/store';\nimport { humanizeNumber } from '../../lib/stats';\nimport { date, dateFuture } from '../../lib/dates';\nimport ButtonPrimary from '../Buttons/ButtonPrimary';\nimport ButtonGhost from '../Buttons/ButtonGhost';\nimport { LnbcInvoice } from '../../types/primal';\nimport { emptyInvoice, Kind } from '../../constants';\nimport { useAppContext } from '../../contexts/AppContext';\nimport { sendMessage, subTo } from '../../lib/sockets';\nimport { APP_ID } from '../../App';\nimport { signEvent } from '../../lib/nostrAPI';\nimport Loader from '../Loader/Loader';\nimport { logError, logInfo, logWarning } from '../../lib/logger';\nimport { useToastContext } from '../Toaster/Toaster';\nimport { useIntl } from '@cookbook/solid-intl';\nimport { lnInvoice } from '../../translations';\n\n\nconst Lnbc: Component< {\n  id?: string,\n  lnbc: string,\n  alternative?: boolean,\n  noBack?: boolean,\n  inactive?: boolean,\n} > = (props) => {\n\n  const app = useAppContext();\n  const toast = useToastContext();\n  const intl = useIntl();\n\n  const [invoice, setInvoice] = createStore<LnbcInvoice>({ ...emptyInvoice });\n\n  const [invoiceCopied, setInvoiceCopied] = createSignal(false);\n\n  const [paymentInProgress, setPaymentInProgress] = createSignal(false);\n\n  createEffect(() => {\n    try {\n      const dec: LnbcInvoice = decode(props.lnbc);\n      setInvoice(reconcile({...emptyInvoice}))\n      setInvoice(() => ({ ...dec }));\n    } catch (e) {\n      logError('Failed to decode lightining unvoice: ', e);\n    }\n  });\n\n  createEffect(() => {\n    if (invoiceCopied()) {\n      setTimeout(() => {\n        setInvoiceCopied(() => false);\n      }, 1_000);\n    }\n  })\n\n  const isLightning = () => invoice.sections.find(s => s.name === 'lightning_network');\n\n  const expiryDate = () => {\n    const expiry = invoice.sections.find(s => s.name === 'expiry')?.value as number;\n    const created = invoice.sections.find(s => s.name === 'timestamp')?.value as number;\n\n    return expiry + created;\n  }\n\n  const hasExpired = () => {\n    const today = Math.floor((new Date()).getTime() / 1_000);\n\n    return today > expiryDate();\n  }\n\n  const amount = () =>\n    `${humanizeNumber(parseInt(invoice.sections.find(s => s.name === 'amount')?.value || '0') / 1_000)} sats`;\n\n  const description = () =>\n    decodeURI(invoice.sections.find(s => s.name === 'description')?.value) || '';\n\n  const confirmPayment = () => app?.actions.openConfirmModal({\n    title: intl.formatMessage(lnInvoice.confirm.title),\n    description: intl.formatMessage(lnInvoice.confirm.description, { amount: amount() }),\n    confirmLabel: intl.formatMessage(lnInvoice.confirm.confirmLabel),\n    abortLabel: intl.formatMessage(lnInvoice.confirm.abortLabel),\n    onAbort: app.actions.closeConfirmModal,\n    onConfirm: () => {\n      app.actions.closeConfirmModal();\n      payInvoice();\n    },\n  });\n\n  const payInvoice = () => {\n    if (props.inactive) return;\n\n    setPaymentInProgress(() => true);\n    const walletSocket = new WebSocket('wss://wallet.primal.net/v1');\n\n    walletSocket.addEventListener('close', () => {\n      logInfo('PREMIUM SOCKET CLOSED');\n    });\n\n    walletSocket.addEventListener('open', () => {\n      logInfo('WALLET SOCKET OPENED');\n      sendPayment(walletSocket, (success: boolean) => {\n        if (!success) {\n          toast?.sendWarning(`Failed to pay ${amount()}`);\n        }\n        walletSocket.close();\n        setPaymentInProgress(() => false);\n      });\n    });\n  };\n\n  const sendPayment = async (socket: WebSocket, then?: (success: boolean) => void) => {\n    if (props.inactive) return;\n\n    const subId = `sp_${APP_ID}`;\n\n    let success = true;\n\n    const unsub = subTo(socket, subId, (type, _, content) => {\n      if (type === 'EOSE') {\n        unsub();\n        then && then(success);\n      }\n\n      if (type === 'NOTICE') {\n        success = false;\n      }\n    });\n\n    const content = JSON.stringify(\n      [\"withdraw\", {\n        subwallet: 1,\n        lnInvoice: invoice.paymentRequest,\n        target_lud16: '',\n        note_for_recipient: invoice.sections.find(s => s.name === 'description')?.value || '',\n        note_for_self: '',\n      }],\n    );\n\n    const event = {\n      content,\n      kind: Kind.WALLET_OPERATION,\n      created_at: Math.ceil((new Date()).getTime() / 1000),\n      tags: [],\n    };\n\n    try {\n      const signedEvent = await signEvent(event);\n\n      sendMessage(socket, JSON.stringify([\n        \"REQ\",\n        subId,\n        {cache: [\"wallet\", { operation_event: signedEvent }]},\n      ]));\n    } catch (reason) {\n      logError('failed to sign due to: ', reason);\n    }\n  };\n\n  const klass = () => {\n    let k = props.alternative ? styles.lnbcAlter : styles.lnbc;\n    if (props.noBack) {\n      k += ` ${styles.noBack}`\n    }\n\n    return k;\n  }\n\n  return (\n    <div id={props.id} class={klass()}>\n      <Show when={paymentInProgress()}>\n        <div class={styles.paymentOverlay}>\n          <Loader />\n        </div>\n      </Show>\n      <div class={styles.header}>\n        <Show when={isLightning()}>\n          <div class={styles.title}>\n            <div class={styles.lnIcon}></div>\n            <div>{intl.formatMessage(lnInvoice.title)}</div>\n          </div>\n        </Show>\n        <div class={styles.headerActions}>\n          <Show\n            when={!hasExpired()}\n          >\n            <ButtonGhost\n              onClick={(e: MouseEvent) => {\n                e.preventDefault();\n                if (props.inactive) return;\n\n                app?.actions.openLnbcModal(props.lnbc, () => {\n                  app.actions.closeLnbcModal();\n                  confirmPayment();\n                });\n              }}\n              shrink={true}\n              >\n              <div class={styles.qrIcon}></div>\n            </ButtonGhost>\n          </Show>\n\n          <Show\n            when={!invoiceCopied()}\n            fallback={<div class={styles.copyDone}><div class={styles.checkIcon}></div></div>}\n          >\n            <ButtonGhost\n              onClick={(e: MouseEvent) => {\n                e.preventDefault()\n                if (props.inactive) return;\n\n                navigator.clipboard.writeText(props.lnbc);\n                setInvoiceCopied(() => true);\n              }}\n              shrink={true}\n            >\n              <div class={styles.copyIcon}></div>\n            </ButtonGhost>\n          </Show>\n        </div>\n      </div>\n      <div class={styles.body}>\n        <div class={styles.description}>{description()}</div>\n        <div class={styles.amount}>{amount()}</div>\n      </div>\n\n      <div class={styles.footer}>\n        <Show\n          when={!hasExpired()}\n          fallback={\n            <div class={styles.expiredDate}>\n              {intl.formatMessage(lnInvoice.expired, { date: date(expiryDate(), 'long').label })}\n            </div>\n          }\n        >\n          <div class={styles.expiryDate}>\n            {intl.formatMessage(lnInvoice.expires, { date: dateFuture(expiryDate(), 'long').label })}\n          </div>\n          <div class={styles.payAction}>\n            <ButtonPrimary onClick={(e: MouseEvent) => {\n              e.preventDefault();\n              !props.inactive && confirmPayment();\n            }}>\n              {intl.formatMessage(lnInvoice.pay)}\n            </ButtonPrimary>\n          </div>\n        </Show>\n      </div>\n    </div>\n  );\n}\n\nexport default hookForDev(Lnbc);\n\n// sections = [\n//   {\n//       \"name\": \"lightning_network\",\n//       \"letters\": \"ln\"\n//   },\n//   {\n//       \"name\": \"coin_network\",\n//       \"letters\": \"bc\",\n//       \"value\": {\n//           \"bech32\": \"bc\",\n//           \"pubKeyHash\": 0,\n//           \"scriptHash\": 5,\n//           \"validWitnessVersions\": [\n//               0\n//           ]\n//       }\n//   },\n//   {\n//       \"name\": \"amount\",\n//       \"letters\": \"100u\",\n//       \"value\": \"10000000\"\n//   },\n//   {\n//       \"name\": \"separator\",\n//       \"letters\": \"1\"\n//   },\n//   {\n//       \"name\": \"timestamp\",\n//       \"letters\": \"pjatlyx\",\n//       \"value\": 1708522630\n//   },\n//   {\n//       \"name\": \"payment_secret\",\n//       \"tag\": \"s\",\n//       \"letters\": \"sp5938h8ewswdm7smn9yfge6wvfeletzxrujz2kt6yjxl77at09zlys\",\n//       \"value\": \"2c4f73e5d07377e86e6522519d3989cff2b1187c909565e89237fdeeade517c9\"\n//   },\n//   {\n//       \"name\": \"payment_hash\",\n//       \"tag\": \"p\",\n//       \"letters\": \"pp5edcuua748en26zlyjga47gpcga3htnw06xmqw4zrkwwz37s45cxq\",\n//       \"value\": \"cb71ce77d53e66ad0be4923b5f2038476375cdcfd1b6075443b39c28fa15a60c\"\n//   },\n//   {\n//       \"name\": \"description\",\n//       \"tag\": \"d\",\n//       \"letters\": \"dqgv4h82arn\",\n//       \"value\": \"enuts\"\n//   },\n//   {\n//       \"name\": \"expiry\",\n//       \"tag\": \"x\",\n//       \"letters\": \"xqzjc\",\n//       \"value\": 600\n//   },\n//   {\n//       \"name\": \"min_final_cltv_expiry\",\n//       \"tag\": \"c\",\n//       \"letters\": \"cqpj\",\n//       \"value\": 18\n//   },\n//   {\n//       \"name\": \"route_hint\",\n//       \"tag\": \"r\",\n//       \"letters\": \"rzjqgfffll4jmjf0tffqtx47xt886gzp9fajp3966xz96gm2xj9cqedxrrld5qq0tgqqqqqqqqqqqqqrssqyg\",\n//       \"value\": [\n//           {\n//               \"pubkey\": \"021294fff596e497ad2902cd5f19673e9020953d90625d68c22e91b51a45c032d3\",\n//               \"short_channel_id\": \"0c7f6d0007ad0000\",\n//               \"fee_base_msat\": 0,\n//               \"fee_proportional_millionths\": 450,\n//               \"cltv_expiry_delta\": 34\n//           }\n//       ]\n//   },\n//   {\n//       \"name\": \"feature_bits\",\n//       \"tag\": \"9\",\n//       \"letters\": \"9qxpqysgq\",\n//       \"value\": {\n//           \"option_data_loss_protect\": \"unsupported\",\n//           \"initial_routing_sync\": \"unsupported\",\n//           \"option_upfront_shutdown_script\": \"unsupported\",\n//           \"gossip_queries\": \"unsupported\",\n//           \"var_onion_optin\": \"required\",\n//           \"gossip_queries_ex\": \"unsupported\",\n//           \"option_static_remotekey\": \"unsupported\",\n//           \"payment_secret\": \"required\",\n//           \"basic_mpp\": \"supported\",\n//           \"option_support_large_channel\": \"unsupported\",\n//           \"extra_bits\": {\n//               \"start_bit\": 20,\n//               \"bits\": [\n//                   false,\n//                   false,\n//                   false,\n//                   false,\n//                   false,\n//                   true,\n//                   false,\n//                   false,\n//                   false,\n//                   false\n//               ],\n//               \"has_required\": false\n//           }\n//       }\n//   },\n//   {\n//       \"name\": \"signature\",\n//       \"letters\": \"ml5za767e9scmd52l8mh8zl0g93n74jq0asr98ezvq0gpw8cmsrknehucng4utdjm3cx5mpzkc3psty5yp3ftddkhhrp2hsvy3q08ucq\",\n//       \"value\": \"dfe82efb5ec9618db68af9f7738bef41633f56407f60329f22601e80b8f8dc0769e6fcc4d15e2db2dc706a6c22b622182c94206295b5b6bdc6155e0c2440f3f300\"\n//   },\n//   {\n//       \"name\": \"checksum\",\n//       \"letters\": \"ef6k3v\"\n//   }\n// ],\n","export default \"__VITE_ASSET__1b70a3c1__\"","export default \"__VITE_ASSET__31caf668__\"","import { untrack, createSignal, useTransition, createComputed, batch, createMemo, $TRACK } from 'solid-js';\nimport { isServer } from 'solid-js/web';\n\n// src/index.ts\nvar noop = () => {\n};\nvar noopTransition = (el, done) => done();\nfunction createSwitchTransition(source, options) {\n  const initSource = untrack(source);\n  const initReturned = initSource ? [initSource] : [];\n  if (isServer) {\n    return () => initReturned;\n  }\n  const { onEnter = noopTransition, onExit = noopTransition } = options;\n  const [returned, setReturned] = createSignal(\n    options.appear ? [] : initReturned\n  );\n  const [isTransitionPending] = useTransition();\n  let next;\n  let isExiting = false;\n  function exitTransition(el, after) {\n    if (!el)\n      return after && after();\n    isExiting = true;\n    onExit(el, () => {\n      batch(() => {\n        isExiting = false;\n        setReturned((p) => p.filter((e) => e !== el));\n        after && after();\n      });\n    });\n  }\n  function enterTransition(after) {\n    const el = next;\n    if (!el)\n      return after && after();\n    next = void 0;\n    setReturned((p) => [el, ...p]);\n    onEnter(el, after ?? noop);\n  }\n  const triggerTransitions = options.mode === \"out-in\" ? (\n    // exit -> enter\n    (prev) => isExiting || exitTransition(prev, enterTransition)\n  ) : options.mode === \"in-out\" ? (\n    // enter -> exit\n    (prev) => enterTransition(() => exitTransition(prev))\n  ) : (\n    // exit & enter\n    (prev) => {\n      exitTransition(prev);\n      enterTransition();\n    }\n  );\n  createComputed(\n    (prev) => {\n      const el = source();\n      if (untrack(isTransitionPending)) {\n        isTransitionPending();\n        return prev;\n      }\n      if (el !== prev) {\n        next = el;\n        batch(() => untrack(() => triggerTransitions(prev)));\n      }\n      return el;\n    },\n    options.appear ? void 0 : initSource\n  );\n  return returned;\n}\nfunction createListTransition(source, options) {\n  const initSource = untrack(source);\n  if (isServer) {\n    const copy = initSource.slice();\n    return () => copy;\n  }\n  const { onChange } = options;\n  let prevSet = new Set(options.appear ? void 0 : initSource);\n  const exiting = /* @__PURE__ */ new WeakSet();\n  const [toRemove, setToRemove] = createSignal([], { equals: false });\n  const [isTransitionPending] = useTransition();\n  const finishRemoved = options.exitMethod === \"remove\" ? noop : (els) => {\n    setToRemove((p) => (p.push.apply(p, els), p));\n    for (const el of els)\n      exiting.delete(el);\n  };\n  const handleRemoved = options.exitMethod === \"remove\" ? noop : options.exitMethod === \"keep-index\" ? (els, el, i) => els.splice(i, 0, el) : (els, el) => els.push(el);\n  return createMemo(\n    (prev) => {\n      const elsToRemove = toRemove();\n      const sourceList = source();\n      sourceList[$TRACK];\n      if (untrack(isTransitionPending)) {\n        isTransitionPending();\n        return prev;\n      }\n      if (elsToRemove.length) {\n        const next = prev.filter((e) => !elsToRemove.includes(e));\n        elsToRemove.length = 0;\n        onChange({ list: next, added: [], removed: [], unchanged: next, finishRemoved });\n        return next;\n      }\n      return untrack(() => {\n        const nextSet = new Set(sourceList);\n        const next = sourceList.slice();\n        const added = [];\n        const removed = [];\n        const unchanged = [];\n        for (const el of sourceList) {\n          (prevSet.has(el) ? unchanged : added).push(el);\n        }\n        let nothingChanged = !added.length;\n        for (let i = 0; i < prev.length; i++) {\n          const el = prev[i];\n          if (!nextSet.has(el)) {\n            if (!exiting.has(el)) {\n              removed.push(el);\n              exiting.add(el);\n            }\n            handleRemoved(next, el, i);\n          }\n          if (nothingChanged && el !== next[i])\n            nothingChanged = false;\n        }\n        if (!removed.length && nothingChanged)\n          return prev;\n        onChange({ list: next, added, removed, unchanged, finishRemoved });\n        prevSet = nextSet;\n        return next;\n      });\n    },\n    options.appear ? [] : initSource.slice()\n  );\n}\n\nexport { createListTransition, createSwitchTransition };\n","// src/common.ts\nimport { createMemo } from \"solid-js\";\nfunction createClassnames(props) {\n  return createMemo(() => {\n    const name = props.name || \"s\";\n    return {\n      enterActive: (props.enterActiveClass || name + \"-enter-active\").split(\" \"),\n      enter: (props.enterClass || name + \"-enter\").split(\" \"),\n      enterTo: (props.enterToClass || name + \"-enter-to\").split(\" \"),\n      exitActive: (props.exitActiveClass || name + \"-exit-active\").split(\" \"),\n      exit: (props.exitClass || name + \"-exit\").split(\" \"),\n      exitTo: (props.exitToClass || name + \"-exit-to\").split(\" \"),\n      move: (props.moveClass || name + \"-move\").split(\" \")\n    };\n  });\n}\nfunction nextFrame(fn) {\n  requestAnimationFrame(() => requestAnimationFrame(fn));\n}\nfunction enterTransition(classes, events, el, done) {\n  const { onBeforeEnter, onEnter, onAfterEnter } = events;\n  onBeforeEnter?.(el);\n  el.classList.add(...classes.enter);\n  el.classList.add(...classes.enterActive);\n  queueMicrotask(() => {\n    if (!el.parentNode)\n      return done?.();\n    onEnter?.(el, () => endTransition());\n  });\n  nextFrame(() => {\n    el.classList.remove(...classes.enter);\n    el.classList.add(...classes.enterTo);\n    if (!onEnter || onEnter.length < 2) {\n      el.addEventListener(\"transitionend\", endTransition);\n      el.addEventListener(\"animationend\", endTransition);\n    }\n  });\n  function endTransition(e) {\n    if (!e || e.target === el) {\n      done?.();\n      el.removeEventListener(\"transitionend\", endTransition);\n      el.removeEventListener(\"animationend\", endTransition);\n      el.classList.remove(...classes.enterActive);\n      el.classList.remove(...classes.enterTo);\n      onAfterEnter?.(el);\n    }\n  }\n}\nfunction exitTransition(classes, events, el, done) {\n  const { onBeforeExit, onExit, onAfterExit } = events;\n  if (!el.parentNode)\n    return done?.();\n  onBeforeExit?.(el);\n  el.classList.add(...classes.exit);\n  el.classList.add(...classes.exitActive);\n  onExit?.(el, () => endTransition());\n  nextFrame(() => {\n    el.classList.remove(...classes.exit);\n    el.classList.add(...classes.exitTo);\n    if (!onExit || onExit.length < 2) {\n      el.addEventListener(\"transitionend\", endTransition);\n      el.addEventListener(\"animationend\", endTransition);\n    }\n  });\n  function endTransition(e) {\n    if (!e || e.target === el) {\n      done?.();\n      el.removeEventListener(\"transitionend\", endTransition);\n      el.removeEventListener(\"animationend\", endTransition);\n      el.classList.remove(...classes.exitActive);\n      el.classList.remove(...classes.exitTo);\n      onAfterExit?.(el);\n    }\n  }\n}\n\n// src/Transition.ts\nimport { createSwitchTransition } from \"@solid-primitives/transition-group\";\nimport { resolveFirst } from \"@solid-primitives/refs\";\nvar TRANSITION_MODE_MAP = {\n  inout: \"in-out\",\n  outin: \"out-in\"\n};\nvar Transition = (props) => {\n  const classnames = createClassnames(props);\n  return createSwitchTransition(\n    resolveFirst(() => props.children),\n    {\n      mode: TRANSITION_MODE_MAP[props.mode],\n      appear: props.appear,\n      onEnter(el, done) {\n        enterTransition(classnames(), props, el, done);\n      },\n      onExit(el, done) {\n        exitTransition(classnames(), props, el, done);\n      }\n    }\n  );\n};\n\n// src/TransitionGroup.ts\nimport { createListTransition } from \"@solid-primitives/transition-group\";\nimport { resolveElements } from \"@solid-primitives/refs\";\nvar TransitionGroup = (props) => {\n  const classnames = createClassnames(props);\n  return createListTransition(resolveElements(() => props.children).toArray, {\n    appear: props.appear,\n    exitMethod: \"keep-index\",\n    onChange({ added, removed, finishRemoved, list }) {\n      const classes = classnames();\n      for (const el of added) {\n        enterTransition(classes, props, el);\n      }\n      const toMove = [];\n      for (const el of list) {\n        if (el.isConnected && (el instanceof HTMLElement || el instanceof SVGElement)) {\n          toMove.push({ el, rect: el.getBoundingClientRect() });\n        }\n      }\n      queueMicrotask(() => {\n        const moved = [];\n        for (const { el, rect } of toMove) {\n          if (el.isConnected) {\n            const newRect = el.getBoundingClientRect(), dX = rect.left - newRect.left, dY = rect.top - newRect.top;\n            if (dX || dY) {\n              el.style.transform = `translate(${dX}px, ${dY}px)`;\n              el.style.transitionDuration = \"0s\";\n              moved.push(el);\n            }\n          }\n        }\n        document.body.offsetHeight;\n        for (const el of moved) {\n          let endTransition2 = function(e) {\n            if (e.target === el || /transform$/.test(e.propertyName)) {\n              el.removeEventListener(\"transitionend\", endTransition2);\n              el.classList.remove(...classes.move);\n            }\n          };\n          var endTransition = endTransition2;\n          el.classList.add(...classes.move);\n          el.style.transform = el.style.transitionDuration = \"\";\n          el.addEventListener(\"transitionend\", endTransition2);\n        }\n      });\n      for (const el of removed) {\n        exitTransition(classes, props, el, () => finishRemoved([el]));\n      }\n    }\n  });\n};\nexport {\n  Transition,\n  TransitionGroup\n};\n","import { Component, createEffect, createMemo, createSignal, For, Match, onMount, Show, Switch } from \"solid-js\";\nimport { hookForDev } from \"../../lib/devTools\";\nimport { useThreadContext } from \"../../contexts/ThreadContext\";\nimport Avatar from \"../Avatar/Avatar\";\nimport { TransitionGroup } from 'solid-transition-group';\nimport styles from  \"./Note.module.scss\";\nimport { PrimalNote, PrimalUser, TopZap } from \"../../types/primal\";\nimport { useAccountContext } from \"../../contexts/AccountContext\";\n\nconst NoteTopZapsCompact: Component<{\n  note: PrimalNote,\n  action: (zap: TopZap) => void,\n  topZaps: TopZap[],\n  topZapLimit: number,\n  id?: string,\n  hideMessage?: boolean,\n}> = (props) => {\n  const account = useAccountContext();\n\n  const [dontAnimate, setDontAnimate] = createSignal(true);\n\n  const topZaps = () => {\n    const zaps = props.topZaps ? [...props.topZaps] : [ ...props.note.topZaps ];\n\n    const highlights = zaps.slice(0, props.topZapLimit);\n\n    return highlights;\n  }\n\n  const zapSender = (zap: TopZap) => {\n    if (zap.pubkey === account?.publicKey) return account.activeUser;\n\n    return (props.note.mentionedUsers || {})[zap.pubkey];\n  };\n\n  onMount(() => {\n    setTimeout(() => {\n      setDontAnimate(() => false);\n    }, 600)\n  });\n\n  return (\n    <Show when={topZaps().length > 0}>\n      <div class={`${styles.zapHighlightsTiny}`}>\n        <TransitionGroup\n          name=\"top-zaps-feed\"\n          enterClass={styles.topZapEnterTransition}\n          exitClass={styles.topZapExitTransition}\n        >\n          <For each={topZaps()}>\n            {(zap, index) => (\n              <div\n                class={`${styles.zapWrap} ${dontAnimate() ? styles.noAnimation : '' }`}\n                style={`z-index: ${12 - index()};`}\n                data-index={index()}\n              >\n                <button\n                  class={`${styles.topZap} ${styles.compact}`}\n                  onClick={(e) => {\n                    e.preventDefault();\n                    e.stopPropagation();\n                    props.action(zap);\n                  }}\n                  style={`z-index: ${12 - index()};`}\n                >\n                  <Avatar user={zapSender(zap)} size=\"micro\" />\n                </button>\n              </div>\n            )}\n          </For>\n        </TransitionGroup>\n      </div>\n    </Show>\n  );\n}\n\nexport default hookForDev(NoteTopZapsCompact);\n","import { A, useNavigate } from '@solidjs/router';\nimport { batch, Component, createEffect, createSignal, For, Show } from 'solid-js';\nimport { createStore } from 'solid-js/store';\nimport { wordsPerMinute } from '../../constants';\nimport { useAccountContext } from '../../contexts/AccountContext';\nimport { CustomZapInfo, useAppContext } from '../../contexts/AppContext';\nimport { useMediaContext } from '../../contexts/MediaContext';\nimport { useThreadContext } from '../../contexts/ThreadContext';\nimport { shortDate } from '../../lib/dates';\nimport { hookForDev } from '../../lib/devTools';\nimport { userName } from '../../stores/profile';\nimport { PrimalArticle, TopZap, ZapOption } from '../../types/primal';\nimport { uuidv4 } from '../../utils';\nimport Avatar from '../Avatar/Avatar';\nimport { NoteReactionsState } from '../Note/Note';\nimport VerificationCheck from '../VerificationCheck/VerificationCheck';\n\nimport defaultAvatarDark from '../../assets/images/reads_image_dark.png';\nimport defaultAvatarLight from '../../assets/images/reads_image_light.png';\n\nimport styles from './ArticlePreview.module.scss';\nimport { useSettingsContext } from '../../contexts/SettingsContext';\nimport NoteTopZapsCompact from '../Note/NoteTopZapsCompact';\nimport NoteTopZapsTiny from '../Note/NoteTopZapsTiny';\nimport { nip19 } from 'nostr-tools';\n\nconst isDev = localStorage.getItem('devMode') === 'true';\n\nconst ArticleCompactPreview: Component<{\n  id?: string,\n  article: PrimalArticle,\n  height?: number,\n  onRender?: (article: PrimalArticle, el: HTMLAnchorElement | undefined) => void,\n  hideFooter?: boolean,\n  hideContext?: boolean,\n  boredered?: boolean,\n}> = (props) => {\n\n  const app = useAppContext();\n  const account = useAccountContext();\n  const thread = useThreadContext();\n  const media = useMediaContext();\n  const settings = useSettingsContext();\n  const navigate = useNavigate();\n\n  const [reactionsState, updateReactionsState] = createStore<NoteReactionsState>({\n    likes: props.article.likes || 0,\n    liked: props.article.noteActions?.liked || false,\n    reposts: props.article.reposts || 0,\n    reposted: props.article.noteActions?.reposted || false,\n    replies: props.article.replies || 0,\n    replied: props.article.noteActions?.replied || false,\n    zapCount: props.article.zaps || 0,\n    satsZapped: props.article.satszapped || 0,\n    zapped: props.article.noteActions?.zapped || false,\n    zappedAmount: 0,\n    zappedNow: false,\n    isZapping: false,\n    showZapAnim: false,\n    hideZapIcon: false,\n    moreZapsAvailable: false,\n    isRepostMenuVisible: false,\n    topZaps: [],\n    topZapsFeed: [],\n    quoteCount: 0,\n  });\n\n  let latestTopZap: string = '';\n  let latestTopZapFeed: string = '';\n  let articleContextMenu: HTMLDivElement | undefined;\n\n  const onConfirmZap = (zapOption: ZapOption) => {\n    app?.actions.closeCustomZapModal();\n    batch(() => {\n      updateReactionsState('zappedAmount', () => zapOption.amount || 0);\n      updateReactionsState('satsZapped', (z) => z + (zapOption.amount || 0));\n      updateReactionsState('zapped', () => true);\n      updateReactionsState('showZapAnim', () => true)\n    });\n\n    addTopZap(zapOption);\n    addTopZapFeed(zapOption)\n  };\n\n  const onSuccessZap = (zapOption: ZapOption) => {\n    app?.actions.closeCustomZapModal();\n    app?.actions.resetCustomZap();\n\n    const pubkey = account?.publicKey;\n\n    if (!pubkey) return;\n\n    batch(() => {\n      updateReactionsState('zapCount', (z) => z + 1);\n      updateReactionsState('isZapping', () => false);\n      updateReactionsState('showZapAnim', () => false);\n      updateReactionsState('hideZapIcon', () => false);\n      updateReactionsState('zapped', () => true);\n    });\n  };\n\n  const onFailZap = (zapOption: ZapOption) => {\n    app?.actions.closeCustomZapModal();\n    app?.actions.resetCustomZap();\n    batch(() => {\n      updateReactionsState('zappedAmount', () => -(zapOption.amount || 0));\n      updateReactionsState('satsZapped', (z) => z - (zapOption.amount || 0));\n      updateReactionsState('isZapping', () => false);\n      updateReactionsState('showZapAnim', () => false);\n      updateReactionsState('hideZapIcon', () => false);\n      updateReactionsState('zapped', () => props.article.noteActions.zapped);\n    });\n\n    removeTopZap(zapOption);\n    removeTopZapFeed(zapOption);\n  };\n\n  const onCancelZap = (zapOption: ZapOption) => {\n    app?.actions.closeCustomZapModal();\n    app?.actions.resetCustomZap();\n    batch(() => {\n      updateReactionsState('zappedAmount', () => -(zapOption.amount || 0));\n      updateReactionsState('satsZapped', (z) => z - (zapOption.amount || 0));\n      updateReactionsState('isZapping', () => false);\n      updateReactionsState('showZapAnim', () => false);\n      updateReactionsState('hideZapIcon', () => false);\n      updateReactionsState('zapped', () => props.article.noteActions.zapped);\n    });\n\n    removeTopZap(zapOption);\n    removeTopZapFeed(zapOption);\n  };\n\n  const addTopZap = (zapOption: ZapOption) => {\n    const pubkey = account?.publicKey;\n\n    if (!pubkey) return;\n\n    const oldZaps = [ ...reactionsState.topZaps ];\n\n    latestTopZap = uuidv4() as string;\n\n    const newZap = {\n      amount: zapOption.amount || 0,\n      message: zapOption.message || '',\n      pubkey,\n      eventId: props.article.id,\n      id: latestTopZap,\n    };\n\n    if (!thread?.users.find((u) => u.pubkey === pubkey)) {\n      thread?.actions.fetchUsers([pubkey])\n    }\n\n    const zaps = [ ...oldZaps, { ...newZap }].sort((a, b) => b.amount - a.amount);\n    updateReactionsState('topZaps', () => [...zaps]);\n  };\n\n  const removeTopZap = (zapOption: ZapOption) => {\n    const zaps = reactionsState.topZaps.filter(z => z.id !== latestTopZap);\n    updateReactionsState('topZaps', () => [...zaps]);\n  };\n\n\n  const addTopZapFeed = (zapOption: ZapOption) => {\n    const pubkey = account?.publicKey;\n\n    if (!pubkey) return;\n\n    const oldZaps = [ ...reactionsState.topZapsFeed ];\n\n    latestTopZapFeed = uuidv4() as string;\n\n    const newZap = {\n      amount: zapOption.amount || 0,\n      message: zapOption.message || '',\n      pubkey,\n      eventId: props.article.id,\n      id: latestTopZapFeed,\n    };\n\n    const zaps = [ ...oldZaps, { ...newZap }].sort((a, b) => b.amount - a.amount).slice(0, 4);\n    updateReactionsState('topZapsFeed', () => [...zaps]);\n  }\n\n  const removeTopZapFeed = (zapOption: ZapOption) => {\n    const zaps = reactionsState.topZapsFeed.filter(z => z.id !== latestTopZapFeed);\n    updateReactionsState('topZapsFeed', () => [...zaps]);\n  };\n\n  const customZapInfo: () => CustomZapInfo = () => ({\n    note: props.article,\n    onConfirm: onConfirmZap,\n    onSuccess: onSuccessZap,\n    onFail: onFailZap,\n    onCancel: onCancelZap,\n  });\n\n  const openReactionModal = (openOn = 'likes') =>  {\n    app?.actions.openReactionModal(props.article.naddr, {\n      likes: reactionsState.likes,\n      zaps: reactionsState.zapCount,\n      reposts: reactionsState.reposts,\n      quotes: reactionsState.quoteCount,\n      openOn,\n    });\n  };\n\n  const onContextMenuTrigger = () => {\n    app?.actions.openContextMenu(\n      props.article,\n      articleContextMenu?.getBoundingClientRect(),\n      () => {\n        app?.actions.openCustomZapModal(customZapInfo());\n      },\n      openReactionModal,\n    );\n  }\n\n  let articlePreview: HTMLAnchorElement | undefined;\n\n  const [missingCacheImage, setMissingChacheImage] = createSignal(false);\n\n  const articleImage = () => {\n    const url = props.article.image;\n    setMissingChacheImage(() => false);\n\n    let m = media?.actions.getMediaUrl(url, 's');\n\n    if (!m) {\n      m = media?.actions.getMediaUrl(url, 'm');\n    }\n\n    if (!m) {\n      m = media?.actions.getMediaUrl(url, 'o');\n    }\n\n    if (!m) {\n      m = url;\n      setMissingChacheImage(() => true);\n    }\n\n    return m;\n  }\n\n  const authorAvatar = () => {\n    const url = props.article.user.picture;\n    setMissingChacheImage(() => false);\n\n    let m = media?.actions.getMediaUrl(url, 's');\n\n    if (!m) {\n      m = media?.actions.getMediaUrl(url, 'm');\n    }\n\n    if (!m) {\n      m = media?.actions.getMediaUrl(url, 'o');\n    }\n\n    if (!m) {\n      m = url;\n      setMissingChacheImage(() => true);\n    }\n\n    return m;\n  }\n\n  const onImageLoaded = () => {\n    props.onRender && props.onRender(props.article, articlePreview);\n  };\n\n  const onImageError = (event: any) => {\n    const image = event.target;\n\n    let src: string = authorAvatar();\n\n    if (image.src === src || image.src.endsWith(src)) {\n      src = ['sunrise_wave', 'ice_wave'].includes(settings?.theme || '') ? defaultAvatarLight : defaultAvatarDark;\n    }\n\n    image.onerror = \"\";\n    image.src = src;\n    return true;\n  };\n\n  const countLines = (el: Element) => {\n\n    // @ts-ignore\n    var divHeight = el.offsetHeight\n\n    // @ts-ignore\n    var lineHeight = el.computedStyleMap().get('line-height').value;\n\n    var lines = divHeight / lineHeight;\n\n    return lines;\n  }\n\n  const [contentStyle, setContentStyle] = createSignal('T3');\n\n  createEffect(() => {\n    const t = props.article.title;\n    const s = props.article.summary;\n\n    const tt = articlePreview?.querySelector(`.${styles.title}`);\n    const ss = articlePreview?.querySelector(`.${styles.summary}`);\n\n    if (!tt || !ss) return;\n\n    const titleLines = countLines(tt);\n    const summaryLines = countLines(ss);\n\n    if (titleLines === 1) setContentStyle('T1');\n\n    if (titleLines === 2) setContentStyle('T2');\n\n    if (titleLines === 3) setContentStyle('T3');\n  });\n\n  const conetntStyles = () => {\n    if (contentStyle() === 'T1') return styles.t1;\n    if (contentStyle() === 'T2') return styles.t2;\n\n    return ''\n  }\n\n  const articleUrl = () => {\n    const vanityName = app?.verifiedUsers[props.article.pubkey];\n\n    if (!vanityName) return `/e/${props.article.naddr}`;\n\n    const decoded = nip19.decode(props.article.naddr);\n\n    const data = decoded.data as nip19.AddressPointer;\n\n    return `/${vanityName}/${data.identifier}`;\n  }\n\n  return (\n    <A\n      ref={articlePreview}\n      class={styles.articleCompact}\n      href={articleUrl()}\n    >\n      <div class={styles.image}>\n        <Show\n          when={props.article.image}\n          fallback={\n            <Show\n              when={authorAvatar()}\n              fallback={<div class={styles.placeholderImage}></div>}\n            >\n              <img src={props.article.user.picture} onload={onImageLoaded} onerror={onImageError} />\n            </Show>\n          }\n        >\n          <img\n            src={articleImage()}\n            onload={onImageLoaded}\n            onerror={onImageError}\n            class={isDev && missingCacheImage() ? 'redBorder' : ''}\n          />\n        </Show>\n      </div>\n\n      <div class={styles.articleInfo}>\n        <div class={styles.header}>\n          <div class={styles.userInfo}>\n            <Avatar user={props.article.user} size=\"micro\"/>\n            <div class={styles.userName}>{userName(props.article.user)}</div>\n            <VerificationCheck user={props.article.user} />\n            <div class={styles.nip05}>{props.article.user?.nip05 || ''}</div>\n          </div>\n          <div class={styles.time}>\n            {shortDate(props.article.published)}\n          </div>\n        </div>\n\n        <div class={styles.body}>\n          <div class={styles.text}>\n            <div class={`${styles.content} ${conetntStyles()}`}>\n              <div class={styles.title}>\n                {props.article.title}\n              </div>\n              <div class={styles.summary}>\n                {props.article.summary}\n              </div>\n            </div>\n            <div class={styles.footer}>\n              <div class={styles.tags}>\n                <div class={styles.estimate}>\n                  {Math.ceil(props.article.wordCount / wordsPerMinute)} min read\n                </div>\n                <div class={styles.comments}>\n                  <div class={styles.commentIcon}></div>\n                  <div class={styles.commentCount}>\n                    {props.article.replies} comments\n                  </div>\n                </div>\n              </div>\n\n              <div class={styles.zaps}>\n              <div class={styles.zapIcon}></div>\n                <NoteTopZapsTiny\n                  note={props.article}\n                  action={(zap: TopZap) => app && navigate(app.actions.profileLink(zap.pubkey))}\n                  topZaps={props.article.topZaps}\n                  topZapLimit={3}\n                  hideMessage={true}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n\n      </div>\n\n\n      {/* <Show when={props.article.topZaps?.length > 0}>\n        <div class={styles.zaps}>\n          <NoteTopZapsCompact\n            note={props.article}\n            action={() => {}}\n            topZaps={props.article.topZaps}\n            topZapLimit={4}\n          />\n        </div>\n      </Show>\n\n      <Show when={!props.hideFooter}>\n        <div class={styles.footer}>\n          <ArticleFooter\n            note={props.article}\n            state={reactionsState}\n            updateState={updateReactionsState}\n            customZapInfo={customZapInfo()}\n            onZapAnim={addTopZapFeed}\n          />\n        </div>\n      </Show> */}\n\n    </A>\n  );\n}\n\nexport default hookForDev(ArticleCompactPreview);\n","import { A } from \"@solidjs/router\";\nimport { Component, createSignal, onMount, Show } from \"solid-js\";\nimport { Kind } from \"../../constants\";\nimport { useAppContext } from \"../../contexts/AppContext\";\nimport { date } from \"../../lib/dates\";\nimport { hookForDev } from \"../../lib/devTools\";\nimport { hexToNpub } from \"../../lib/keys\";\nimport { humanizeNumber } from \"../../lib/stats\";\nimport { userName } from \"../../stores/profile\";\nimport { MenuItem, PrimalArticle, PrimalNote, PrimalUser, PrimalZap } from \"../../types/primal\";\nimport Avatar from \"../Avatar/Avatar\";\nimport styles from  \"./ProfileNoteZap.module.scss\";\n\n\nconst ProfileNoteZap: Component<{\n  id?: string,\n  subject: PrimalArticle | PrimalNote | PrimalUser | undefined,\n  zap: PrimalZap,\n}> = (props) => {\n\n  const app = useAppContext();\n\n  const userNpub = (user: PrimalUser | string | undefined) => {\n    if (typeof user === 'string') return hexToNpub(user);\n\n    return user && user.npub;\n  }\n\n  const subject = () => {\n    if (!props.subject) return <div class={styles.subject}>UNKNOWN</div>\n\n    let content = '';\n    let time = 0;\n    let link = '';\n    let name = ''\n\n    if (props.subject.msg.kind === Kind.Text) {\n      const sub = props.subject as PrimalNote;\n\n      content = sub.content;\n      time = props.zap.created_at || 0;\n      link = `/e/${sub.noteId}`;\n      name = userName(sub.user);\n    }\n\n    if (props.subject.msg.kind === Kind.LongForm) {\n      const sub = props.subject as PrimalArticle;\n      content = sub.title;\n      time = props.zap.created_at || 0;\n      link = `/e/${sub.noteId}`;\n      name = userName(sub.user);\n    }\n\n    if (props.subject.msg.kind === Kind.Metadata) {\n      const sub = props.subject as PrimalUser;\n      content = sub.about;\n      time = props.zap.created_at || 0;\n      link = app?.actions.profileLink(sub.npub) || '';\n      name = userName(sub);\n    }\n\n    return (\n      <A href={link} class={styles.subject}>\n        <div class={styles.header}>\n          <div class={styles.userName}>\n            {name}\n          </div>\n          <Show when={time > 0}>\n            <div class={styles.bullet}>&middot;</div>\n            <div class={styles.time}>\n              {date(time).label}\n            </div>\n          </Show>\n        </div>\n        <div class={styles.body}>\n          {content}\n        </div>\n      </A>\n    );\n  }\n\n  return (\n    <div class={styles.contentZap} data-zap-id={props.zap.id}>\n      <div class={styles.zapInfo}>\n        <A href={app?.actions.profileLink(userNpub(props.zap.sender)) || ''} class={styles.sender}>\n          <Avatar size=\"vs2\" user={props.zap.sender} />\n        </A >\n\n        <div class={styles.data}>\n          <div class={styles.amount}>\n            <div class={styles.zapIcon}></div>\n            <div class={styles.number}>{props.zap.amount.toLocaleString()}</div>\n          </div>\n          <div class={styles.message}>\n            {props.zap.message}\n          </div>\n        </div>\n\n        <A href={app?.actions.profileLink(userNpub(props.zap.sender)) || ''} class={styles.receiver}>\n          <Avatar size=\"vs2\" user={props.zap.reciver} />\n        </A>\n      </div>\n\n      {subject()}\n    </div>\n  )\n}\n\nexport default hookForDev(ProfileNoteZap);\n","import { A } from '@solidjs/router';\nimport { decodeIdentifier, hexToNpub } from '../../lib/keys';\nimport {\n  getLinkPreview,\n  getParametrizedEvent,\n  isAddrMention,\n  isAppleMusic,\n  isCustomEmoji,\n  isHashtag,\n  isImage,\n  isInterpunction,\n  isLnbc,\n  isMixCloud,\n  isMp4Video,\n  isNoteMention,\n  isOggVideo,\n  isSoundCloud,\n  isSpotify,\n  isTagMention,\n  isTwitch,\n  isUnitifedLnAddress,\n  isUrl,\n  isUserMention,\n  isWavelake,\n  isWebmVideo,\n  isYouTube,\n} from '../../lib/notes';\nimport { truncateNpub, userName } from '../../stores/profile';\nimport EmbeddedNote from '../EmbeddedNote/EmbeddedNote';\nimport {\n  Component, createSignal, For, JSXElement, onMount, Show,\n} from 'solid-js';\nimport {\n  NostrEventContent,\n  NostrUserZaps,\n  PrimalArticle,\n  PrimalNote,\n  PrimalUser,\n  PrimalZap,\n} from '../../types/primal';\n\nimport styles from './ParsedNote.module.scss';\nimport { nip19, generatePrivateKey } from '../../lib/nTools';\nimport LinkPreview from '../LinkPreview/LinkPreview';\nimport MentionedUserLink from '../Note/MentionedUserLink/MentionedUserLink';\nimport { useMediaContext } from '../../contexts/MediaContext';\nimport { hookForDev } from '../../lib/devTools';\nimport { getMediaUrl as getMediaUrlDefault } from \"../../lib/media\";\nimport NoteImage from '../NoteImage/NoteImage';\nimport { createStore } from 'solid-js/store';\nimport { hashtagCharsRegex, Kind, linebreakRegex, lnUnifiedRegex, shortMentionInWords, shortNoteChars, shortNoteWords, specialCharsRegex, urlExtractRegex } from '../../constants';\nimport { useIntl } from '@cookbook/solid-intl';\nimport { actions } from '../../translations';\n\nimport PhotoSwipeLightbox from 'photoswipe/lightbox';\nimport Lnbc from '../Lnbc/Lnbc';\nimport { logError } from '../../lib/logger';\nimport { useAppContext } from '../../contexts/AppContext';\nimport ArticleCompactPreview from '../ArticlePreview/ArticleCompactPreview';\nimport { fetchArticles } from '../../handleNotes';\nimport { APP_ID } from '../../App';\nimport { getEvents } from '../../lib/feed';\nimport { useAccountContext } from '../../contexts/AccountContext';\nimport { subsTo } from '../../sockets';\nimport ProfileNoteZap from '../ProfileNoteZap/ProfileNoteZap';\nimport { parseBolt11 } from '../../utils';\n\nconst groupGridLimit = 7;\n\nexport type NoteContent = {\n  type: string,\n  tokens: string[],\n  meta?: Record<string, any>,\n};\n\nexport const groupGalleryImages = (noteHolder: HTMLDivElement | undefined) => {\n\n      // Go through the note and find all images to group them in sections separated by non-image content.\n      // Once grouped we will combine them in a grid layout to save screen space.\n\n      if (!noteHolder) return;\n\n      // Get all images\n      const allImgs: NodeListOf<HTMLAnchorElement> = noteHolder.querySelectorAll('a.noteimage');\n\n      if (allImgs.length === 0) return;\n\n      // If there is only a single image, just remove thumbnail cropping, nothing more is needed.\n      if (allImgs.length === 1) {\n        allImgs[0].removeAttribute('data-cropped');\n        return;\n      }\n\n      let grouped: { group: string, images: HTMLAnchorElement[]}[] = [];\n\n      // Sort images into groups, based on `data-image-group` attribute\n      allImgs.forEach((img) => {\n        // @ts-ignore\n        const group: string = img.attributes['data-image-group'].nodeValue;\n\n        let g = grouped.find((g) => g.group === group);\n\n        if (g) {\n          g.images.push(img);\n        }\n        else {\n          grouped.push({ group, images: [img] })\n        }\n      });\n\n      // Wrap each group into a div with a grid layout,\n      grouped.forEach(group => {\n        // if there is only one image in this group nothing further is needed\n        if (group.images.length < 2) return;\n\n        const groupCount = group.images.length;\n        const gridClass = groupCount < groupGridLimit ? `grid-${groupCount}` : 'grid-large';\n\n        const first = group.images[0];\n        const parent = first.parentElement;\n\n        // Create the wrapper for this group\n        const wrapper = document.createElement('div');\n\n        // Insert the wrapper into the note content, before the first image of the group\n        parent?.insertBefore(wrapper, first);\n\n        // Move each image of the group into the wrapper, also setting css classes and atributes for proper display\n        group.images.forEach((img, index) => {\n          img.classList.add(`cell_${index+1}`);\n          img.setAttribute('style', 'width: 100%; height: 100%;');\n          img.classList.remove('noteimage');\n          img.classList.add('noteimage_gallery');\n\n          img.classList.remove('roundedImage');\n          wrapper.appendChild(img as Node)\n        });\n\n        // Add classes to the wrapper for layouting\n        wrapper.classList.add('imageGrid');\n        wrapper.classList.add(gridClass)\n      });\n\n      const brs = [].slice.call(noteHolder.querySelectorAll('br + br + br'));\n\n      brs.forEach((br: HTMLBRElement) =>{\n        br.parentNode?.removeChild(br);\n      });\n};\n\nconst ParsedNote: Component<{\n  note: PrimalNote,\n  id?: string,\n  ignoreMedia?: boolean,\n  ignoreLinebreaks?: boolean,\n  noLinks?: 'links' | 'text',\n  noPreviews?: boolean,\n  shorten?: boolean,\n  veryShort?: boolean,\n  isEmbeded?: boolean,\n  width?: number,\n  margins?: number,\n  noLightbox?: boolean,\n  altEmbeds?: boolean,\n  embedLevel?: number,\n  rootNote?: PrimalNote,\n  footerSize?: 'xwide' | 'wide' | 'normal' | 'compact' | 'short' | 'mini',\n}> = (props) => {\n\n  const intl = useIntl();\n  const media = useMediaContext();\n  const app = useAppContext();\n  const account = useAccountContext();\n\n  const dev = localStorage.getItem('devMode') === 'true';\n\n  const id = () => {\n    // if (props.id) return props.id;\n\n    return `note_${props.note.noteId}`;\n  }\n\n  const noteWidth = () => props.width || 514;\n\n  let thisNote: HTMLDivElement | undefined;\n\n  const lightbox = new PhotoSwipeLightbox({\n    gallery: `#${id()}`,\n    children: `a.image_${props.note.noteId}`,\n    showHideAnimationType: 'zoom',\n    initialZoomLevel: 'fit',\n    secondaryZoomLevel: 2,\n    maxZoomLevel: 3,\n    thumbSelector: `a.image_${props.note.noteId}`,\n    pswpModule: () => import('photoswipe')\n  });\n\n  onMount(() => {\n    if (props.noLightbox) return;\n\n    lightbox.init();\n  });\n\n  const [tokens, setTokens] = createStore<string[]>([]);\n\n  const [wordsDisplayed, setWordsDisplayed] = createSignal(0);\n\n  const isNoteTooLong = () => {\n    return props.shorten && wordsDisplayed() > shortNoteWords;\n  };\n\n  const rootNote = () => props.rootNote || props.note;\n\n  const noteContent = () => {\n    const content = props.note.content || '';\n    const charLimit = 7 * shortNoteChars;\n\n    if (!props.shorten || content.length < charLimit) return content;\n\n    // Find the first word break after the char limit so we don't do a word cut-off\n    const nextWordBreak = content.slice(charLimit).search(/\\s|\\n|\\r/);\n\n    return content.slice(0, charLimit + nextWordBreak);\n  };\n\n  const parseContent = () => {\n    const content = props.ignoreLinebreaks ?\n      noteContent().replace(/\\s+/g, ' __SP__ ') :\n      noteContent().replace(linebreakRegex, ' __LB__ ').replace(/\\s+/g, ' __SP__ ');\n\n    const tokens = content.split(/[\\s]+/);\n\n    setTokens(() => [...tokens]);\n  }\n\n  const removeLinebreaks = (type: string) => {\n    if (lastSignificantContent === 'LB') {\n      const lastIndex = content.length - 1;\n      const lastGroup = content[lastIndex];\n\n      setContent(lastIndex, () => ({\n        type: lastGroup.type,\n        tokens: [],\n        meta: {\n          ...lastGroup.meta,\n          removedBy: type,\n          removedTokens: [...lastGroup.tokens],\n        },\n      }));\n    }\n  };\n\n  const [content, setContent] = createStore<NoteContent[]>([]);\n\n  const updateContent = (contentArray: NoteContent[], type: string, token: string, meta?: Record<string, any>) => {\n    const len = contentArray.length;\n    const index = contentArray.length -1\n\n    if (len > 0 && contentArray[len -1].type === type) {\n\n      setContent(index, 'tokens' , (els) => [...els, token]);\n\n      meta && setContent(index, 'meta' , () => ({ ...meta }));\n\n      return;\n    }\n\n    setContent(len, () => ({ type, tokens: [token], meta }));\n  }\n\n  let lastSignificantContent = 'text';\n  let isAfterEmbed = false;\n  let totalLinks = 0;\n\n  const parseToken = (token: string) => {\n    if (token === '__LB__') {\n      if (isAfterEmbed) {\n        return;\n      }\n\n      updateContent(content, 'linebreak', token);\n      lastSignificantContent = 'LB';\n      return;\n    }\n\n    if (token === '__SP__') {\n      if (!['image', 'video', 'LB'].includes(lastSignificantContent)) {\n        updateContent(content, 'text', ' ');\n      }\n      return;\n    }\n\n    isAfterEmbed = false;\n\n    if (isInterpunction(token)) {\n      lastSignificantContent = 'text';\n      updateContent(content, 'text', token);\n      return;\n    }\n\n    if (isUrl(token)) {\n      const index = token.indexOf('http');\n\n      if (index > 0) {\n        const prefix = token.slice(0, index);\n\n        const matched = (token.match(urlExtractRegex) || [])[0];\n\n        if (matched) {\n          const suffix = token.substring(matched.length + index, token.length);\n\n          parseToken(prefix);\n          parseToken(matched);\n          parseToken(suffix);\n          return;\n        } else {\n          parseToken(prefix);\n          parseToken(token.slice(index));\n          return;\n        }\n      }\n\n      if (!props.ignoreMedia) {\n        if (isImage(token)) {\n          removeLinebreaks('image');\n          isAfterEmbed = true;\n          lastSignificantContent = 'image';\n          updateContent(content, 'image', token);\n          return;\n        }\n\n        if (isMp4Video(token)) {\n          removeLinebreaks('video');\n          isAfterEmbed = true;\n          lastSignificantContent = 'video';\n          updateContent(content, 'video', token, { videoType: 'video/mp4'});\n          return;\n        }\n\n        if (isOggVideo(token)) {\n          removeLinebreaks('video');\n          isAfterEmbed = true;\n          lastSignificantContent = 'video';\n          updateContent(content, 'video', token, { videoType: 'video/ogg'});\n          return;\n        }\n\n        if (isWebmVideo(token)) {\n          removeLinebreaks('video');\n          isAfterEmbed = true;\n          lastSignificantContent = 'video';\n          updateContent(content, 'video', token, { videoType: 'video/webm'});\n          return;\n        }\n\n        if (isYouTube(token)) {\n          removeLinebreaks('youtube');\n          isAfterEmbed = true;\n          lastSignificantContent = 'youtube';\n          updateContent(content, 'youtube', token);\n          return;\n        }\n\n        if (isSpotify(token)) {\n          removeLinebreaks('spotify');\n          isAfterEmbed = true;\n          lastSignificantContent = 'spotify';\n          updateContent(content, 'spotify', token);\n          return;\n        }\n\n        if (isTwitch(token)) {\n          removeLinebreaks('twitch');\n          isAfterEmbed = true;\n          lastSignificantContent = 'twitch';\n          updateContent(content, 'twitch', token);\n          return;\n        }\n\n        if (isMixCloud(token)) {\n          removeLinebreaks('mixcloud');\n          isAfterEmbed = true;\n          lastSignificantContent = 'mixcloud';\n          updateContent(content, 'mixcloud', token);\n          return;\n        }\n\n        if (isSoundCloud(token)) {\n          removeLinebreaks('soundcloud');\n          isAfterEmbed = true;\n          lastSignificantContent = 'soundcloud';\n          updateContent(content, 'soundcloud', token);\n          return;\n        }\n\n        if (isAppleMusic(token)) {\n          removeLinebreaks('applemusic');\n          isAfterEmbed = true;\n          lastSignificantContent = 'applemusic';\n          updateContent(content, 'applemusic', token);\n          return;\n        }\n\n        if (isWavelake(token)) {\n          removeLinebreaks('wavelake');\n          isAfterEmbed = true;\n          lastSignificantContent = 'wavelake';\n          updateContent(content, 'wavelake', token);\n          return;\n        }\n      }\n\n      if (props.noLinks === 'text') {\n        lastSignificantContent = 'text';\n        updateContent(content, 'text', token);\n        return;\n      }\n\n      const preview = getLinkPreview(token);\n\n      const hasMinimalPreviewData = !props.noPreviews &&\n        preview &&\n        preview.url &&\n        ((!!preview.description && preview.description.length > 0) ||\n          !preview.images?.some((x:any) => x === '') ||\n          !!preview.title\n        );\n\n      if (hasMinimalPreviewData) {\n        removeLinebreaks('link');\n        updateContent(content, 'link', token, { preview });\n      } else {\n        updateContent(content, 'link', token);\n      }\n\n      lastSignificantContent = 'link';\n      isAfterEmbed = false;\n      totalLinks++;\n      return;\n    }\n\n    if (isNoteMention(token)) {\n      removeLinebreaks('notemention');\n      lastSignificantContent = 'notemention';\n      isAfterEmbed = true;\n      updateContent(content, 'notemention', token);\n      return;\n    }\n\n    if (isUserMention(token)) {\n      lastSignificantContent = 'usermention';\n      updateContent(content, 'usermention', token);\n      return;\n    }\n\n    if (isAddrMention(token)) {\n      lastSignificantContent = 'comunity';\n      updateContent(content, 'comunity', token);\n      return;\n    }\n\n    if (isTagMention(token)) {\n      lastSignificantContent = 'tagmention';\n      updateContent(content, 'tagmention', token);\n      return;\n    }\n\n    if (isHashtag(token)) {\n      lastSignificantContent = 'hashtag';\n      updateContent(content, 'hashtag', token);\n      return;\n    }\n\n    if (isCustomEmoji(token)) {\n      lastSignificantContent = 'emoji';\n      updateContent(content, 'emoji', token);\n      return;\n    }\n\n    if (isUnitifedLnAddress(token)) {\n      lastSignificantContent = 'lnbc';\n\n      const match = token.match(lnUnifiedRegex);\n\n      let lnbcToken = match?.find(m => m.startsWith('lnbc'));\n\n      if (lnbcToken) {\n        removeLinebreaks('lnbc');\n        updateContent(content, 'lnbc', lnbcToken);\n      }\n      else {\n        updateContent(content, 'text', token);\n      }\n\n      return;\n    }\n\n    if (isLnbc(token)) {\n      lastSignificantContent = 'lnbc';\n\n      removeLinebreaks('lnbc');\n      updateContent(content, 'lnbc', token);\n      return;\n    }\n\n    lastSignificantContent = 'text';\n    updateContent(content, 'text', token);\n    return;\n  };\n\n  const generateContent = () => {\n\n    parseContent();\n\n    for (let i=0; i<tokens.length; i++) {\n      const token = tokens[i];\n\n      parseToken(token);\n    }\n\n    // Check if the last media is the last meaningfull content in the note\n    // And if so, make it the actual last content\n    // @ts-ignore\n    const lastMediaIndex = content.findLastIndex(c => c.type !== 'text');\n\n    const lastContent = content[content.length - 1];\n\n    if (lastMediaIndex === content.length - 2 && lastContent.type === 'text' && lastContent.tokens.every(t => [' ', ''].includes(t))) {\n      setContent((cont) => cont.slice(0, cont.length - 1));\n    }\n  };\n\n  const renderLinebreak = (item: NoteContent) => {\n    if (isNoteTooLong()) return;\n\n    let tokens = item.meta?.removedBy === 'link' && totalLinks > 1 ?\n      (item.meta?.removedTokens || []) :\n      item.tokens;\n\n    // Allow max consecutive linebreak\n    const len = Math.min(2, tokens.length);\n\n    const lineBreaks = Array(len).fill(<br/>)\n\n    return <For each={lineBreaks}>{_ => <br/>}</For>\n  };\n\n  const renderText = (item: NoteContent) => {\n    let tokens = [];\n\n    for (let i=0;i<item.tokens.length;i++) {\n      const token = item.tokens[i];\n\n      if (isNoteTooLong()) break;\n      if (token.trim().length > 0) {\n        setWordsDisplayed(w => w + 1);\n      }\n      tokens.push(token)\n    }\n\n    const text = tokens.join(' ').replaceAll('&lt;', '<').replaceAll('&gt;', '>');\n\n    return <>{text}</>;\n  };\n\n  const renderImage = (item: NoteContent, index?: number) => {\n\n    const groupCount = item.tokens.length;\n    const imageGroup = generatePrivateKey();\n\n    const imageError = (event: any) => {\n      // const image = event.target;\n\n      // image.style = '';\n      // image.width = 100;\n      // image.height = 100;\n\n      return true;\n    }\n\n    // Remove bottom margin if media is the last thing in the note\n    const lastClass = index === content.length-1 ?\n      'noBottomMargin' : '';\n\n    if (groupCount === 1) {\n      if (isNoteTooLong()) return;\n\n      const token = item.tokens[0];\n      let image = media?.actions.getMedia(token, 'o');\n      const url = image?.media_url || getMediaUrlDefault(token) || token;\n\n      let imageThumb =\n        media?.actions.getMedia(token, 'm') ||\n        media?.actions.getMedia(token, 'o') ||\n        token;\n\n      // Images tell a 100 words :)\n      setWordsDisplayed(w => w + 100);\n\n      return <NoteImage\n        class={`noteimage image_${props.note.noteId} ${lastClass}`}\n        src={url}\n        isDev={dev}\n        media={image}\n        mediaThumb={imageThumb}\n        width={noteWidth()}\n        imageGroup={`${imageGroup}`}\n        shortHeight={props.shorten}\n        onError={imageError}\n      />\n    }\n\n    const gridClass = groupCount < groupGridLimit ? `grid-${groupCount}` : 'grid-large';\n\n    if (isNoteTooLong()) return <></>;\n\n    setWordsDisplayed(w => w + 100);\n\n    return <div\n      class={`imageGrid ${gridClass}`}\n      style={`max-width: ${noteWidth() - (props.margins || 20)}px`}\n    >\n      <For each={item.tokens}>\n        {(token, index) => {\n\n          let image = media?.actions.getMedia(token, 'o');\n          const url = image?.media_url || getMediaUrlDefault(token) || token;\n\n          let imageThumb =\n            media?.actions.getMedia(token, 'm') ||\n            media?.actions.getMedia(token, 'o') ||\n            token;\n\n          if (props.shorten && index() > 11) {\n            return <></>;\n          }\n\n          return <NoteImage\n            class={`noteimage_gallery image_${props.note.noteId} cell_${index()+1}`}\n            src={url}\n            isDev={dev}\n            media={image}\n            width={514}\n            mediaThumb={imageThumb}\n            imageGroup={`${imageGroup}`}\n            shortHeight={props.shorten}\n            plainBorder={true}\n            forceHeight={500}\n            onError={imageError}\n          />\n        }}\n      </For>\n    </div>\n  }\n\n  const renderVideo = (item: NoteContent, index?: number) => {\n    // Remove bottom margin if media is the last thing in the note\n    const lastClass = index === content.length-1 ?\n      'noBottomMargin' : '';\n\n    return <For each={item.tokens}>{\n      (token) => {\n        if (isNoteTooLong()) return;\n\n        let mVideo = media?.actions.getMedia(token, 'o');\n\n        let h: number | undefined = undefined;\n        let w: number | undefined = undefined;\n\n        let ratio = 1;\n        const margins = props.margins || 20;\n\n        if (mVideo) {\n          ratio = mVideo.w / mVideo.h;\n\n          if (ratio < 1) {\n            h = 680;\n            w = Math.min((noteWidth() - margins), h * ratio);\n            h = w / ratio;\n          } else {\n            w = (noteWidth() - margins);\n            h = w / ratio;\n          }\n        }\n\n        let klass = mVideo ? 'w-cen' : 'w-max';\n\n        if (dev && !mVideo) {\n          klass += ' redBorder';\n        }\n\n        klass += ' embeddedContent';\n        klass += ` ${lastClass}`;\n\n        setWordsDisplayed(w => w + shortMentionInWords);\n\n        const video = <video\n          class={klass}\n          width={w}\n          height={h}\n          controls\n          muted={true}\n          loop={true}\n          playsinline={true}\n          data-ratio={`${ratio}`}\n        >\n          <source src={token} type={item.meta?.videoType} />\n        </video>;\n\n        media?.actions.addVideo(video as HTMLVideoElement);\n\n        return video;\n      }\n    }</For>;\n  }\n\n  const renderYouTube = (item: NoteContent, index?: number) => {\n    // Remove bottom margin if media is the last thing in the note\n    const lastClass = index === content.length-1 ?\n      'noBottomMargin' : '';\n\n    return <For each={item.tokens}>\n      {(token) => {\n        if (isNoteTooLong()) return;\n\n        setWordsDisplayed(w => w + shortMentionInWords);\n\n        const youtubeId = isYouTube(token) && RegExp.$1;\n\n        return <iframe\n          class={`w-max embeddedContent ${lastClass}`}\n          src={`https://www.youtube.com/embed/${youtubeId}`}\n          title=\"YouTube video player\"\n          // @ts-ignore no property\n          key={youtubeId}\n          frameBorder=\"0\"\n          allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\"\n          allowFullScreen\n        ></iframe>;\n      }}\n    </For>\n  };\n\n  const renderSpotify = (item: NoteContent, index?: number) => {\n    // Remove bottom margin if media is the last thing in the note\n    const lastClass = index === content.length-1 ?\n      'noBottomMargin' : '';\n\n    return <For each={item.tokens}>\n      {(token) => {\n        if (isNoteTooLong()) return;\n\n        setWordsDisplayed(w => w + shortMentionInWords);\n\n        const convertedUrl = token.replace(/\\/(track|album|playlist|episode)\\/([a-zA-Z0-9]+)/, \"/embed/$1/$2\");\n\n        return <iframe\n          class={`embeddedContent ${lastClass}`}\n          style=\"borderRadius: 12\"\n          src={convertedUrl}\n          width=\"100%\"\n          height=\"352\"\n          // @ts-ignore no property\n          frameBorder=\"0\"\n          allow=\"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture\"\n          loading=\"lazy\"\n        ></iframe>;\n      }}\n    </For>\n  };\n\n  const renderTwitch = (item: NoteContent, index?: number) => {\n    // Remove bottom margin if media is the last thing in the note\n    const lastClass = index === content.length-1 ?\n      'noBottomMargin' : '';\n\n    return <For each={item.tokens}>\n      {(token) => {\n        if (isNoteTooLong()) return;\n\n        setWordsDisplayed(w => w + shortMentionInWords);\n\n        const channel = token.split(\"/\").slice(-1);\n\n        const args = `?channel=${channel}&parent=${window.location.hostname}&muted=true`;\n\n        return <iframe\n          class={`embeddedContent ${lastClass}`}\n          src={`https://player.twitch.tv/${args}`}\n          // @ts-ignore no property\n          className=\"w-max\"\n          allowFullScreen\n        ></iframe>;\n      }}\n    </For>\n  };\n\n  const renderMixCloud = (item: NoteContent, index?: number) => {\n    // Remove bottom margin if media is the last thing in the note\n    const lastClass = index === content.length-1 ?\n      'noBottomMargin' : '';\n\n    return <For each={item.tokens}>\n      {(token) => {\n        if (isNoteTooLong()) return;\n\n        setWordsDisplayed(w => w + shortMentionInWords);\n\n        const feedPath = (isMixCloud(token) && RegExp.$1) + \"%2F\" + (isMixCloud(token) && RegExp.$2);\n\n        return <div class={`embeddedContent ${lastClass}`}>\n          <iframe\n            title=\"SoundCloud player\"\n            width=\"100%\"\n            height=\"120\"\n            // @ts-ignore no property\n            frameBorder=\"0\"\n            src={`https://www.mixcloud.com/widget/iframe/?hide_cover=1&feed=%2F${feedPath}%2F`}\n          ></iframe>\n        </div>;\n      }}\n    </For>\n  };\n\n  const renderSoundCloud = (item: NoteContent, index?: number) => {\n    // Remove bottom margin if media is the last thing in the note\n    const lastClass = index === content.length-1 ?\n      'noBottomMargin' : '';\n\n    return <For each={item.tokens}>\n      {(token) => {\n        if (isNoteTooLong()) return;\n\n        setWordsDisplayed(w => w + shortMentionInWords);\n\n        return <iframe\n          class={`embeddedContent ${lastClass}`}\n          width=\"100%\"\n          height=\"166\"\n          // @ts-ignore no property\n          scrolling=\"no\"\n          allow=\"autoplay\"\n          src={`https://w.soundcloud.com/player/?url=${token}`}\n        ></iframe>;\n      }}\n    </For>\n  };\n\n  const renderAppleMusic = (item: NoteContent, index?: number) => {\n    // Remove bottom margin if media is the last thing in the note\n    const lastClass = index === content.length-1 ?\n      'noBottomMargin' : '';\n\n    return <For each={item.tokens}>\n      {(token) => {\n        if (isNoteTooLong()) return;\n\n        setWordsDisplayed(w => w + shortMentionInWords);\n\n        const convertedUrl = token.replace(\"music.apple.com\", \"embed.music.apple.com\");\n        const isSongLink = /\\?i=\\d+$/.test(convertedUrl);\n\n        return <iframe\n          class={`embeddedContent ${lastClass}`}\n          allow=\"autoplay *; encrypted-media *; fullscreen *; clipboard-write\"\n          // @ts-ignore no property\n          frameBorder=\"0\"\n          height={`${isSongLink ? 175 : 450}`}\n          style=\"width: 100%; maxWidth: 660; overflow: hidden; background: transparent;\"\n          sandbox=\"allow-forms allow-popups allow-same-origin allow-scripts allow-storage-access-by-user-activation allow-top-navigation-by-user-activation\"\n          src={convertedUrl}\n        ></iframe>;\n      }}\n    </For>\n  };\n\n  const renderWavelake = (item: NoteContent, index?: number) => {\n    // Remove bottom margin if media is the last thing in the note\n    const lastClass = index === content.length-1 ?\n      'noBottomMargin' : '';\n\n    return <For each={item.tokens}>\n      {(token) => {\n        if (isNoteTooLong()) return;\n\n        setWordsDisplayed(w => w + shortMentionInWords);\n\n        const convertedUrl = token.replace(/(?:player\\.|www\\.)?wavlake\\.com/, \"embed.wavlake.com\");\n\n        return <iframe\n          class={`embeddedContent ${lastClass}`}\n          style=\"borderRadius: 12\"\n          src={convertedUrl}\n          width=\"100%\"\n          height=\"380\"\n          // @ts-ignore no property\n          frameBorder=\"0\"\n          loading=\"lazy\"\n        ></iframe>;\n      }}\n    </For>\n  };\n\n  const renderLinks = (item: NoteContent, index?: number) => {\n    return <For each={item.tokens}>\n      {(token) => {\n        if (isNoteTooLong()) return;\n\n        if (item.meta && item.meta.preview && totalLinks < 2) {\n          setWordsDisplayed(w => w + shortMentionInWords);\n          return (\n            <LinkPreview\n              preview={item.meta.preview}\n              bordered={props.isEmbeded}\n              isLast={index === content.length-1}\n            />\n          );\n        }\n\n        setWordsDisplayed(w => w + 1);\n        return (\n          <span data-url={token}>\n            <a link href={token} target=\"_blank\" >{token}</a>\n          </span>\n        );\n      }}\n    </For>\n  };\n\n  const [unknownEvents, setUnknownEvents] = createStore<Record<string, NostrEventContent>>({});\n\n  const unknownMention = (nid: string) => {\n    setWordsDisplayed(w => w + 1);\n\n    const decoded = decodeIdentifier(nid);\n\n    const alt = () => {\n      // @ts-ignore\n      const a = ((unknownEvents[nid]?.tags || []).find(t => t[0] === 'alt') || [])[1];\n\n      return a;\n    }\n\n    if (decoded.type === 'nevent') {\n      const subId = `events_${APP_ID}`;\n      const data = decoded.data as nip19.EventPointer;\n\n      const unsub = subsTo(subId, {\n        onEvent: (_, content) => {\n          if (content.id === data.id) {\n            setUnknownEvents((evs) => ({ ...evs, [nid]: { ...content } }))\n          }\n        },\n        onEose: () => {\n          unsub();\n        }\n      })\n\n      getEvents(account?.publicKey, [nid], subId);\n\n\n      return (\n        <Show\n          when={alt()}\n          fallback={\n            <div class={styles.unknownEvent}>\n              <div class={`${styles.icon} ${styles.bang}`}></div>\n              <div class={styles.label}>Mentioned event not found</div>\n            </div>\n          }\n        >\n          <div class={styles.unknownEvent}>\n            <div class={`${styles.icon} ${styles.file}`}></div>\n            <div class={styles.label}>{alt()}</div>\n          </div>\n        </Show>\n      );\n    }\n\n    if (decoded.type === 'naddr') {\n      const subId = `p_events_${APP_ID}`;\n      const data = decoded.data as nip19.AddressPointer;\n\n      const unsub = subsTo(subId, {\n        onEvent: (_, content) => {\n          if (content.kind === data.kind) {\n            setUnknownEvents((evs) => ({ ...evs, [nid]: { ...content } }))\n          }\n        },\n        onEose: () => {\n          unsub();\n        }\n      })\n\n      getParametrizedEvent(data.pubkey, data.identifier, data.kind, subId);\n\n      return (\n        <Show\n          when={alt()}\n          fallback={\n            <div class={styles.unknownEvent}>\n              <div class={`${styles.icon} ${styles.bang}`}></div>\n              <div class={styles.label}>Mentioned event not found</div>\n            </div>\n          }\n        >\n          <div class={styles.unknownEvent}>\n            <div class={`${styles.icon} ${styles.file}`}></div>\n            <div class={styles.label}>{alt()}</div>\n          </div>\n        </Show>\n      )\n    }\n\n    return (\n      <div class={styles.unknownEvent}>\n        <div class={`${styles.icon} ${styles.bang}`}></div>\n        <div class={styles.label}>Mentioned event not found</div>\n      </div>\n    );\n  }\n\n  const renderComunityMention = (item: NoteContent, index?: number) => {\n\n    return <For each={item.tokens}>\n      {(token) => {\n        if (isNoteTooLong()) return;\n\n        let [_, id] = token.split(':');\n\n        if (!id) {\n          return <>{token}</>;\n        }\n\n        let end = '';\n\n        let match = specialCharsRegex.exec(id);\n\n        if (match) {\n          const i = match.index;\n          end = id.slice(i);\n          id = id.slice(0, i);\n        }\n\n        const rn = rootNote();\n        const decoded = decodeIdentifier(id);\n\n        if (decoded.type !== 'naddr') {\n          return unknownMention(id);\n        }\n\n        const data = decoded.data as nip19.AddressPointer;\n\n        const reEncoded = nip19.naddrEncode({\n          kind: data.kind,\n          pubkey: data.pubkey,\n          identifier: data.identifier || '',\n        });\n\n        if (data.kind === Kind.LongForm) {\n          const mentionedArticles = rn.mentionedArticles;\n\n          if (!mentionedArticles || (props.embedLevel || 0) > 1) {\n            return unknownMention(reEncoded);\n          }\n\n          const mention = mentionedArticles[reEncoded];\n\n          if (!mention) {\n            return unknownMention(id);\n          }\n\n          return renderLongFormMention(mention, index);\n        }\n\n        return unknownMention(id);\n      }}\n    </For>\n  }\n\n  const renderLongFormMention = (mention: PrimalArticle | undefined, index?: number) => {\n\n    if(!mention) return <></>;\n\n    return (\n      <div class={styles.articlePreview}>\n        <ArticleCompactPreview\n          article={mention}\n          hideFooter={true}\n          hideContext={true}\n          boredered={(props.embedLevel || 0) > 0}\n        />\n      </div>);\n  };\n\n  const renderNoteMention = (item: NoteContent, index?: number) => {\n\n    return <For each={item.tokens}>\n      {(token) => {\n        if (isNoteTooLong()) return;\n\n        let [_, id] = token.split(':');\n\n        if (!id) {\n          return unknownMention(id);\n        }\n\n        let end = '';\n\n        let match = specialCharsRegex.exec(id);\n\n        if (match) {\n          const i = match.index;\n          end = id.slice(i);\n          id = id.slice(0, i);\n        }\n\n        let link = unknownMention(id);\n\n        try {\n          const eventId = nip19.decode(id).data as string | nip19.EventPointer;\n\n          let kind = typeof eventId === 'string' ? Kind.Text : eventId.kind;\n          const hex = typeof eventId === 'string' ? eventId : eventId.id;\n\n          if (props.noLinks === 'links' || (props.embedLevel || 0) > 1) {\n            return <span class='linkish'>{token}</span>;\n          }\n\n          const rn = rootNote();\n\n          const mentionedNotes = {\n            ...(rn.mentionedNotes || {}),\n            ...(props.note.mentionedNotes || {}),\n          }\n\n          const mentionedArticles = {\n            ...(rn.mentionedArticles || {}),\n            ...(props.note.mentionedArticles || {}),\n          }\n\n          const mentionedHighlights = {\n            ...(rn.mentionedHighlights || {}),\n            ...(props.note.mentionedHighlights || {}),\n          }\n\n          const mentionedUsers = {\n            ...(rn.mentionedUsers || {}),\n            ...(props.note.mentionedUsers || {}),\n          }\n\n          if (kind === undefined) {\n            let f: any = mentionedNotes && mentionedNotes[hex];\n            if (!f) {\n              const reEncoded = nip19.naddrEncode({\n                // @ts-ignore\n                kind: eventId.kind,\n                // @ts-ignore\n                pubkey: eventId.pubkey,\n                // @ts-ignore\n                identifier: eventId.identifier || '',\n              });\n              f = mentionedArticles && mentionedArticles[reEncoded];\n            }\n            if (!f) {\n              f = mentionedHighlights && mentionedHighlights[hex];\n            }\n            kind = f?.post.kind || f?.msg?.kind || f.event.kind; // || Kind.Text;\n          }\n\n          if ([Kind.Text].includes(kind || -1)) {\n            if (!props.noLinks) {\n              const ment = mentionedNotes && mentionedNotes[hex];\n\n              link = unknownMention(id);\n\n              if (ment) {\n                setWordsDisplayed(w => w + shortMentionInWords);\n\n                if ([Kind.LongForm, Kind.LongFormShell].includes(ment.post.kind)) {\n                  // @ts-ignore\n                  link = renderLongFormMention(ment, index)\n                }\n                else {\n                  link = <div>\n                    <EmbeddedNote\n                      note={ment}\n                      mentionedUsers={mentionedUsers || {}}\n                      isLast={index === content.length-1}\n                      alternativeBackground={props.altEmbeds}\n                      footerSize={props.footerSize}\n                      hideFooter={true}\n                      embedLevel={props.embedLevel}\n                      rootNote={rn}\n                    />\n                  </div>;\n                }\n              }\n            }\n          }\n\n          if ([Kind.LongForm, Kind.LongFormShell].includes(kind || -1)) {\n\n            if (!props.noLinks) {\n              const reEncoded = nip19.naddrEncode({\n                // @ts-ignore\n                kind: eventId.kind,\n                // @ts-ignore\n                pubkey: eventId.pubkey,\n                // @ts-ignore\n                identifier: eventId.identifier || '',\n              });\n              const ment = mentionedArticles && mentionedArticles[reEncoded];\n\n              link = unknownMention(id);\n\n              if (ment) {\n                setWordsDisplayed(w => w + shortMentionInWords);\n\n                // @ts-ignore\n                link = renderLongFormMention(ment, index);\n              }\n            }\n          }\n\n          if (kind === Kind.Highlight) {\n            const ment = mentionedHighlights && mentionedHighlights[hex];\n\n            link = <div class={styles.mentionedHighlight}>\n              {ment?.event?.content}\n            </div>;\n          }\n\n          if (kind === Kind.Zap) {\n            const zapContent = app?.events[Kind.Zap].find(e => e.id === hex) as NostrUserZaps | undefined;\n\n            if (zapContent) {\n              const zapEvent = JSON.parse((zapContent.tags.find(t => t[0] === 'description') || [])[1] || '{}');\n              const bolt11 = (zapContent.tags.find(t => t[0] === 'bolt11') || [])[1];\n\n              let zappedId = '';\n              let zappedKind: number = 0;\n\n              const zapTagA = zapEvent.tags.find((t: string[]) => t[0] === 'a');\n              const zapTagE = zapEvent.tags.find((t: string[]) => t[0] === 'e');\n\n              let zapSubject: PrimalArticle | PrimalUser | PrimalNote = mentionedUsers[zapEvent.tags.find((t: string[]) => t[0] === 'p')[1]];\n\n              if (zapTagA) {\n                const [kind, pubkey, identifier] = zapTagA[1].split(':');\n\n                zappedId = nip19.naddrEncode({ kind, pubkey, identifier });\n\n                const article = mentionedArticles[zappedId];\n\n                if (article) {\n                  zappedKind = Kind.LongForm;\n                  zapSubject = article;\n                } else {\n                  zappedKind = Kind.Metadata;\n                }\n              }\n              else if (zapTagE) {\n                zappedId = zapTagE[1];\n\n                const article = mentionedArticles[zappedId];\n                const note = mentionedNotes[zappedId];\n\n                if (article) {\n                  zappedKind = Kind.LongForm;\n                  zapSubject = article;\n                } else if (note) {\n                  zappedKind = Kind.Text;\n                  zapSubject = note;\n                } else {\n                  zappedKind = Kind.Metadata;\n                }\n              }\n\n              const zap: PrimalZap = {\n                id: zapContent.id || '',\n                message: zapEvent.content || '',\n                amount: parseBolt11(bolt11) || 0,\n                sender: mentionedUsers[zapEvent.pubkey],\n                reciver: mentionedUsers[zapEvent.tags.find((t: string[]) => t[0] === 'p')[1]],\n                created_at: zapContent.created_at,\n                zappedId,\n                zappedKind,\n              };\n\n              link = <ProfileNoteZap zap={zap} subject={zapSubject} />\n            }\n\n          }\n\n        } catch (e) {\n          logError('ERROR rendering note mention', e);\n          setWordsDisplayed(w => w + 1);\n          link = unknownMention(id);\n        }\n\n        return link;\n      }}\n    </For>\n  };\n\n  const renderUserMention = (item: NoteContent) => {\n    return <For each={item.tokens}>\n      {(token) => {\n        if (isNoteTooLong()) return;\n\n        setWordsDisplayed(w => w + 1);\n\n        let [nostr, id] = token.split(':');\n\n        if (!id) {\n          return <>{token}</>;\n        }\n\n        let prefix = '';\n\n        if (nostr !== 'nostr') {\n          prefix = nostr.split('nostr')[0] || '';\n        }\n\n        let end = '';\n\n        let match = specialCharsRegex.exec(id);\n\n        if (match) {\n          const i = match.index;\n          end = id.slice(i);\n          id = id.slice(0, i);\n        }\n\n        const rn = rootNote();\n\n        const mentionedUsers = {\n          ...(rn.mentionedUsers || {}),\n          ...(props.note.mentionedUsers || {}),\n        }\n\n        try {\n          const profileId = nip19.decode(id).data as string | nip19.ProfilePointer;\n\n          const hex = typeof profileId === 'string' ? profileId : profileId.pubkey;\n          const npub = hexToNpub(hex);\n\n          const path = app?.actions.profileLink(npub) || '';\n\n          let user = mentionedUsers && mentionedUsers[hex];\n\n          const label = user ? userName(user) : truncateNpub(npub);\n\n          let link = <span>{prefix}@{label}{end}</span>;\n\n          if (props.noLinks === 'links') {\n            link = <>{prefix}<span class='linkish'>@{label}</span>{end}</>;\n          }\n\n          if (!props.noLinks) {\n            link = !user ?\n              <>{prefix}<A href={path}>@{label}</A>{end}</> :\n              <>{prefix}{MentionedUserLink({ user })}{end}</>;\n          }\n          return link;\n        } catch (e) {\n          return <>{prefix}<span class={styles.error}>{token}</span></>;\n        }\n      }}\n    </For>\n  };\n\n  const renderTagMention = (item: NoteContent, index?: number) => {\n    return <For each={item.tokens}>\n      {(token) => {\n        if (isNoteTooLong()) return;\n\n        setWordsDisplayed(w => w + 1);\n\n        let t = `${token}`;\n\n        let end = t[t.length - 1];\n\n        if ([',', '?', ';', '!'].some(x => end === x)) {\n          t = t.slice(0, -1);\n        } else {\n          end = '';\n        }\n\n        let r = parseInt(t.slice(2, t.length - 1));\n\n        const tag = props.note.msg.tags[r];\n\n        if (tag === undefined || tag.length === 0) return;\n\n\n        const rn = rootNote();\n\n        const mentionedNotes = {\n          ...(rn.mentionedNotes || {}),\n          ...(props.note.mentionedNotes || {}),\n        }\n\n        const mentionedArticles = {\n          ...(rn.mentionedArticles || {}),\n          ...(props.note.mentionedArticles || {}),\n        }\n\n        const mentionedHighlights = {\n          ...(rn.mentionedHighlights || {}),\n          ...(props.note.mentionedHighlights || {}),\n        }\n\n        const mentionedUsers = {\n          ...(rn.mentionedUsers || {}),\n          ...(props.note.mentionedUsers || {}),\n        }\n\n        if (\n          tag[0] === 'e' &&\n          mentionedNotes &&\n          mentionedNotes[tag[1]]\n        ) {\n          const hex = tag[1];\n          const noteId = `nostr:${nip19.noteEncode(hex)}`;\n          const path = `/e/${nip19.noteEncode(hex)}`;\n\n          let embeded = <span>{noteId}{end}</span>;\n\n          if (props.noLinks === 'links') {\n            embeded = <><span class='linkish'>@{noteId}</span>{end}</>;\n          }\n\n          if (!props.noLinks) {\n            const ment = mentionedNotes[hex];\n\n            embeded = <><A href={path}>{noteId}</A>{end}</>;\n\n            if (ment) {\n              setWordsDisplayed(w => w + shortMentionInWords - 1);\n\n              embeded = <div>\n                <EmbeddedNote\n                  note={ment}\n                  mentionedUsers={mentionedUsers}\n                  hideFooter={true}\n                  embedLevel={props.embedLevel}\n                />\n                {end}\n              </div>;\n            }\n          }\n\n          return <span class=\"whole\"> {embeded}</span>;\n        }\n\n        if (\n          tag[0] === 'a' &&\n          mentionedArticles &&\n          mentionedArticles[tag[1]]\n        ) {\n\n          const [kind, pubkey, identifier] = tag[1].split(':');\n          const naddr = nip19.naddrEncode({ kind: parseInt(kind), pubkey, identifier });\n          const noteId = `nostr:${naddr}`;\n          let path = `/e/${naddr}`;\n\n          const vanityName = app?.verifiedUsers[pubkey];\n\n          if (vanityName) {\n            path = `/${vanityName}/${identifier}`;\n          }\n\n          let embeded = <span>{noteId}{end}</span>;\n\n          if (props.noLinks === 'links') {\n            embeded = <><span class='linkish'>{noteId}</span>{end}</>;\n          }\n\n          if (!props.noLinks) {\n            const ment = mentionedArticles[naddr];\n\n            embeded = <><A href={path}>{noteId}</A>{end}</>;\n\n            if (ment) {\n              setWordsDisplayed(w => w + shortMentionInWords - 1);\n\n              embeded = <div>\n                {renderLongFormMention(ment, index)}\n                {end}\n              </div>;\n            }\n          }\n\n          return <span class=\"whole\"> {embeded}</span>;\n        }\n\n        if (tag[0] === 'p' && mentionedUsers && mentionedUsers[tag[1]]) {\n          const user = mentionedUsers[tag[1]];\n\n          const path = app?.actions.profileLink(user.npub) || '';\n\n          const label = userName(user);\n\n          let link = <span>@{label}{end}</span>;\n\n          if (props.noLinks === 'links') {\n            link = <><span class='linkish'>@{label}</span>{end}</>;\n          }\n\n          if (!props.noLinks) {\n            link = user ?\n              <><A href={path}>@{label}</A>{end}</> :\n              <>{MentionedUserLink({ user })}{end}</>;\n          }\n          return <span> {link}</span>;\n        }\n      }}\n    </For>\n  };\n\n  const renderHashtag = (item: NoteContent) => {\n    return <For each={item.tokens}>\n      {(token) => {\n        if (isNoteTooLong()) return;\n\n        setWordsDisplayed(w => w + 1);\n\n        let [_, term] = token.split('#');\n        let end = '';\n\n        let match = hashtagCharsRegex.exec(term);\n\n        if (match) {\n          const i = match.index;\n          end = term.slice(i);\n          term = term.slice(0, i);\n        }\n\n        const embeded = props.noLinks === 'text' ?\n          <span>#{term}</span> :\n          <A href={`/search/%23${term}`}>#{term}</A>;\n\n        return <span class=\"whole\"> {embeded}{end}</span>;\n      }}\n    </For>\n  };\n\n  const renderEmoji = (item: NoteContent) => {\n    return <For each={item.tokens}>\n      {(token) => {\n        if (isNoteTooLong()) return;\n\n        setWordsDisplayed(w => w + 1);\n\n        const emoji = token.split(':')[1];\n\n        const tag = props.note.msg.tags.find(t => t[0] === 'emoji' && t[1] === emoji);\n\n        if (tag === undefined || tag.length === 0) return <>{token}</>;\n\n        const image = tag[2];\n\n        return image ?\n          <span><img height={15} width={15} src={image} alt={`emoji: ${emoji}`} /></span> :\n          <>{token}</>;\n      }}\n    </For>\n  };\n\n  const renderLnbc = (item: NoteContent) => {\n    return <For each={item.tokens}>\n      {(token) => {\n        if (isNoteTooLong()) return;\n\n        setWordsDisplayed(w => w + 100);\n\n        return <Lnbc lnbc={token} />\n      }}\n    </For>\n  }\n\n  const renderContent = (item: NoteContent, index: number) => {\n\n\n    const renderers: Record<string, (item: NoteContent, index?: number) => JSXElement> = {\n      linebreak: renderLinebreak,\n      text: renderText,\n      image: renderImage,\n      video: renderVideo,\n      youtube: renderYouTube,\n      spotify: renderSpotify,\n      twitch: renderTwitch,\n      mixcloud: renderMixCloud,\n      soundcloud: renderSoundCloud,\n      applemusic: renderAppleMusic,\n      wavelake: renderWavelake,\n      link: renderLinks,\n      notemention: renderNoteMention,\n      usermention: renderUserMention,\n      comunity: renderComunityMention,\n      tagmention: renderTagMention,\n      hashtag: renderHashtag,\n      emoji: renderEmoji,\n      lnbc: renderLnbc,\n    }\n\n    return renderers[item.type] ?\n      renderers[item.type](item, index) :\n      <></>;\n  };\n\n  onMount(() => {\n    generateContent();\n  });\n\n  return (\n    <div ref={thisNote} id={id()} class={`${styles.parsedNote} ${props.veryShort ? styles.shortNote : ''}`} >\n      <For each={content}>\n        {(item, index) => renderContent(item, index())}\n      </For>\n      <Show when={isNoteTooLong() || noteContent().length < (props.note.content?.length || 0)}>\n        <span class={styles.more}>\n          ... <span class=\"linkish\">{intl.formatMessage(actions.seeMore)}</span>\n        </span>\n      </Show>\n    </div>\n  );\n};\n\nexport default hookForDev(ParsedNote);\n"],"file":"assets/ParsedNote-9900e3c8.js"}