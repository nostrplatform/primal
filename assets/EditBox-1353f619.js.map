{"version":3,"file":"EditBox-1353f619.js","sources":["../../src/components/EmojiPickModal/EmojiPickPopover.tsx","../../src/components/ConfirmModal/ConfirmAlternativeModal.tsx","../../src/components/ArticlePreview/SimpleArticlePreview.tsx","../../src/components/ArticleHighlight/ArticleHighlight.tsx","../../src/components/NewNote/EditBox/EditBox.tsx"],"sourcesContent":["import { Component, createEffect, createSignal, onCleanup, onMount } from 'solid-js';\n\nimport styles from './EmojiPickPopover.module.scss';\nimport { EmojiOption } from '../../types/primal';\nimport EmojiPicker from '../EmojiPicker/EmojiPicker';\nimport EmojiPickHeader from './EmojiPickHeader';\nimport { useAccountContext } from '../../contexts/AccountContext';\n\nconst defaultTerm = 'face';\n\nconst EmojiPickPopover: Component<{\n  id?: string,\n  onClose: (e: MouseEvent | KeyboardEvent) => void,\n  onSelect: (emoji: EmojiOption) => void,\n  orientation?: 'up' | 'down',\n}> = (props) => {\n\n  const account = useAccountContext();\n\n  const [emojiSearchTerm, setEmojiSearchTerm] = createSignal(defaultTerm);\n  const [focusInput, setFocusInput] = createSignal(false);\n  const [showPreset, setShowPreset] = createSignal(true);\n\n  const onKey = (e: KeyboardEvent) => {\n    e.stopPropagation();\n    if (e.code === 'Escape') {\n      props.onClose(e);\n      return;\n    }\n  };\n\n  createEffect(() => {\n    if (emojiSearchTerm().length === 0) {\n      setEmojiSearchTerm(() => defaultTerm)\n    }\n  });\n\n  const setFilter = (filter: string) => {\n    if (filter === 'default') {\n      setShowPreset(true);\n      setEmojiSearchTerm(() => defaultTerm);\n    }\n    else {\n      setShowPreset(false);\n      setEmojiSearchTerm(() => filter);\n    }\n  };\n\n  const onClickOutside = (e: MouseEvent) => {\n    props.onClose(e);\n  };\n\n  const onEmojiSearch = (term: string) => {\n    setEmojiSearchTerm(() => term);\n    setShowPreset(() => term.length === 0);\n  };\n\n  onMount(() => {\n    setTimeout(() => {\n      setEmojiSearchTerm(() => defaultTerm);\n      setFocusInput(() => true);\n      setFocusInput(() => false);\n      window.addEventListener('keyup', onKey);\n      window.addEventListener('click', onClickOutside);\n    }, 10);\n  });\n\n  onCleanup(() => {\n    window.removeEventListener('keyup', onKey);\n    window.removeEventListener('click', onClickOutside);\n  });\n\n\n  return (\n    <div\n      id={props.id}\n      class={`${styles.emojiPickHolder} ${props.orientation && styles[props.orientation]}`}\n      onClick={e => e.stopPropagation()}\n    >\n      <div\n        class={styles.zapEmojiChangeModal}\n      >\n        <EmojiPickHeader\n          focus={focusInput()}\n          onInput={onEmojiSearch}\n          onFilter={setFilter}\n        />\n\n        <EmojiPicker\n          showPreset={showPreset()}\n          preset={account?.emojiHistory || []}\n          filter={emojiSearchTerm()}\n          onSelect={(emoji: EmojiOption) => {\n            props.onSelect(emoji);\n            setFocusInput(true);\n            setFocusInput(() => false);\n          }}\n          short={props.orientation === 'up'}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default EmojiPickPopover;\n","import { useIntl } from '@cookbook/solid-intl';\nimport { Component, Show } from 'solid-js';\nimport Modal from '../Modal/Modal';\n\nimport { confirmDefaults as t } from '../../translations';\n\nimport styles from './ConfirmModal.module.scss';\nimport { hookForDev } from '../../lib/devTools';\nimport ButtonPrimary from '../Buttons/ButtonPrimary';\nimport ButtonSecondary from '../Buttons/ButtonSecondary';\nimport AdvancedSearchDialog from '../AdvancedSearch/AdvancedSearchDialog';\n\nconst ConfirmAlternativeModal: Component<{\n  id?: string,\n  open?: boolean,\n  title?: string,\n  description?: string,\n  confirmLabel?: string,\n  cancelLabel?: string,\n  abortLabel?: string\n  onConfirm?: () => void,\n  onCancel?: () => void,\n  onAbort?: () => void,\n}> = (props) => {\n\n  const intl = useIntl();\n\n  return (\n    <AdvancedSearchDialog\n      open={props.open}\n      setOpen={(isOpen: boolean) => !isOpen && props.onCancel && props.onCancel()}\n      title={\n        <div class={styles.feedConfirmationTitle}>\n          {props.title || intl.formatMessage(t.title)}\n        </div>\n      }\n      triggerClass={styles.hidden}\n    >\n      <div id={props.id} class={styles.confirmAlternateModal}>\n        <div class={styles.feedConfirmationDescription}>\n          {props.description}\n        </div>\n        <div class={styles.feedConfirmationActions}>\n          <Show when={props.onConfirm}>\n            <ButtonPrimary\n              onClick={props.onConfirm}\n            >\n              {props.confirmLabel || intl.formatMessage(t.confirm)}\n            </ButtonPrimary>\n          </Show>\n\n          <Show when={props.onAbort}>\n            <ButtonSecondary\n              onClick={props.onAbort}\n              light={true}\n            >\n              {props.abortLabel || intl.formatMessage(t.abort)}\n            </ButtonSecondary>\n          </Show>\n\n          <Show when={props.onCancel}>\n            <ButtonSecondary\n              onClick={props.onCancel}\n              light={true}\n            >\n              {props.cancelLabel || intl.formatMessage(t.cancel)}\n            </ButtonSecondary>\n          </Show>\n        </div>\n      </div>\n    </AdvancedSearchDialog>\n  );\n}\n\nexport default hookForDev(ConfirmAlternativeModal);\n","import { A } from '@solidjs/router';\nimport { batch, Component, createEffect, For, JSXElement, onMount, Show } from 'solid-js';\nimport { createStore } from 'solid-js/store';\nimport { Portal } from 'solid-js/web';\nimport { wordsPerMinute } from '../../constants';\nimport { useAccountContext } from '../../contexts/AccountContext';\nimport { CustomZapInfo, useAppContext } from '../../contexts/AppContext';\nimport { useThreadContext } from '../../contexts/ThreadContext';\nimport { shortDate } from '../../lib/dates';\nimport { hookForDev } from '../../lib/devTools';\nimport { userName } from '../../stores/profile';\nimport { PrimalArticle, ZapOption } from '../../types/primal';\nimport { uuidv4 } from '../../utils';\nimport Avatar from '../Avatar/Avatar';\nimport { NoteReactionsState } from '../Note/Note';\nimport NoteContextTrigger from '../Note/NoteContextTrigger';\nimport ArticleFooter from '../Note/NoteFooter/ArticleFooter';\nimport NoteFooter from '../Note/NoteFooter/NoteFooter';\nimport NoteTopZaps from '../Note/NoteTopZaps';\nimport NoteTopZapsCompact from '../Note/NoteTopZapsCompact';\nimport VerificationCheck from '../VerificationCheck/VerificationCheck';\n\nimport styles from './ArticlePreview.module.scss';\n\nconst SimpleArticlePreview: Component<{\n  id?: string,\n  article: PrimalArticle,\n  height?: number,\n  onRender?: (article: PrimalArticle, el: HTMLAnchorElement | undefined) => void,\n}> = (props) => {\n\n  const app = useAppContext();\n  const account = useAccountContext();\n  const thread = useThreadContext();\n\n  const [reactionsState, updateReactionsState] = createStore<NoteReactionsState>({\n    likes: props.article.likes || 0,\n    liked: props.article.noteActions?.liked || false,\n    reposts: props.article.reposts || 0,\n    reposted: props.article.noteActions?.reposted || false,\n    replies: props.article.replies || 0,\n    replied: props.article.noteActions?.replied || false,\n    zapCount: props.article.zaps || 0,\n    satsZapped: props.article.satszapped || 0,\n    zapped: props.article.noteActions?.zapped || false,\n    zappedAmount: 0,\n    zappedNow: false,\n    isZapping: false,\n    showZapAnim: false,\n    hideZapIcon: false,\n    moreZapsAvailable: false,\n    isRepostMenuVisible: false,\n    topZaps: [],\n    topZapsFeed: [],\n    quoteCount: 0,\n  });\n\n  let latestTopZap: string = '';\n  let latestTopZapFeed: string = '';\n  let articleContextMenu: HTMLDivElement | undefined;\n\n  const onConfirmZap = (zapOption: ZapOption) => {\n    app?.actions.closeCustomZapModal();\n    batch(() => {\n      updateReactionsState('zappedAmount', () => zapOption.amount || 0);\n      updateReactionsState('satsZapped', (z) => z + (zapOption.amount || 0));\n      updateReactionsState('zapped', () => true);\n      updateReactionsState('showZapAnim', () => true)\n    });\n\n    addTopZap(zapOption);\n    addTopZapFeed(zapOption)\n  };\n\n  const onSuccessZap = (zapOption: ZapOption) => {\n    app?.actions.closeCustomZapModal();\n    app?.actions.resetCustomZap();\n\n    const pubkey = account?.publicKey;\n\n    if (!pubkey) return;\n\n    batch(() => {\n      updateReactionsState('zapCount', (z) => z + 1);\n      updateReactionsState('isZapping', () => false);\n      updateReactionsState('showZapAnim', () => false);\n      updateReactionsState('hideZapIcon', () => false);\n      updateReactionsState('zapped', () => true);\n    });\n  };\n\n  const onFailZap = (zapOption: ZapOption) => {\n    app?.actions.closeCustomZapModal();\n    app?.actions.resetCustomZap();\n    batch(() => {\n      updateReactionsState('zappedAmount', () => -(zapOption.amount || 0));\n      updateReactionsState('satsZapped', (z) => z - (zapOption.amount || 0));\n      updateReactionsState('isZapping', () => false);\n      updateReactionsState('showZapAnim', () => false);\n      updateReactionsState('hideZapIcon', () => false);\n      updateReactionsState('zapped', () => props.article.noteActions.zapped);\n    });\n\n    removeTopZap(zapOption);\n    removeTopZapFeed(zapOption);\n  };\n\n  const onCancelZap = (zapOption: ZapOption) => {\n    app?.actions.closeCustomZapModal();\n    app?.actions.resetCustomZap();\n    batch(() => {\n      updateReactionsState('zappedAmount', () => -(zapOption.amount || 0));\n      updateReactionsState('satsZapped', (z) => z - (zapOption.amount || 0));\n      updateReactionsState('isZapping', () => false);\n      updateReactionsState('showZapAnim', () => false);\n      updateReactionsState('hideZapIcon', () => false);\n      updateReactionsState('zapped', () => props.article.noteActions.zapped);\n    });\n\n    removeTopZap(zapOption);\n    removeTopZapFeed(zapOption);\n  };\n\n  const addTopZap = (zapOption: ZapOption) => {\n    const pubkey = account?.publicKey;\n\n    if (!pubkey) return;\n\n    const oldZaps = [ ...reactionsState.topZaps ];\n\n    latestTopZap = uuidv4() as string;\n\n    const newZap = {\n      amount: zapOption.amount || 0,\n      message: zapOption.message || '',\n      pubkey,\n      eventId: props.article.id,\n      id: latestTopZap,\n    };\n\n    if (!thread?.users.find((u) => u.pubkey === pubkey)) {\n      thread?.actions.fetchUsers([pubkey])\n    }\n\n    const zaps = [ ...oldZaps, { ...newZap }].sort((a, b) => b.amount - a.amount);\n    updateReactionsState('topZaps', () => [...zaps]);\n  };\n\n  const removeTopZap = (zapOption: ZapOption) => {\n    const zaps = reactionsState.topZaps.filter(z => z.id !== latestTopZap);\n    updateReactionsState('topZaps', () => [...zaps]);\n  };\n\n\n  const addTopZapFeed = (zapOption: ZapOption) => {\n    const pubkey = account?.publicKey;\n\n    if (!pubkey) return;\n\n    const oldZaps = [ ...reactionsState.topZapsFeed ];\n\n    latestTopZapFeed = uuidv4() as string;\n\n    const newZap = {\n      amount: zapOption.amount || 0,\n      message: zapOption.message || '',\n      pubkey,\n      eventId: props.article.id,\n      id: latestTopZapFeed,\n    };\n\n    const zaps = [ ...oldZaps, { ...newZap }].sort((a, b) => b.amount - a.amount).slice(0, 4);\n    updateReactionsState('topZapsFeed', () => [...zaps]);\n  }\n\n  const removeTopZapFeed = (zapOption: ZapOption) => {\n    const zaps = reactionsState.topZapsFeed.filter(z => z.id !== latestTopZapFeed);\n    updateReactionsState('topZapsFeed', () => [...zaps]);\n  };\n\n  const customZapInfo: () => CustomZapInfo = () => ({\n    note: props.article,\n    onConfirm: onConfirmZap,\n    onSuccess: onSuccessZap,\n    onFail: onFailZap,\n    onCancel: onCancelZap,\n  });\n\n  const openReactionModal = (openOn = 'likes') =>  {\n    app?.actions.openReactionModal(props.article.naddr, {\n      likes: reactionsState.likes,\n      zaps: reactionsState.zapCount,\n      reposts: reactionsState.reposts,\n      quotes: reactionsState.quoteCount,\n      openOn,\n    });\n  };\n\n  const onContextMenuTrigger = () => {\n    app?.actions.openContextMenu(\n      props.article,\n      articleContextMenu?.getBoundingClientRect(),\n      () => {\n        app?.actions.openCustomZapModal(customZapInfo());\n      },\n      openReactionModal,\n    );\n  }\n\n  let articlePreview: HTMLDivElement | undefined;\n\n  const onImageLoaded = () => {\n    // props.onRender && props.onRender(props.article, articlePreview);\n  };\n\n  return (\n    <div\n      ref={articlePreview}\n      class={styles.article}\n      style={props.height ? `height: ${props.height}px` : ''}\n    >\n      <div class={styles.upRightFloater}>\n        <NoteContextTrigger\n          ref={articleContextMenu}\n          onClick={onContextMenuTrigger}\n        />\n      </div>\n\n      <div class={styles.header}>\n        <div class={styles.userInfo}>\n          <Avatar user={props.article.user} size=\"micro\"/>\n          <div class={styles.userName}>{userName(props.article.user)}</div>\n          <VerificationCheck  user={props.article.user} />\n          <div class={styles.nip05}>{props.article.user?.nip05 || ''}</div>\n        </div>\n        <div class={styles.time}>\n          {shortDate(props.article.published)}\n        </div>\n      </div>\n\n      <div class={styles.body}>\n        <div class={styles.text}>\n          <div class={styles.content}>\n            <div class={styles.title}>\n              {props.article.title}\n            </div>\n            <div class={styles.summary}>\n              {props.article.summary}\n            </div>\n          </div>\n          <div class={styles.tags}>\n            <div class={styles.estimate}>\n              {Math.ceil(props.article.wordCount / wordsPerMinute)} minute read\n            </div>\n            <For each={props.article.tags?.slice(0, 3)}>\n              {tag => (\n                <div class={styles.tag}>\n                  {tag}\n                </div>\n              )}\n            </For>\n            <Show when={props.article.tags?.length && props.article.tags.length > 3}>\n              <div class={styles.tag}>\n                + {props.article.tags.length - 3}\n              </div>\n            </Show>\n          </div>\n        </div>\n        <div class={styles.image}>\n          <Show\n            when={props.article.image}\n            fallback={\n              <Show\n                when={props.article.user.picture}\n                fallback={<div class={styles.placeholderImage}></div>}\n              >\n                <img src={props.article.user.picture} onload={onImageLoaded} />\n              </Show>\n            }\n          >\n            <img src={props.article.image} onload={onImageLoaded} />\n          </Show>\n        </div>\n      </div>\n\n      {/* <Show when={props.article.topZaps?.length > 0}>\n        <div class={styles.zaps}>\n          <NoteTopZapsCompact\n            note={props.article}\n            action={() => {}}\n            topZaps={props.article.topZaps}\n            topZapLimit={4}\n          />\n        </div>\n      </Show>\n\n      <div class={styles.footer}>\n        <ArticleFooter\n          note={props.article}\n          state={reactionsState}\n          updateState={updateReactionsState}\n          customZapInfo={customZapInfo()}\n          onZapAnim={addTopZapFeed}\n        />\n      </div> */}\n\n    </div>\n  );\n}\n\nexport default hookForDev(SimpleArticlePreview);\n","import { A } from '@solidjs/router';\nimport { batch, Component, createEffect, For, JSXElement, onMount, Show } from 'solid-js';\nimport { createStore } from 'solid-js/store';\nimport { Portal } from 'solid-js/web';\nimport { useAccountContext } from '../../contexts/AccountContext';\nimport { CustomZapInfo, useAppContext } from '../../contexts/AppContext';\nimport { useThreadContext } from '../../contexts/ThreadContext';\nimport { shortDate } from '../../lib/dates';\nimport { hookForDev } from '../../lib/devTools';\nimport { userName } from '../../stores/profile';\nimport { PrimalArticle, ZapOption } from '../../types/primal';\nimport { uuidv4 } from '../../utils';\nimport Avatar from '../Avatar/Avatar';\nimport { NoteReactionsState } from '../Note/Note';\nimport NoteContextTrigger from '../Note/NoteContextTrigger';\nimport ArticleFooter from '../Note/NoteFooter/ArticleFooter';\nimport NoteFooter from '../Note/NoteFooter/NoteFooter';\nimport NoteTopZaps from '../Note/NoteTopZaps';\nimport NoteTopZapsCompact from '../Note/NoteTopZapsCompact';\nimport VerificationCheck from '../VerificationCheck/VerificationCheck';\n\nimport styles from './ArticleHighlight.module.scss';\n\nconst ArticleHighlight: Component<{\n  id?: string,\n  highlight: any,\n  onShowMenu: (id: string) => void,\n  onHideMenu: (id: string) => void,\n}> = (props) => {\n\n  const app = useAppContext();\n  const account = useAccountContext();\n  const thread = useThreadContext();\n\n  const onOver = (e: MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    // @ts-ignore\n    e.target.setAttribute('data-highlight-selected', '')\n    props.onShowMenu(props.highlight.id);\n  }\n\n  const onOut = () => {\n    props.onHideMenu(props.highlight.id);\n  }\n\n  return (\n    <em\n      data-highlight={props.highlight.id}\n      class=\"article_highlight\"\n      onClick={onOver}\n    >\n      {props.highlight.content}\n    </em>\n  );\n}\n\nexport default hookForDev(ArticleHighlight);\n","import { useIntl } from \"@cookbook/solid-intl\";\nimport { Router, useLocation } from \"@solidjs/router\";\nimport { nip19 } from \"../../../lib/nTools\";\nimport { Component, createEffect, createSignal, For, Match, onCleanup, onMount, Show, Switch } from \"solid-js\";\nimport { createStore, reconcile, unwrap } from \"solid-js/store\";\nimport { noteRegex, profileRegex, Kind, editMentionRegex, emojiSearchLimit, profileRegexG, linebreakRegex, addrRegex, addrRegexG } from \"../../../constants\";\nimport { useAccountContext } from \"../../../contexts/AccountContext\";\nimport { useSearchContext } from \"../../../contexts/SearchContext\";\nimport { TranslatorProvider } from \"../../../contexts/TranslatorContext\";\nimport { getEvents } from \"../../../lib/feed\";\nimport { parseNote1, sanitize, sendNote, replaceLinkPreviews, importEvents, getParametrizedEvent } from \"../../../lib/notes\";\nimport { getUserProfiles } from \"../../../lib/profile\";\nimport { subsTo } from \"../../../sockets\";\nimport { convertToArticles, convertToNotes, referencesToTags } from \"../../../stores/note\";\nimport { convertToUser, nip05Verification, truncateNpub, userName } from \"../../../stores/profile\";\nimport { EmojiOption, FeedPage, NostrMentionContent, NostrNoteContent, NostrStatsContent, NostrUserContent, PrimalArticle, PrimalNote, PrimalUser, SendNoteResult } from \"../../../types/primal\";\nimport { debounce, getScreenCordinates, isVisibleInContainer, uuidv4 } from \"../../../utils\";\nimport Avatar from \"../../Avatar/Avatar\";\nimport EmbeddedNote from \"../../EmbeddedNote/EmbeddedNote\";\nimport MentionedUserLink from \"../../Note/MentionedUserLink/MentionedUserLink\";\nimport SearchOption from \"../../Search/SearchOption\";\nimport { useToastContext } from \"../../Toaster/Toaster\";\nimport styles from './EditBox.module.scss';\nimport emojiSearch from '@jukben/emoji-search';\nimport { getCaretCoordinates } from \"../../../lib/textArea\";\nimport { APP_ID } from \"../../../App\";\nimport {\n  toast as tToast,\n  feedback as tFeedback,\n  note as tNote,\n  search as tSearch,\n  actions as tActions,\n  upload as tUpload,\n} from \"../../../translations\";\nimport { useMediaContext } from \"../../../contexts/MediaContext\";\nimport { hookForDev } from \"../../../lib/devTools\";\nimport ButtonPrimary from \"../../Buttons/ButtonPrimary\";\nimport ButtonSecondary from \"../../Buttons/ButtonSecondary\";\nimport { useProfileContext } from \"../../../contexts/ProfileContext\";\nimport ButtonGhost from \"../../Buttons/ButtonGhost\";\nimport EmojiPickPopover from \"../../EmojiPickModal/EmojiPickPopover\";\nimport ConfirmAlternativeModal from \"../../ConfirmModal/ConfirmAlternativeModal\";\nimport { readNoteDraft, readNoteDraftUserRefs, saveNoteDraft, saveNoteDraftUserRefs } from \"../../../lib/localStore\";\nimport Uploader from \"../../Uploader/Uploader\";\nimport { logError } from \"../../../lib/logger\";\nimport Lnbc from \"../../Lnbc/Lnbc\";\nimport { decodeIdentifier } from \"../../../lib/keys\";\nimport { useSettingsContext } from \"../../../contexts/SettingsContext\";\nimport SimpleArticlePreview from \"../../ArticlePreview/SimpleArticlePreview\";\nimport ArticleHighlight from \"../../ArticleHighlight/ArticleHighlight\";\nimport DOMPurify from \"dompurify\";\nimport { useAppContext } from \"../../../contexts/AppContext\";\n\ntype AutoSizedTextArea = HTMLTextAreaElement & { _baseScrollHeight: number };\n\n\nconst EditBox: Component<{\n  id?: string,\n  replyToNote?: PrimalNote | PrimalArticle,\n  onClose?: () => void,\n  onSuccess?: (note: SendNoteResult, meta: any) => void,\n  open?: boolean,\n  idPrefix?: string,\n  context?: string,\n} > = (props) => {\n\n  const intl = useIntl();\n  const media = useMediaContext();\n  const app = useAppContext();\n\n  const instanceId = uuidv4();\n\n  const search = useSearchContext();\n  const account = useAccountContext();\n  const toast = useToastContext();\n  const profile = useProfileContext();\n  const settings = useSettingsContext();\n\n  let textArea: HTMLTextAreaElement | undefined;\n  let textPreview: HTMLDivElement | undefined;\n  let mentionOptions: HTMLDivElement | undefined;\n  let emojiOptions: HTMLDivElement | undefined;\n  let emojiPicker: HTMLDivElement | undefined;\n  let editWrap: HTMLDivElement | undefined;\n  let fileUpload: HTMLInputElement | undefined;\n\n  let mentionCursorPosition = { top: 0, left: 0, height: 0 };\n  let emojiCursorPosition = { top: 0, left: 0, height: 0 };\n\n  const [isMentioning, setMentioning] = createSignal(false);\n  const [preQuery, setPreQuery] = createSignal('');\n  const [query, setQuery] = createSignal('');\n\n  const [message, setMessage] = createSignal('');\n  const [parsedMessage, setParsedMessage] = createSignal('');\n\n  const [isEmojiInput, setEmojiInput] = createSignal(false);\n  const [emojiQuery, setEmojiQuery] = createSignal('');\n  const [emojiResults, setEmojiResults] = createStore<EmojiOption[]>([]);\n\n  const [userRefs, setUserRefs] = createStore<Record<string, PrimalUser>>({});\n  const [noteRefs, setNoteRefs] = createStore<Record<string, PrimalNote>>({});\n  const [articleRefs, setArticleRefs] = createStore<Record<string, PrimalArticle>>({});\n  const [highlightRefs, setHighlightRefs] = createStore<Record<string, any>>({});\n\n  const [highlightedUser, setHighlightedUser] = createSignal<number>(0);\n  const [highlightedEmoji, setHighlightedEmoji] = createSignal<number>(0);\n  const [referencedNotes, setReferencedNotes] = createStore<Record<string, FeedPage>>();\n  const [referencedArticles, setReferencedArticles] = createStore<Record<string, FeedPage>>();\n\n  const [isConfirmEditorClose, setConfirmEditorClose] = createSignal(false);\n\n  const [fileToUpload, setFileToUpload] = createSignal<File | undefined>();\n\n  const [relayHints, setRelayHints] = createStore<Record<string, string>>({});\n\n  const location = useLocation();\n\n  let currentPath = location.pathname;\n\n\n  const noteHasInvoice = (text: string) => {\n    const r =/(\\s+|\\r\\n|\\r|\\n|^)lnbc[a-zA-Z0-9]+/;\n    const test = r.test(text);\n\n    return test\n  };\n\n  const noteHasCashu = (text: string) => {\n    const r =/(\\s+|\\r\\n|\\r|\\n|^)cashuA[a-zA-Z0-9]+/;\n    const test = r.test(text);\n\n    return test\n  };\n\n  const getScrollHeight = (elm: AutoSizedTextArea) => {\n    var savedValue = elm.value\n    elm.value = ''\n    elm._baseScrollHeight = elm.scrollHeight\n    elm.value = savedValue\n  }\n\n  const onExpandableTextareaInput: (event: InputEvent) => void = (event) => {\n    const maxHeight = document.documentElement.clientHeight || window.innerHeight || 0;\n\n    const elm = textArea as AutoSizedTextArea;\n    const preview = textPreview;\n\n\n    if(elm.nodeName !== 'TEXTAREA' || elm.id !== `${prefix()}new_note_text_area` || !preview) {\n      return;\n    }\n\n    const minRows = parseInt(elm.getAttribute('data-min-rows') || '0');\n\n    !elm._baseScrollHeight && getScrollHeight(elm);\n\n    if (elm.scrollHeight >= (maxHeight / 3)) {\n      elm.style.height = '46vh';\n      return;\n    }\n\n    elm.style.height = 'auto';\n\n    elm.rows = minRows;\n    const rows = Math.ceil((elm.scrollHeight - elm._baseScrollHeight) / 20);\n    elm.rows = minRows + rows;\n\n    // const rect = elm.getBoundingClientRect();\n\n\n    // preview.style.maxHeight = `${maxHeight - rect.height - 120}px`;\n  }\n\n  createEffect(() => {\n    if (emojiQuery().length > emojiSearchLimit) {\n      setEmojiResults(() => emojiSearch(emojiQuery()));\n    }\n  });\n\n\n  createEffect(() => {\n    if (isEmojiInput() && emojiQuery().length > emojiSearchLimit) {\n      emojiPositionOptions();\n    }\n  });\n\n\n  const renderMessage = () => {\n    const text = DOMPurify.sanitize(parsedMessage());\n\n    if (!noteHasInvoice(text)) {\n      return (\n        <div\n          class={styles.editor}\n          ref={textPreview}\n          innerHTML={text}\n        ></div>\n      );\n    };\n\n    let sections: string[] = [];\n\n    let content = text.replace(linebreakRegex, ' __LB__ ').replaceAll('<br>', ' __LB__ ').replace(/\\s+/g, ' __SP__ ');\n\n    let tokens: string[] = content.split(/[\\s]+/);\n\n    let sectionIndex = 0;\n\n    tokens.forEach((tok) => {\n      const t = DOMPurify.sanitize(tok);\n      if (t.startsWith('lnbc')) {\n        if (sections[sectionIndex]) sectionIndex++;\n\n        sections[sectionIndex] = t;\n\n        sectionIndex++;\n      }\n      else {\n        let c = t;\n        const prev = sections[sectionIndex] || '';\n\n        if (t === '__SP__') {\n          c = prev.length === 0 ? '' : ' ';\n        }\n\n        if (t === '__LB__') {\n          c = prev.length === 0 ? '' : ' <br/>';\n        }\n\n        sections[sectionIndex] = prev + c;\n      }\n    });\n\n    return (\n      <div\n        class={styles.editor}\n        ref={textPreview}\n      >\n        <For each={sections}>\n          {section => (\n            <Switch fallback={\n              <div\n                innerHTML={section}\n              ></div>\n            }>\n              <Match when={section.startsWith('lnbc')}>\n                <Lnbc lnbc={section} inactive={true} />\n              </Match>\n            </Switch>\n          )}\n        </For>\n      </div>\n    );\n  };\n\n  const onKeyDown = (e: KeyboardEvent) => {\n    if (!textArea) {\n      return false;\n    }\n\n    if (fileToUpload()) {\n      return;\n    }\n\n    const previousChar = textArea.value[textArea.selectionStart - 1];\n\n    const mentionSeparators = ['Enter', 'Space', 'Comma', 'Tab'];\n\n    if (e.code === 'Enter' && e.metaKey) {\n      e.preventDefault();\n      postNote();\n      return false;\n    }\n\n    if (!isMentioning() && !isEmojiInput() && e.key === ':') {\n      // Ignore if `@` is a part of a word\n      if (textArea.selectionStart > 0 && ![' ', '\\r\\n', '\\r', '\\n'].includes(textArea.value[textArea.selectionStart-1])) {\n        return false;\n      }\n\n      emojiCursorPosition = getCaretCoordinates(textArea, textArea.selectionStart);\n      setEmojiInput(true);\n      return false;\n    }\n\n    if (isEmojiInput()) {\n      if (e.code === 'ArrowDown') {\n        e.preventDefault();\n        setHighlightedEmoji(i => {\n          if (emojiResults.length === 0) {\n            return 0;\n          }\n\n          return i < emojiResults.length - 9 ? i + 8 : 0;\n        });\n\n        const emojiHolder = document.getElementById(`${instanceId}-${highlightedEmoji()}`);\n\n        if (emojiHolder && emojiOptions && !isVisibleInContainer(emojiHolder, emojiOptions)) {\n          emojiHolder.scrollIntoView({ block: 'end', behavior: 'smooth' });\n        }\n\n        return false;\n      }\n\n      if (e.code === 'ArrowUp') {\n        e.preventDefault();\n        setHighlightedEmoji(i => {\n          if (emojiResults.length === 0) {\n            return 0;\n          }\n\n          return i >= 8 ? i - 8 : emojiResults.length - 1;\n        });\n\n        const emojiHolder = document.getElementById(`${instanceId}-${highlightedEmoji()}`);\n\n        if (emojiHolder && emojiOptions && !isVisibleInContainer(emojiHolder, emojiOptions)) {\n          emojiHolder.scrollIntoView({ block: 'start', behavior: 'smooth' });\n        }\n\n        return false;\n      }\n\n      if (e.code === 'ArrowRight') {\n        e.preventDefault();\n        setHighlightedEmoji(i => {\n          if (emojiResults.length === 0) {\n            return 0;\n          }\n\n          return i < emojiResults.length - 1 ? i + 1 : 0;\n        });\n\n        const emojiHolder = document.getElementById(`${instanceId}-${highlightedEmoji()}`);\n\n        if (emojiHolder && emojiOptions && !isVisibleInContainer(emojiHolder, emojiOptions)) {\n          emojiHolder.scrollIntoView({ block: 'end', behavior: 'smooth' });\n        }\n\n        return false;\n      }\n\n      if (e.code === 'ArrowLeft') {\n        e.preventDefault();\n        setHighlightedEmoji(i => {\n          if (emojiResults.length === 0) {\n            return 0;\n          }\n\n          return i > 0 ? i - 1 : emojiResults.length - 1;\n        });\n\n        const emojiHolder = document.getElementById(`${instanceId}-${highlightedEmoji()}`);\n\n        if (emojiHolder && emojiOptions && !isVisibleInContainer(emojiHolder, emojiOptions)) {\n          emojiHolder.scrollIntoView({ block: 'start', behavior: 'smooth' });\n        }\n\n        return false;\n      }\n\n      if (mentionSeparators.includes(e.code) || e.code === 'Semicolon') {\n        if (emojiQuery().trim().length === 0) {\n          setEmojiInput(false);\n          return false;\n        }\n        e.preventDefault();\n        emojiResults.length === 0 && setEmojiResults(emojiSearch(emojiQuery()));\n        selectEmoji(emojiResults[highlightedEmoji()]);\n        setHighlightedEmoji(0);\n        return false;\n      }\n\n      const cursor = textArea.selectionStart;\n      const lastEmojiTrigger = textArea.value.slice(0, cursor).lastIndexOf(':');\n\n      if (e.code === 'Backspace') {\n        setEmojiQuery(emojiQuery().slice(0, -1));\n\n        if (lastEmojiTrigger < 0 || cursor - lastEmojiTrigger <= 1) {\n          setEmojiInput(false);\n          setEmojiQuery('');\n          return false;\n        }\n\n        return false;\n      }\n\n      if (!['Shift', 'Control', 'Meta'].includes(e.key)) {\n        setEmojiQuery(q => q + e.key);\n        return false;\n      }\n\n      return false;\n    }\n\n\n    if (!isMentioning() && e.key === '@') {\n      mentionCursorPosition = getCaretCoordinates(textArea, textArea.selectionStart);\n\n      // Ignore if `@` is a part of a word\n      if (textArea.selectionStart > 0 && ![' ', '\\r\\n', '\\r', '\\n'].includes(textArea.value[textArea.selectionStart-1])) {\n        return false;\n      }\n\n      setPreQuery('');\n      setQuery('');\n      setMentioning(true);\n      return false;\n    }\n\n    if (!isMentioning() && e.code === 'Backspace' && textArea) {\n      let cursor = textArea.selectionStart;\n      const textSoFar = textArea.value.slice(0, cursor);\n      const lastWord = textSoFar.split(/[\\s,;\\n\\r]/).pop();\n\n      if (lastWord?.startsWith('@`')) {\n        const index = textSoFar.lastIndexOf(lastWord);\n\n        const newText = textSoFar.slice(0, index) + textArea.value.slice(cursor);\n\n        setMessage(newText);\n        textArea.value = newText;\n\n        textArea.selectionEnd = index;\n      }\n    }\n\n    if (isMentioning()) {\n\n      if (e.code === 'ArrowDown') {\n        e.preventDefault();\n        setHighlightedUser(i => {\n          if (!search?.users || search.users.length === 0) {\n            return 0;\n          }\n\n          return i < search.users.length - 1 ? i + 1 : 0;\n        });\n        return false;\n      }\n\n      if (e.code === 'ArrowUp') {\n        e.preventDefault();\n        setHighlightedUser(i => {\n          if (!search?.users || search.users.length === 0) {\n            return 0;\n          }\n\n          return i > 0 ? i - 1 : search.users.length - 1;\n        });\n        return false;\n      }\n\n      if (mentionSeparators.includes(e.code)) {\n        if (preQuery() === ' ') {\n          setMentioning(false);\n          return false;\n        }\n        e.preventDefault();\n        search?.users && selectUser(search.users[highlightedUser()])\n        setMentioning(false);\n        return false;\n      }\n\n      const cursor = textArea.selectionStart;\n      const lastMentionTrigger = textArea.value.slice(0, cursor).lastIndexOf('@');\n\n      if (e.code === 'Backspace') {\n        setPreQuery(preQuery().slice(0, -1));\n\n        if (lastMentionTrigger < 0 || cursor - lastMentionTrigger <= 1) {\n          setMentioning(false);\n          return false;\n        }\n      } else if (!['Shift', 'Control', 'Meta'].includes(e.key)) {\n        setPreQuery(q => q + e.key);\n        return false\n      }\n\n      return false;\n    }\n\n    return true;\n  };\n\n  const [isDroppable, setIsDroppable] = createSignal(false);\n\n  const onDrop  = (e: DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    setIsDroppable(false);\n\n    let draggedData = e.dataTransfer;\n    let file = draggedData?.files[0];\n\n    file && isSupportedFileType(file) && setFileToUpload(file);\n\n  };\n\n  const onDragOver = (e: DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    setIsDroppable(true);\n  }\n\n  const onDragLeave = (e: DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    if (!editWrap) {\n      return;\n    }\n\n    const rect = editWrap.getBoundingClientRect();\n\n    const isWider = e.clientX < rect.x || e.clientX > rect.x + rect.width;\n    const isTaller = e.clientY < rect.y || e.clientY > rect.y + rect.height;\n\n    (isWider || isTaller) && setIsDroppable(false);\n  }\n\n  const onPaste = (e:ClipboardEvent) => {\n    if (e.clipboardData?.files && e.clipboardData.files.length > 0) {\n      e.preventDefault();\n      const file = e.clipboardData.files[0];\n\n      file && isSupportedFileType(file) && setFileToUpload(file);\n      return false;\n    }\n  }\n\n  onMount(() => {\n    // @ts-expect-error TODO: fix types here\n    editWrap?.addEventListener('input', onExpandableTextareaInput);\n    editWrap?.addEventListener('keydown', onKeyDown);\n    // editWrap?.addEventListener('drop', onDrop, false);\n  });\n\n  onCleanup(() => {\n    // @ts-expect-error TODO: fix types here\n    editWrap?.removeEventListener('input', onExpandableTextareaInput);\n    editWrap?.removeEventListener('keydown', onKeyDown);\n    // editWrap?.removeEventListener('drop', onDrop, false);\n  });\n\n  createEffect(() => {\n    editWrap?.removeEventListener('keyup', onEscape);\n\n    if (!isPickingEmoji()) {\n      editWrap?.addEventListener('keyup', onEscape);\n    }\n  });\n\n  createEffect(() => {\n    if (location.pathname !== currentPath) {\n      clearEditor();\n    }\n  })\n\n  createEffect(() => {\n    const preQ = preQuery();\n\n    debounce(() => {\n      setQuery(() => preQ)\n    }, 500);\n  })\n\n  const addQuote = (quote: string | undefined) => {\n    setMessage((msg) => {\n      if (!textArea || !quote) return msg;\n      let position = textArea.selectionStart + 2;\n\n      const isEmptyMessage = msg.length === 0;\n\n      const newMsg = isEmptyMessage ?\n        `\\r\\n\\r\\n${quote} ` :\n        msg.slice(0, position) + quote + ' ' + msg.slice(position, msg.length);\n\n\n      position = isEmptyMessage ? 0 : position + quote.length + 1;\n\n      textArea.value = newMsg;\n      account?.actions.quoteNote(undefined);\n\n      onExpandableTextareaInput(new InputEvent('input'));\n\n      textArea?.focus();\n      textArea.selectionEnd = position;\n      return newMsg;\n    });\n\n  };\n\n  createEffect(() => {\n    if (props.open) {\n      const draft = readNoteDraft(account?.publicKey, props.replyToNote?.noteId);\n      const draftUserRefs = readNoteDraftUserRefs(account?.publicKey, props.replyToNote?.noteId);\n\n      setUserRefs(reconcile(draftUserRefs));\n\n      setMessage((msg) => {\n        if (msg.length > 0) return msg;\n        const newMsg = `${msg}${draft}`;\n\n        if (textArea) {\n          textArea.value = newMsg;\n          textArea.dispatchEvent(new Event('input', { bubbles: true }));\n          textArea.focus();\n        }\n\n        return newMsg;\n      });\n\n      if (account?.quotedNote) {\n        addQuote(account.quotedNote);\n      }\n\n    } else {\n      account?.actions.quoteNote(undefined);\n    }\n  })\n\n  createEffect(() => {\n    if (message().length === 0) return;\n\n    // save draft just in case there is an unintended interuption\n    saveNoteDraft(account?.publicKey, message(), props.replyToNote?.noteId);\n    saveNoteDraftUserRefs(account?.publicKey, userRefs, props.replyToNote?.noteId);\n  });\n\n  const onEscape = (e: KeyboardEvent) => {\n    if (isConfirmEditorClose()) return;\n\n    e.stopPropagation();\n    if (e.code === 'Escape') {\n      if (isPickingEmoji()) return;\n\n      if (isMentioning() || isEmojiInput()) {\n        closeEmojiAndMentions();\n        return;\n      }\n\n      closeEditor();\n    }\n  };\n\n  const resetUpload = () => {\n    if (fileUpload) {\n      fileUpload.value = '';\n    }\n\n    setFileToUpload(undefined);\n  };\n\n  const clearEditor = () => {\n    setUserRefs({});\n    setMessage('');\n    setParsedMessage('');\n    setQuery('');\n    setMentioning(false);\n    setEmojiInput(false);\n    setEmojiQuery('')\n    setEmojiResults(() => []);\n\n    resetUpload();\n\n    props.onClose && props.onClose();\n  };\n\n  const closeEditor = () => {\n    if (message().trim().length > 0) {\n      setConfirmEditorClose(true);\n      return;\n    }\n\n    saveNoteDraft(account?.publicKey, '', props.replyToNote?.noteId);\n    saveNoteDraftUserRefs(account?.publicKey, {}, props.replyToNote?.noteId);\n    clearEditor();\n  };\n\n  const closeEmojiAndMentions = () => {\n    setMentioning(false);\n    setEmojiInput(false);\n    setEmojiQuery('')\n    setEmojiResults(() => []);\n  };\n\n  const persistNote = (note: string) => {\n    saveNoteDraft(account?.publicKey, note, props.replyToNote?.noteId);\n    saveNoteDraftUserRefs(account?.publicKey, userRefs, props.replyToNote?.noteId);\n    clearEditor();\n  };\n\n  const [isPostingInProgress, setIsPostingInProgress] = createSignal(false);\n\n  const postNote = async () => {\n    if (!account || !account.hasPublicKey() || fileToUpload()) {\n      return;\n    }\n\n    if (!account.proxyThroughPrimal && account.relays.length === 0) {\n      toast?.sendWarning(\n        intl.formatMessage(tToast.noRelaysConnected),\n      );\n      return;\n    }\n\n    const value = message();\n\n    if (value.trim() === '') {\n      return;\n    }\n\n    const messageToSend = value.replace(editMentionRegex, (url) => {\n\n      const [anythingBefore, mention] = url.split('@');\n\n      const [_, name] = mention.split('\\`');\n      const user = userRefs[name];\n\n      // @ts-ignore\n      return `${anythingBefore} nostr:${user.npub}`;\n    });\n\n    if (account) {\n      let tags = referencesToTags(messageToSend, relayHints);\n      const rep = props.replyToNote;\n\n      if (rep) {\n        let rootTag = rep.msg.tags.find(t => t[0] === 'e' && t[3] === 'root');\n\n        const rHints = (rep.relayHints && rep.relayHints[rep.id]) ?\n          rep.relayHints[rep.id] :\n          '';\n\n        // If the note has a root tag, that meens it is not a root note itself\n        // So we need to copy the `root` tag and add a `reply` tag\n        if (rootTag) {\n          const tagWithHint = rootTag.map((v, i) => i === 2 ?\n            rHints :\n            v,\n          );\n          tags.push([...tagWithHint]);\n          tags.push(['e', rep.id, rHints, 'reply']);\n        }\n        // Otherwise, add the note as the root tag for this reply\n        else {\n          tags.push([\n            'e',\n            rep.id,\n            rHints,\n            'root',\n          ]);\n        }\n\n        // Copy all `p` tags from the note we are repling to\n        const repPeople = rep.msg.tags.filter(t => t[0] === 'p');\n\n        tags = [...tags, ...(unwrap(repPeople))];\n\n        // If the author of the note is missing, add them\n        if (!tags.find(t => t[0] === 'p' && t[1] === rep.pubkey)) {\n          tags.push(['p', rep.pubkey]);\n        }\n      }\n\n      setIsPostingInProgress(true);\n\n      const { success, reasons, note } = await sendNote(messageToSend, account?.proxyThroughPrimal || false, account.activeRelays, tags, account.relaySettings);\n\n      if (success) {\n\n        const importId = `import_note_${APP_ID}`;\n\n        const unsub = subsTo(importId, {\n          onEose: () => {\n            if (note) {\n              toast?.sendSuccess(intl.formatMessage(tToast.publishNoteSuccess));\n              props.onSuccess && props.onSuccess({ success, reasons, note }, { noteRefs, userRefs, articleRefs, highlightRefs, relayHints });\n              setIsPostingInProgress(false);\n              saveNoteDraft(account.publicKey, '', rep?.noteId)\n              clearEditor();\n            }\n            unsub();\n          }\n        });\n\n        note && importEvents([note], importId);\n\n        return;\n      }\n\n      if (reasons?.includes('no_extension')) {\n        toast?.sendWarning(intl.formatMessage(tToast.noExtension));\n        setIsPostingInProgress(false);\n        return;\n      }\n\n      if (reasons?.includes('timeout')) {\n        toast?.sendWarning(intl.formatMessage(tToast.publishNoteTimeout));\n        setIsPostingInProgress(false);\n        return;\n      }\n\n      toast?.sendWarning(intl.formatMessage(tToast.publishNoteFail));\n      setIsPostingInProgress(false);\n      return;\n    }\n\n    setIsPostingInProgress(false);\n    clearEditor();\n  };\n\n  const mentionPositionOptions = () => {\n    if (!textArea || !mentionOptions || !editWrap) {\n      return;\n    }\n\n    const taRect = textArea.getBoundingClientRect();\n    const wRect = editWrap.getBoundingClientRect();\n\n    let mTop = mentionCursorPosition.top;\n\n    if (textArea.scrollTop > 0) {\n      mTop -= textArea.scrollTop;\n    }\n\n    let newTop = taRect.top - wRect.top + mTop + 22;\n    let newLeft = mentionCursorPosition.left + 16;\n\n    if (newTop > document.documentElement.clientHeight - 200) {\n      newTop = taRect.top - 400;\n    }\n\n    mentionOptions.style.top = `${newTop}px`;\n    mentionOptions.style.left = `${newLeft}px`;\n  };\n\n  const emojiPositionOptions = () => {\n    if (!textArea || !emojiOptions || !editWrap) {\n      return;\n    }\n\n    const taRect = textArea.getBoundingClientRect();\n    const wRect = editWrap.getBoundingClientRect();\n\n    let mTop = emojiCursorPosition.top;\n\n    if (textArea.scrollTop > 0) {\n      mTop -= textArea.scrollTop;\n    }\n\n    let newTop = taRect.top - wRect.top + mTop + 22;\n    let newLeft = emojiCursorPosition.left;\n\n    if (newTop > document.documentElement.clientHeight - 200) {\n      newTop = taRect.top - 400;\n    }\n\n    emojiOptions.style.top = `${newTop}px`;\n    emojiOptions.style.left = `${newLeft}px`;\n  };\n\n  const highlightHashtags = (text: string) => {\n    const regex = /(?:\\s|^)#[^\\s!@#$%^&*(),.?\":{}|<>]+/ig;\n\n    return text.replace(regex, (token) => {\n      const [space, term] = token.split('#');\n      const embeded = (\n        <span>\n          {space}\n          <span class={styles.userReference}>\n            #{term}\n          </span>\n        </span>\n      );\n\n      // @ts-ignore\n      return embeded.outerHTML;\n    });\n  }\n\n  const parseUserMentions = (text: string) => {\n    return text.replace(editMentionRegex, (url) => {\n      const [_, name] = url.split('\\`');\n      const user = Object.values(userRefs).find(ref => userName(ref) === name);\n\n      const link = user ?\n        MentionedUserLink({ user, openInNewTab: true}) :\n        <span class='linkish'> @{name}</span>;\n\n        // @ts-ignore\n      return ` ${link.outerHTML}` || ` @${name}`;\n    });\n  };\n\n\n  const subUserRef = (userId: string) => {\n\n    const parsed = parsedMessage().replace(profileRegex, (url) => {\n      const [_, id] = url.split(':');\n\n      if (!id) {\n        return url;\n      }\n\n      try {\n        // const profileId = nip19.decode(id).data as string | nip19.ProfilePointer;\n\n        // const hex = typeof profileId === 'string' ? profileId : profileId.pubkey;\n        // const npub = hexToNpub(hex);\n\n        const user = userRefs[userId];\n\n        const link = user ?\n          <a href={`${window.location.origin}${app?.actions.profileLink(user.npub) || ''}`} target=\"_blank\" class='linkish'>@{userName(user)}</a> :\n          <a href={`${window.location.origin}${app?.actions.profileLink(id) || ''}`} target=\"_blank\" class='linkish'>@{truncateNpub(id)}</a>;\n\n        // @ts-ignore\n        return link.outerHTML || url;\n      } catch (e) {\n        return `<span class=\"${styles.error}\">${url}</span>`;\n      }\n    });\n\n    setParsedMessage(parsed);\n\n  };\n\n  const [addrRefs, setAddrRef] = createStore<Record<string, any>>({});\n\n  const parseNaddr = (text: string) => {\n    let refs = [];\n    let match;\n\n    while((match = addrRegexG.exec(text)) !== null) {\n      refs.push(match[1]);\n    }\n\n    refs.forEach(id => {\n      if (articleRefs[id]) {\n        setTimeout(() => {\n          subNaddrRef(id);\n        }, 0);\n        return;\n      }\n\n      const addr = decodeIdentifier(id);\n\n      if (addr.type !== 'naddr') {\n        return;\n      }\n\n      // @ts-ignore\n      const { pubkey, kind, identifier } = addr.data;\n\n      const subId = `naddr_${id}_${APP_ID}`;\n\n      setReferencedArticles(id, { messages: [], users: {}, postStats: {}, mentions: {} })\n\n      const unsub = subsTo(subId, {\n        onEvent: (_, content) => {\n\n          if (!content) return;\n\n          if (content.kind === Kind.Metadata) {\n            const user = content as NostrUserContent;\n\n            setReferencedArticles(id, 'users', (usrs) => ({ ...usrs, [user.pubkey]: { ...user } }));\n            return;\n          }\n\n          if ([Kind.LongForm, Kind.LongFormShell].includes(content.kind)) {\n            const message = content as NostrNoteContent;\n\n            setReferencedArticles(id, 'messages',\n              (msgs) => [ ...msgs, { ...message }]\n            );\n\n            return;\n          }\n\n          if (content.kind === Kind.NoteStats) {\n            const statistic = content as NostrStatsContent;\n            const stat = JSON.parse(statistic.content);\n\n            setReferencedArticles(id, 'postStats',\n              (stats) => ({ ...stats, [stat.event_id]: { ...stat } })\n            );\n            return;\n          }\n\n          if (content.kind === Kind.Mentions) {\n            const mentionContent = content as NostrMentionContent;\n            const mention = JSON.parse(mentionContent.content);\n\n            setReferencedArticles(id, 'mentions',\n              (mentions) => ({ ...mentions, [mention.id]: { ...mention } })\n            );\n            return;\n          }\n\n          if (content.kind === Kind.RelayHint) {\n            const hints = JSON.parse(content.content) as Record<string, string>;\n            setRelayHints(() => ({ ...hints }))\n          }\n        },\n        onEose: () => {\n          const newNote = convertToArticles(referencedArticles[id])[0];\n\n          setArticleRefs((refs) => ({\n            ...refs,\n            [newNote.noteId]: newNote\n          }));\n\n          subNaddrRef(newNote.noteId);\n\n          unsub();\n        },\n      });\n\n      getParametrizedEvent(pubkey, identifier, kind, subId);\n      // getEvents(account?.publicKey, [hex], `nn_${id}`, true);\n\n    });\n\n  };\n\n  const subNaddrRef = (noteId: string) => {\n\n\n    const parsed = parsedMessage().replace(addrRegex, (url) => {\n      const [_, id] = url.split(':');\n\n      if (!id || id !== noteId) {\n        return url;\n      }\n      try {\n        const article = articleRefs[id];\n\n        const link = <div class={styles.highlight}><SimpleArticlePreview article={article} noLink={true} /></div>;\n\n        // @ts-ignore\n        return link.outerHTML || url;\n      } catch (e) {\n        logError('Bad Note reference: ', e);\n        return `<span class=\"${styles.error}\">${url}</span>`;\n      }\n\n    });\n\n    setParsedMessage(parsed);\n  };\n\n  const parseNpubLinks = (text: string) => {\n    let refs = [];\n    let match;\n\n    while((match = profileRegexG.exec(text)) !== null) {\n      refs.push(match[1]);\n    }\n\n    refs.forEach(id => {\n      if (userRefs[id]) {\n        setTimeout(() => {\n          subUserRef(id);\n        }, 0);\n        return;\n      }\n\n      const subId = `nu_${id}_${APP_ID}`\n      const eventId = nip19.decode(id).data as string | nip19.ProfilePointer;\n      const hex = typeof eventId === 'string' ? eventId : eventId.pubkey;\n\n      // setReferencedNotes(`nn_${id}`, { messages: [], users: {}, postStats: {}, mentions: {} })\n\n      const unsub = subsTo(subId, {\n        onEvent: (_, content) => {\n          if (!content) return;\n\n          if (content.kind === Kind.Metadata) {\n            const user = content as NostrUserContent;\n\n            const u = convertToUser(user, content.pubkey)\n\n            setUserRefs(() => ({ [u.pubkey]: u }));\n\n            // setReferencedNotes(subId, 'users', (usrs) => ({ ...usrs, [user.pubkey]: { ...user } }));\n            return;\n          }\n\n        },\n        onEose: () => {\n          subUserRef(hex);\n\n          unsub();\n        }\n      });\n\n      getUserProfiles([hex], subId);\n\n    });\n\n  };\n\n  const parseNoteLinks = (text: string) => {\n    let refs = [];\n    let match;\n\n    while((match = noteRegex.exec(text)) !== null) {\n      refs.push(match[1]);\n    }\n\n    refs.forEach(id => {\n      if (noteRefs[id]) {\n        setTimeout(() => {\n          subNoteRef(id);\n        }, 0);\n        return;\n      }\n\n      const subId = `nn_${id}_${APP_ID}`;\n      const event = nip19.decode(id);\n      const eventId = nip19.decode(id).data as string | nip19.EventPointer;\n      const hex = typeof eventId === 'string' ? eventId : eventId.id;\n\n      setReferencedNotes(subId, { messages: [], users: {}, postStats: {}, mentions: {} })\n\n      const unsub = subsTo(subId, {\n        onEvent: (_, content) => {\n          if (!content) {\n            return;\n          }\n\n          if (content.kind === Kind.Metadata) {\n            const user = content as NostrUserContent;\n\n            setReferencedNotes(subId, 'users', (usrs) => ({ ...usrs, [user.pubkey]: { ...user } }));\n            return;\n          }\n\n          if (content.kind === Kind.Highlight) {\n            setHighlightRefs(id, () => ({ ...content }));\n            return;\n          }\n\n          if ([Kind.Text, Kind.Repost].includes(content.kind)) {\n            const message = content as NostrNoteContent;\n\n            setReferencedNotes(subId, 'messages',\n              (msgs) => [ ...msgs, { ...message }]\n            );\n\n            return;\n          }\n\n          if (content.kind === Kind.NoteStats) {\n            const statistic = content as NostrStatsContent;\n            const stat = JSON.parse(statistic.content);\n\n            setReferencedNotes(subId, 'postStats',\n              (stats) => ({ ...stats, [stat.event_id]: { ...stat } })\n            );\n            return;\n          }\n\n          if (content.kind === Kind.Mentions) {\n            const mentionContent = content as NostrMentionContent;\n            const mention = JSON.parse(mentionContent.content);\n\n            setReferencedNotes(subId, 'mentions',\n              (mentions) => ({ ...mentions, [mention.id]: { ...mention } })\n            );\n            return;\n          }\n\n          if (content.kind === Kind.RelayHint) {\n            const hints = JSON.parse(content.content) as Record<string, string>;\n            setRelayHints(() => ({ ...hints }))\n          }\n        },\n        onEose: () => {\n          const newNote = convertToNotes(referencedNotes[subId])[0];\n\n          if (newNote) {\n            setNoteRefs((refs) => ({\n              ...refs,\n              [newNote.noteId]: newNote\n            }));\n\n            subNoteRef(newNote.noteId);\n          } else {\n            subNoteRef(id);\n          }\n\n\n\n          unsub();\n        },\n      });\n\n      getEvents(account?.publicKey, [hex], subId, true);\n\n    });\n\n  };\n\n  const subNoteRef = (noteId: string) => {\n\n    const parsed = parsedMessage().replace(noteRegex, (url) => {\n      const [_, id] = url.split(':');\n\n\n      if (!id || id !== noteId) {\n        return url;\n      }\n      try {\n        let note = noteRefs[id];\n\n        if (!note) {\n          note = highlightRefs[id];\n\n          const link = note ?\n            <div>\n              <ArticleHighlight highlight={note} />\n            </div> : <span class=\"linkish\">{url}</span>;\n\n          // @ts-ignore\n          return link.outerHTML || url;\n        }\n\n        const link = note ?\n          <div>\n            <TranslatorProvider>\n                <EmbeddedNote\n                  note={note}\n                  mentionedUsers={note.mentionedUsers || {}}\n                  includeEmbeds={true}\n                  hideFooter={true}\n                  noLinks=\"links\"\n                />\n            </TranslatorProvider>\n          </div> :\n          <span class=\"linkish\">{url}</span>;\n\n        // @ts-ignore\n        return link.outerHTML || url;\n      } catch (e) {\n        logError('Bad Note reference: ', e);\n        return `<span class=\"${styles.error}\">${url}</span>`;\n      }\n\n    });\n\n    setParsedMessage(parsed);\n  };\n\n\n  const parseForReferece = async (value: string) => {\n    const content = await replaceLinkPreviews(\n      parseUserMentions(\n        highlightHashtags(\n          parseNote1(value, media?.actions.getMediaUrl)\n        )\n      )\n    );\n\n    parseNaddr(content);\n    parseNpubLinks(content);\n    parseNoteLinks(content);\n\n    return content;\n  };\n\n  const onInput = (e: InputEvent) => {\n    if (fileToUpload()) {\n      e.preventDefault();\n      return false;\n    }\n\n    if (textArea) {\n      setMessage(textArea.value);\n    }\n\n\n  };\n\n  let delayForMedia = 0;\n\n  createEffect(() => {\n    if (delayForMedia) {\n      window.clearTimeout(delayForMedia);\n    }\n    const msg = sanitize(message());\n\n    delayForMedia = setTimeout(async () => {\n      const p = await parseForReferece(msg);\n      setParsedMessage(p);\n    }, 500);\n  })\n\n  createEffect(() => {\n    if (query().length === 0) {\n      search?.actions.getRecomendedUsers(profile?.profileHistory.profiles || []);\n      return;\n    }\n\n    search?.actions.findUsers(query());\n  });\n\n  createEffect(() => {\n    if (isMentioning()) {\n\n      mentionPositionOptions();\n\n      if (search?.users && search.users.length > 0) {\n        setHighlightedUser(0);\n      }\n    }\n  });\n\n  createEffect(() => {\n    if (isEmojiInput()) {\n      emojiPositionOptions();\n\n      if (emojiResults.length > 0) {\n        setHighlightedEmoji(0);\n      }\n    }\n  });\n\n  const selectEmoji = (emoji: EmojiOption) => {\n    if (!textArea || !emoji) {\n      setEmojiInput(false);\n      setEmojiQuery('');\n      setEmojiResults(() => []);\n      return;\n    }\n\n    account?.actions.saveEmoji(emoji);\n    const msg = message();\n\n    // Get cursor position to determine insertion point\n    let cursor = textArea.selectionStart;\n\n    // Get index of the token and insert emoji character\n    const index = msg.slice(0, cursor).lastIndexOf(':');\n    const value = msg.slice(0, index) + `${emoji.name} ` + msg.slice(cursor);\n\n    // Reset query, update message and text area value\n    setMessage(value);\n    textArea.value = message();\n\n    // Calculate new cursor position\n    textArea.selectionEnd = index + 3;\n    textArea.focus();\n\n    setEmojiInput(false);\n    setEmojiQuery('');\n    setEmojiResults(() => []);\n\n    // Dispatch input event to recalculate UI position\n    // const e = new Event('input', { bubbles: true, cancelable: true});\n    // textArea.dispatchEvent(e);\n  };\n\n  const selectUser = (user: PrimalUser | undefined) => {\n    if (!textArea || !user) {\n      return;\n    }\n\n    setMentioning(false);\n\n    const name = userName(user);\n\n    setUserRefs((refs) => ({\n      ...refs,\n      [name]: user,\n    }));\n\n    const msg = message();\n\n    // Get cursor position to determine insertion point\n    let cursor = textArea.selectionStart;\n\n    // Get index of the token and inster user's handle\n    const index = msg.slice(0, cursor).lastIndexOf('@');\n    const value = msg.slice(0, index) + `@\\`${name}\\`` + msg.slice(cursor);\n\n    // Reset query, update message and text area value\n    setQuery('');\n    setMessage(value);\n    textArea.value = message();\n\n    textArea.focus();\n\n    // Calculate new cursor position\n    cursor = value.slice(0, cursor).lastIndexOf('@') + name.length + 3;\n    textArea.selectionEnd = cursor;\n\n\n    // Dispatch input event to recalculate UI position\n    const e = new Event('input', { bubbles: true, cancelable: true});\n    textArea.dispatchEvent(e);\n  };\n\n  const focusInput = () => {\n    textArea && textArea.focus();\n  };\n\n  const prefix = () => props.idPrefix ?? '';\n\n  const insertAtCursor = (text: string) => {\n    if (!textArea) {\n      return;\n    }\n\n    const msg = message();\n\n    const cursor = textArea.selectionStart;\n\n    const value = msg.slice(0, cursor) + `${text}` + msg.slice(cursor);\n\n    setMessage(() => value);\n    textArea.value = value;\n\n    textArea.focus();\n  };\n\n  const isSupportedFileType = (file: File) => {\n    if (!file.type.startsWith('image/') && !file.type.startsWith('video/')) {\n      toast?.sendWarning(intl.formatMessage(tToast.fileTypeUpsupported));\n      return false;\n    }\n\n    return true;\n\n  }\n\n  const onUpload = () => {\n    if (!fileUpload) {\n      return;\n    }\n\n    const file = fileUpload.files ? fileUpload.files[0] : null;\n\n    // @ts-ignore fileUpload.value assignment\n    file && isSupportedFileType(file) && setFileToUpload(file);\n\n  }\n\n  const [isPickingEmoji, setIsPickingEmoji] = createSignal(false);\n\n  const addSelectedEmoji = (emoji: EmojiOption) => {\n    if (!textArea || !emoji) {\n      return;\n    }\n\n    account?.actions.saveEmoji(emoji);\n\n    const msg = message();\n\n    // Get cursor position to determine insertion point\n    let cursor = textArea.selectionStart;\n\n    // Get index of the token and insert emoji character\n    const value = msg.slice(0, cursor) + `${emoji.name} ` + msg.slice(cursor);\n\n    // Reset query, update message and text area value\n    setMessage(value);\n    textArea.value = message();\n\n    // Calculate new cursor position\n    textArea.selectionEnd = cursor + 3;\n    textArea.focus();\n  };\n\n  const determineOrient = () => {\n    const coor = getScreenCordinates(emojiPicker);\n    const height = 326;\n    return (coor.y || 0) + height < window.innerHeight + window.scrollY ? 'down' : 'up';\n  }\n\n  let progressFill: HTMLDivElement | undefined;\n\n  return (\n    <div\n      id={props.id}\n      class={styles.noteEditBox}\n      ref={editWrap}\n      onDrop={onDrop}\n      onDragOver={onDragOver}\n      onDragLeave={onDragLeave}\n    >\n      <Show when={isDroppable()}>\n        <div\n          class={styles.dropOverlay}\n        >\n          {intl.formatMessage(tFeedback.dropzone)}\n        </div>\n      </Show>\n\n      <div class={styles.editorWrap} onClick={focusInput}>\n        <div>\n          <textarea\n            id={`${prefix()}new_note_text_area`}\n            rows={1}\n            data-min-rows={1}\n            onInput={onInput}\n            ref={textArea}\n            onPaste={onPaste}\n            readOnly={fileToUpload() !== undefined}\n          >\n          </textarea>\n          <Show when={props.context}>\n            <div class={styles.context}>\n              {props.context}\n            </div>\n          </Show>\n          <div\n            class={styles.previewCaption}>\n            {intl.formatMessage(tNote.newPreview)}\n          </div>\n        </div>\n        <div\n          class={styles.editorScroll}\n          id={`${prefix()}new_note_text_preview`}\n        >\n          {renderMessage()}\n          <div class={styles.uploader}>\n            <Uploader\n              publicKey={account?.publicKey}\n              nip05={account?.activeUser?.nip05}\n              openSockets={props.open}\n              file={fileToUpload()}\n              onFail={() => {\n                toast?.sendWarning(intl.formatMessage(tUpload.fail, {\n                  file: fileToUpload()?.name,\n                }));\n                resetUpload();\n              }}\n              onRefuse={(reason: string) => {\n                if (reason === 'file_too_big_100') {\n                  toast?.sendWarning(intl.formatMessage(tUpload.fileTooBigRegular));\n                }\n                if (reason === 'file_too_big_1024') {\n                  toast?.sendWarning(intl.formatMessage(tUpload.fileTooBigPremium));\n                }\n                resetUpload();\n              }}\n              onCancel={() => {\n                resetUpload();\n              }}\n              onSuccsess={(url:string) => {\n                insertAtCursor(` ${url} `);\n                resetUpload();\n              }}\n            />\n          </div>\n        </div>\n      </div>\n\n\n      <Show when={isMentioning()}>\n        <div\n          class={styles.searchSuggestions}\n          ref={mentionOptions}\n        >\n          <For each={search?.users}>\n            {(user, index) => (\n              <SearchOption\n                title={userName(user)}\n                description={nip05Verification(user)}\n                icon={<Avatar user={user} size=\"xs\" />}\n                statNumber={profile?.profileHistory.stats[user.pubkey]?.followers_count || search?.scores[user.pubkey]}\n                statLabel={intl.formatMessage(tSearch.followers)}\n                onClick={() => selectUser(user)}\n                highlighted={highlightedUser() === index()}\n              />\n            )}\n          </For>\n        </div>\n      </Show>\n\n      <Show when={isEmojiInput() && emojiQuery().length > emojiSearchLimit && emojiResults.length > 0}>\n        <div\n          class={styles.emojiSuggestions}\n          ref={emojiOptions}\n        >\n          <For each={emojiResults}>\n            {(emoji, index) => (\n              <button\n              id={`${instanceId}-${index()}`}\n              class={`${styles.emojiOption} ${highlightedEmoji() === index() ? styles.highlight : ''}`}\n              onClick={() => selectEmoji(emoji)}\n              >\n                {emoji.name}\n              </button>\n            )}\n          </For>\n        </div>\n      </Show>\n\n      <ConfirmAlternativeModal\n        open={isConfirmEditorClose()}\n        title={intl.formatMessage(tNote.saveNoteDraft.title)}\n        description={intl.formatMessage(tNote.saveNoteDraft.description)}\n        confirmLabel={intl.formatMessage(tNote.saveNoteDraft.optionYes)}\n        abortLabel={intl.formatMessage(tNote.saveNoteDraft.optionNo)}\n        cancelLabel={intl.formatMessage(tNote.saveNoteDraft.optionCancel)}\n        onConfirm={() => {\n          persistNote(message());\n          setConfirmEditorClose(false);\n        }}\n        onAbort={() => {\n          persistNote('');\n          setConfirmEditorClose(false);\n          clearEditor();\n        }}\n        onCancel={() => {\n          setConfirmEditorClose(false);\n          textArea?.focus();\n        }}\n      />\n\n      <div class={styles.controls}>\n        <div class={styles.editorOptions}>\n          <div class={styles.editorOption}>\n            <input\n              id={`upload-${instanceId}`}\n              type=\"file\"\n              onChange={onUpload}\n              ref={fileUpload}\n              hidden={true}\n              accept=\"image/*,video/*,audio/*\"\n            />\n            <label for={`upload-${instanceId}`} class={`attach_icon ${styles.attachIcon}`}>\n            </label>\n          </div>\n          <div class={styles.editorOption}>\n            <ButtonGhost\n              highlight={isPickingEmoji()}\n              onClick={() => {\n                setIsPickingEmoji((v) => !v);\n                !isPickingEmoji() && textArea?.focus();\n              }}>\n              <div\n                ref={emojiPicker}\n                class={`emoji_icon ${styles.emojiIcon} ${isPickingEmoji() ? styles.highlight : ''}`}\n              ></div>\n            </ButtonGhost>\n\n            <Show when={isPickingEmoji()}>\n              <EmojiPickPopover\n                onClose={() => {\n                  setIsPickingEmoji(false);\n                  textArea?.focus();\n                }}\n                onSelect={addSelectedEmoji}\n                orientation={determineOrient()}\n              />\n            </Show>\n          </div>\n        </div>\n        <div class={styles.editorDescision}>\n          <ButtonPrimary\n            onClick={postNote}\n            disabled={isPostingInProgress() || fileToUpload() || message().trim().length === 0}\n          >\n            {intl.formatMessage(tActions.notePostNew)}\n          </ButtonPrimary>\n          <ButtonSecondary onClick={closeEditor}>\n            {intl.formatMessage(tActions.cancel)}\n          </ButtonSecondary>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default hookForDev(EditBox);\n"],"names":["defaultTerm","EmojiPickPopover","props","account","useAccountContext","emojiSearchTerm","setEmojiSearchTerm","createSignal","focusInput","setFocusInput","showPreset","setShowPreset","onKey","e","stopPropagation","code","onClose","createEffect","length","setFilter","filter","onClickOutside","onEmojiSearch","term","onMount","setTimeout","window","addEventListener","onCleanup","removeEventListener","_el$","_tmpl$","_el$2","firstChild","$$click","_$insert","_$createComponent","EmojiPickHeader","focus","onInput","onFilter","EmojiPicker","preset","emojiHistory","onSelect","emoji","short","orientation","_$effect","_p$","_v$","id","_v$2","styles","emojiPickHolder","_v$3","zapEmojiChangeModal","_$setAttribute","_$className","undefined","_$delegateEvents","ConfirmAlternativeModal","intl","useIntl","AdvancedSearchDialog","open","setOpen","isOpen","onCancel","title","_el$4","_tmpl$2","formatMessage","t","feedConfirmationTitle","triggerClass","hidden","children","_el$3","nextSibling","description","Show","when","onConfirm","ButtonPrimary","onClick","confirmLabel","confirm","onAbort","ButtonSecondary","light","abortLabel","abort","cancelLabel","cancel","confirmAlternateModal","feedConfirmationDescription","_v$4","feedConfirmationActions","hookForDev","SimpleArticlePreview","app","useAppContext","thread","useThreadContext","reactionsState","updateReactionsState","createStore","likes","article","liked","noteActions","reposts","reposted","replies","replied","zapCount","zaps","satsZapped","satszapped","zapped","zappedAmount","zappedNow","isZapping","showZapAnim","hideZapIcon","moreZapsAvailable","isRepostMenuVisible","topZaps","topZapsFeed","quoteCount","latestTopZap","latestTopZapFeed","articleContextMenu","onConfirmZap","zapOption","actions","closeCustomZapModal","batch","amount","z","addTopZap","addTopZapFeed","onSuccessZap","resetCustomZap","publicKey","onFailZap","removeTopZap","removeTopZapFeed","onCancelZap","pubkey","oldZaps","uuidv4","newZap","message","eventId","users","find","u","fetchUsers","sort","a","b","slice","customZapInfo","note","onSuccess","onFail","openReactionModal","openOn","naddr","quotes","onContextMenuTrigger","openContextMenu","getBoundingClientRect","openCustomZapModal","articlePreview","onImageLoaded","_tmpl$3","_el$5","_el$6","_el$7","_el$8","_el$9","_el$10","_el$11","_el$12","_el$13","_el$14","_el$15","_el$18","_ref$","_$use","NoteContextTrigger","ref","r$","_ref$2","Avatar","user","size","userName","VerificationCheck","nip05","shortDate","published","summary","Math","ceil","wordCount","wordsPerMinute","For","each","tags","tag","_el$20","_tmpl$4","_el$16","image","fallback","picture","_el$22","placeholderImage","_el$21","_el$19","height","upRightFloater","header","_v$5","userInfo","_v$6","_v$7","_v$8","time","_v$9","body","_v$10","text","_v$11","content","_v$12","_v$13","_v$14","_v$15","estimate","_v$16","_$style","ArticleHighlight","onOver","preventDefault","target","setAttribute","onShowMenu","highlight","ArticleHighlight$1","EditBox","media","useMediaContext","instanceId","search","useSearchContext","toast","useToastContext","profile","useProfileContext","useSettingsContext","textArea","textPreview","mentionOptions","emojiOptions","emojiPicker","editWrap","fileUpload","mentionCursorPosition","top","left","emojiCursorPosition","isMentioning","setMentioning","preQuery","setPreQuery","query","setQuery","setMessage","parsedMessage","setParsedMessage","isEmojiInput","setEmojiInput","emojiQuery","setEmojiQuery","emojiResults","setEmojiResults","userRefs","setUserRefs","noteRefs","setNoteRefs","articleRefs","setArticleRefs","highlightRefs","setHighlightRefs","highlightedUser","setHighlightedUser","highlightedEmoji","setHighlightedEmoji","referencedNotes","setReferencedNotes","referencedArticles","setReferencedArticles","isConfirmEditorClose","setConfirmEditorClose","fileToUpload","setFileToUpload","relayHints","setRelayHints","location","useLocation","currentPath","pathname","noteHasInvoice","test","getScrollHeight","elm","savedValue","value","_baseScrollHeight","scrollHeight","onExpandableTextareaInput","event","maxHeight","document","documentElement","clientHeight","innerHeight","preview","nodeName","prefix","minRows","parseInt","getAttribute","style","rows","emojiSearchLimit","emojiSearch","emojiPositionOptions","renderMessage","DOMPurify","sanitize","innerHTML","editor","sections","tokens","replace","linebreakRegex","replaceAll","split","sectionIndex","forEach","tok","startsWith","c","prev","section","Switch","Match","Lnbc","lnbc","inactive","onKeyDown","selectionStart","mentionSeparators","metaKey","postNote","key","includes","getCaretCoordinates","i","emojiHolder","getElementById","isVisibleInContainer","scrollIntoView","block","behavior","trim","selectEmoji","cursor","lastEmojiTrigger","lastIndexOf","q","textSoFar","lastWord","pop","index","newText","selectionEnd","selectUser","lastMentionTrigger","isDroppable","setIsDroppable","onDrop","file","dataTransfer","files","isSupportedFileType","onDragOver","onDragLeave","rect","isWider","clientX","x","width","isTaller","clientY","y","onPaste","clipboardData","onEscape","isPickingEmoji","clearEditor","preQ","debounce","addQuote","quote","msg","position","isEmptyMessage","newMsg","quoteNote","InputEvent","draft","readNoteDraft","replyToNote","noteId","draftUserRefs","readNoteDraftUserRefs","reconcile","dispatchEvent","Event","bubbles","quotedNote","saveNoteDraft","saveNoteDraftUserRefs","closeEmojiAndMentions","closeEditor","resetUpload","persistNote","isPostingInProgress","setIsPostingInProgress","__name","hasPublicKey","proxyThroughPrimal","relays","sendWarning","tToast","noRelaysConnected","messageToSend","editMentionRegex","url","anythingBefore","mention","_","name","npub","referencesToTags","rep","rootTag","rHints","tagWithHint","map","v","push","repPeople","unwrap","success","reasons","sendNote","activeRelays","relaySettings","importId","APP_ID","unsub","subsTo","onEose","sendSuccess","publishNoteSuccess","importEvents","noExtension","publishNoteTimeout","publishNoteFail","mentionPositionOptions","taRect","wRect","mTop","scrollTop","newTop","newLeft","highlightHashtags","regex","token","space","userReference","outerHTML","parseUserMentions","Object","values","MentionedUserLink","openInNewTab","subUserRef","userId","parsed","profileRegex","origin","profileLink","truncateNpub","error","parseNaddr","refs","match","addrRegexG","exec","subNaddrRef","addr","decodeIdentifier","type","kind","identifier","data","subId","messages","postStats","mentions","onEvent","Kind","Metadata","usrs","LongForm","LongFormShell","msgs","NoteStats","stat","JSON","parse","stats","event_id","Mentions","RelayHint","hints","newNote","convertToArticles","getParametrizedEvent","addrRegex","noLink","logError","parseNpubLinks","profileRegexG","nip19","decode","hex","convertToUser","getUserProfiles","parseNoteLinks","noteRegex","subNoteRef","Highlight","Text","Repost","convertToNotes","getEvents","TranslatorProvider","EmbeddedNote","mentionedUsers","includeEmbeds","hideFooter","noLinks","_el$17","_tmpl$5","parseForReferece","replaceLinkPreviews","parseNote1","getMediaUrl","delayForMedia","clearTimeout","p","getRecomendedUsers","profileHistory","profiles","findUsers","saveEmoji","cancelable","idPrefix","insertAtCursor","fileTypeUpsupported","onUpload","setIsPickingEmoji","addSelectedEmoji","determineOrient","coor","getScreenCordinates","scrollY","_tmpl$6","_el$24","_el$25","_el$26","_el$29","_el$30","_el$31","_el$32","_el$33","_el$34","_el$36","_ref$3","tFeedback","dropzone","dropOverlay","_ref$4","$$input","context","_el$23","tNote","newPreview","Uploader","activeUser","openSockets","tUpload","fail","onRefuse","reason","fileTooBigRegular","fileTooBigPremium","onSuccsess","_el$27","_ref$5","SearchOption","nip05Verification","icon","statNumber","followers_count","scores","statLabel","tSearch","followers","highlighted","searchSuggestions","_el$28","_ref$6","_el$37","_tmpl$7","_v$17","emojiOption","emojiSuggestions","optionYes","optionNo","optionCancel","_ref$7","ButtonGhost","_el$35","_ref$8","emojiIcon","disabled","tActions","notePostNew","noteEditBox","editorWrap","previewCaption","editorScroll","uploader","controls","editorOptions","editorOption","attachIcon","editorDescision","readOnly","EditBox$1"],"mappings":"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"}