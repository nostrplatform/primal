var S=Object.defineProperty;var v=(f,c)=>S(f,"name",{value:c,configurable:!0});import{u as $,I as A,aI as C,D as V,o as N,dv as P,N as w,a2 as o,aR as F,dw as x,du as I,c as l,M as J,j as K,F as O,l as E,m as b,H as R,t as T,T as U}from"./index-64dc6460.js";import{F as q,s as M}from"./FeedMarketPlaceItem-1368feb7.js";const z=T("<div><div>"),j={dvms:[],dvmStats:{},users:{},previewDvm:void 0,dvmMetadata:{},dvmActions:{},dvmCommonPubkeys:{}},L=v(f=>{const c=$(),_=A(),y=C(),[a,i]=V({...j});N(()=>{a.dvms.length===0&&g()});const g=v(()=>{const r=`explore_feeds_${U}`,n=P(c?.publicKey);n&&n.length>0&&i("dvms",[...n]);let e=[];const d=w(r,{onEvent:(u,t)=>{if(t.kind===o.DVM){const s=JSON.parse(t.content),m=(t.tags?.find(p=>p[0]==="d")||["d",""])[1],D={id:t.id,name:s.name||"",about:s.about||"",amount:s.amount||"free",primalVerifiedRequired:s.primalVerifiedRequired||!1,pubkey:t.pubkey,supportedKinds:t.tags?.reduce((p,k)=>k[0]==="k"?[...p,k[1]]:p,[])||[],identifier:m,picture:s.picture,image:s.image,coordinate:`${o.DVM}:${t.pubkey}:${m}`,primal_spec:s.primal_spec};e.push(D);return}if(t.kind===o.Metadata){const s=F(t,t.pubkey);i("users",s.pubkey,()=>({...s}));return}if(t.kind===o.NoteStats){const s=JSON.parse(t.content);if(!s.event_id)return;i("dvmStats",s.event_id,()=>({likes:s.likes||0,satszapped:s.satszapped||0}))}if(t.kind===o.DVMMetadata){const s=JSON.parse(t.content);if(!s.event_id)return;i("dvmMetadata",s.event_id,()=>({kind:s.kind,isPrimal:s.is_primal}))}if(t.kind===o.NoteActions){const m=JSON.parse(t.content);i("dvmActions",m.event_id,()=>({...m}));return}if(t.kind===o.DVMFollowsActions){const s=JSON.parse(t.content);i("dvmCommonPubkeys",s.event_id,()=>[...s.users])}},onEose:()=>{i("dvms",()=>({...e})),x(c?.publicKey,[...e]),d()}});I(c?.publicKey,r,f.type)},"fetchDVMs"),h=v(r=>(a.dvmCommonPubkeys[r]||[]).reduce((e,d)=>{const u=a.users[d];return u?[...e,{...u}]:e},[]),"commonUsers");return l(R,{get children(){return l(J,{get when(){return!a.previewDvm},get children(){const r=z(),n=r.firstChild;return K(n,l(O,{get each(){return a.dvms},children:e=>l(q,{dvm:e,get author(){return a.users[e.pubkey]},get stats(){return a.dvmStats[e.id]},get metadata(){return a.dvmMetadata[e.id]},get actions(){return a.dvmActions[e.id]},get commonUsers(){return h(e.id)},onClick:()=>{y?.actions.setPreviewDVM(e,a.dvmStats[e.id],a.dvmMetadata[e.id],a.users[e.pubkey],a.dvmActions[e.id],a.users,a.dvmCommonPubkeys[e.id]),_(`/explore/feed/${e.identifier}_by_${e.pubkey}`)}})})),E(e=>{const d=M.feedMarketplaceContent,u=M.boothsPage;return d!==e._v$&&b(r,e._v$=d),u!==e._v$2&&b(n,e._v$2=u),e},{_v$:void 0,_v$2:void 0}),r}})}})},"FeedMarketPlace");export{L as F,j as e};
//# sourceMappingURL=FeedMarketPlace-34349272.js.map
