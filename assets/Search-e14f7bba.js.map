{"version":3,"file":"Search-e14f7bba.js","sources":["../../src/components/SearchSidebar/SearchSidebar.tsx","../../src/pages/Search.tsx"],"sourcesContent":["import { Component } from 'solid-js';\nimport { PrimalUser } from '../../types/primal';\nimport { useIntl } from '@cookbook/solid-intl';\nimport { search as t } from '../../translations';\nimport PeopleList from '../PeopleList/PeopleList';\n\n\nconst SearchSidebar: Component<{ users: PrimalUser[] }> = (props) => {\n\n  const intl = useIntl();\n\n  return (\n    <>\n      <PeopleList\n        people={props.users}\n        label={intl.formatMessage(t.sidebarCaption)}\n        singleFile={true}\n      />\n    </>\n  );\n}\n\nexport default SearchSidebar;\n","import {\n  Component,\n  createEffect,\n  createSignal,\n  For,\n  on,\n  onMount,\n  Show,\n} from 'solid-js';\nimport Note from '../components/Note/Note';\nimport Wormhole from '../components/Wormhole/Wormhole';\nimport StickySidebar from '../components/StickySidebar/StickySidebar';\nimport { useAccountContext } from '../contexts/AccountContext';\nimport { useIntl } from '@cookbook/solid-intl';\nimport { isConnected } from '../sockets';\nimport { useParams } from '@solidjs/router';\nimport styles from './Search.module.scss';\nimport { useSearchContext } from '../contexts/SearchContext';\nimport SearchSidebar from '../components/SearchSidebar/SearchSidebar';\nimport Loader from '../components/Loader/Loader';\nimport SearchComponent from '../components/Search/Search';\nimport { toast as t, search as tSearch  } from '../translations';\nimport PageCaption from '../components/PageCaption/PageCaption';\nimport PageTitle from '../components/PageTitle/PageTitle';\nimport SaveFeedDialog from '../components/SaveFeedDialog/SaveFeedDialog';\nimport { useAdvancedSearchContext } from '../contexts/AdvancedSearchContext';\nimport Paginator from '../components/Paginator/Paginator';\n\nconst Search: Component = () => {\n  const params = useParams();\n  const basicSearch = useSearchContext();\n  const search = useAdvancedSearchContext();\n  const account = useAccountContext();\n  const intl = useIntl();\n\n  const query = () => decodeURI(params.query).replaceAll('%23', '#');\n\n  const [openAddFeedDialog, setAddFeedDialog] = createSignal<boolean>(false);\n\n  createEffect(on(query, (v, p) => {\n    if (v === p) return;\n\n    search?.actions.clearSearch();\n    search?.actions.findContent(v);\n    basicSearch?.actions.findContentUsers(v);\n  }));\n\n  return (\n    <>\n      <PageTitle title={\n        intl.formatMessage(\n          tSearch.title,\n          { query: query() || '' },\n        )}\n      />\n\n      <StickySidebar>\n        <SearchSidebar users={basicSearch?.contentUsers || []} />\n      </StickySidebar>\n\n      <Wormhole\n        to=\"search_section\"\n      >\n        <SearchComponent />\n      </Wormhole>\n\n      <PageCaption extended={true}>\n        <div class={styles.searchHeader}>\n          <div class={styles.caption}>\n            <div title={intl.formatMessage(\n                tSearch.title,\n                { query: query() || '' },\n              )}>\n              {intl.formatMessage(\n                tSearch.title,\n                { query: query() || '' },\n              )}\n            </div>\n          </div>\n          <div class={styles.addToFeed}>\n            <SaveFeedDialog\n              open={openAddFeedDialog()}\n              setOpen={setAddFeedDialog}\n              query={query()}\n              feedType={'home'}\n            />\n          </div>\n        </div>\n      </PageCaption>\n\n\n      <div class={styles.searchContent}>\n        <Show\n          when={!search?.isFetchingContent || search.notes.length > 0}\n          fallback={<div class={styles.loader}><Loader /></div>}\n        >\n          <Show\n            when={search?.notes && search.notes.length > 0}\n            fallback={\n              <div class={styles.noResults}>\n                {\n                  intl.formatMessage(tSearch.noResults)\n                }\n              </div>\n            }\n          >\n            <For each={search?.notes} >\n              {note => <Note note={note} shorten={true} />}\n            </For>\n          </Show>\n        </Show>\n        <Paginator\n          loadNextPage={() => search?.actions.fetchContentNextPage(query())}\n        />\n      </div>\n    </>\n  )\n}\n\nexport default Search;\n"],"names":["SearchSidebar","props","intl","useIntl","_$createComponent","PeopleList","people","users","label","formatMessage","t","sidebarCaption","singleFile","Search","params","useParams","basicSearch","useSearchContext","search","useAdvancedSearchContext","useAccountContext","query","decodeURI","replaceAll","openAddFeedDialog","setAddFeedDialog","createSignal","createEffect","on","v","p","actions","clearSearch","findContent","findContentUsers","PageTitle","title","tSearch","StickySidebar","children","contentUsers","Wormhole","to","SearchComponent","PageCaption","extended","_el$","_tmpl$","_el$2","firstChild","_el$3","_el$4","nextSibling","_$insert","SaveFeedDialog","open","setOpen","feedType","_$effect","_p$","_v$","styles","searchHeader","_v$2","caption","_v$3","_v$4","addToFeed","_$className","_$setAttribute","undefined","_el$5","_tmpl$2","Show","when","isFetchingContent","notes","length","fallback","_el$6","Loader","loader","_el$7","noResults","For","each","note","Note","shorten","Paginator","loadNextPage","fetchContentNextPage","searchContent"],"mappings":"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"}