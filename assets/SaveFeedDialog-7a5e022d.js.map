{"version":3,"file":"SaveFeedDialog-7a5e022d.js","sources":["../../src/components/SaveFeedDialog/SaveFeedDialog.tsx"],"sourcesContent":["import { Component, createSignal, Show } from 'solid-js';\nimport styles from './SaveFeedDialog.module.scss';\nimport { TextField } from '@kobalte/core/text-field';\nimport AdvancedSearchDialog from '../../components/AdvancedSearch/AdvancedSearchDialog';\nimport ButtonSecondary from '../../components/Buttons/ButtonSecondary';\nimport ButtonPremium from '../../components/Buttons/ButtonPremium';\nimport { useSettingsContext } from '../../contexts/SettingsContext';\nimport { PrimalArticleFeed } from '../../types/primal';\n\n\nconst SaveFeedDialog: Component<{\n  open: boolean,\n  setOpen?: (flag: boolean) => void,\n  query?: string,\n  feedType: 'home' | 'reads',\n}> = (props) => {\n  const settings = useSettingsContext();\n\n  const [feedName, setFeedName] = createSignal('Seach results');\n  const [feedDescription, setFeedDescription] = createSignal('Primal Saved Search');\n\n  const generateFeedDefinition = () => {\n\n    const spec = JSON.stringify({\n        id: 'advsearch',\n        query: props.query || '',\n      });\n\n    const feed: PrimalArticleFeed = {\n      name: feedName(),\n      description: feedDescription(),\n      spec,\n      enabled: true,\n      feedkind: 'search',\n    };\n\n    return feed;\n  }\n\n  const isFeedAdded = () => {\n    const feed = generateFeedDefinition();\n    const feedtype = props.feedType;\n\n    if (!feed) return false;\n\n    return settings?.actions.isFeedAdded(feed, feedtype);\n  }\n\n  const toggleFeed = (open: boolean) => {\n    if (!open) {\n      props.setOpen && props.setOpen(false);\n      return;\n    }\n\n    const feed = generateFeedDefinition();\n\n    if (!feed) return;\n\n    const isAlreadyAdded = settings?.actions.isFeedAdded(feed, props.feedType)\n\n    if (isAlreadyAdded) {\n      settings?.actions.removeFeed(feed, props.feedType);\n      return;\n    }\n\n    props.setOpen && props.setOpen(true);\n\n  };\n\n  return (\n    <AdvancedSearchDialog\n      open={props.open}\n      setOpen={toggleFeed}\n      triggerClass={styles.addToFeed}\n      triggerContent={\n        <Show\n          when={isFeedAdded()}\n          fallback={<>\n            <div class={styles.addIcon}></div>\n            <div>\n              Add this search to my {props.feedType} feeds\n            </div>\n          </>}\n        >\n          Remove this search from my {props.feedType} feeds\n        </Show>\n      }\n      title={<div class={styles.addToFeedDialogTitle}>\n        Save to <span>{props.feedType}</span> Feeds\n      </div>}\n    >\n      <div class={styles.addToFeedDialogContent}>\n        <div class={styles.form}>\n          <TextField class={styles.searchCommand} value={feedName()} onChange={setFeedName}>\n            <TextField.Label>Feed name:</TextField.Label>\n            <TextField.Input />\n          </TextField>\n\n          <TextField class={styles.searchCommand} value={feedDescription()} onChange={setFeedDescription}>\n            <TextField.Label>Feed description</TextField.Label>\n            <TextField.Input />\n          </TextField>\n        </div>\n        <div class={styles.footer}>\n          <ButtonSecondary\n            onClick={() => props.setOpen && props.setOpen(false)}\n            light={true}\n          >\n            Cancel\n          </ButtonSecondary>\n          <ButtonPremium\n            onClick={() => {\n              settings?.actions.addFeed(generateFeedDefinition(), props.feedType);\n              props.setOpen && props.setOpen(false);\n            }}\n          >\n            Save\n          </ButtonPremium>\n        </div>\n      </div>\n    </AdvancedSearchDialog>\n\n  )\n}\n\nexport default SaveFeedDialog;\n"],"names":["SaveFeedDialog","props","settings","useSettingsContext","feedName","setFeedName","createSignal","feedDescription","setFeedDescription","generateFeedDefinition","spec","JSON","stringify","id","query","name","description","enabled","feedkind","isFeedAdded","feed","feedtype","feedType","actions","_$createComponent","AdvancedSearchDialog","open","setOpen","removeFeed","triggerClass","styles","addToFeed","triggerContent","Show","when","fallback","_el$4","_tmpl$2","_$effect","_$className","addIcon","_el$5","_tmpl$3","_el$6","firstChild","_el$8","nextSibling","_$insert","children","_$memo","title","_el$9","_tmpl$4","_el$10","_el$11","addToFeedDialogTitle","_el$","_tmpl$","_el$2","_el$3","TextField","searchCommand","value","onChange","Label","Input","ButtonSecondary","onClick","light","ButtonPremium","addFeed","_p$","_v$","addToFeedDialogContent","_v$2","form","_v$3","footer","undefined"],"mappings":"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"}