var ae=Object.defineProperty;var w=(e,p)=>ae(e,"name",{value:p,configurable:!0});import{l as C,m as s,t as F,h as O,u as B,B as re,I as de,b as se,c as r,S as k,j as v,A as U,s as K,w as oe,V as ue,J as le,K as ve,i as _e,L as J,C as E,o as q,E as M,F as L,N as Q,O as he,P as me,Q as $e,R as fe,T as W,f as ge,e as be,g as ie,n as ce,r as X,v as Y,k as pe,U as Se,D as we,W as Z,G as Ce,X as Pe,M as ee,H as Fe}from"./index-64dc6460.js";import{S as Ae,s as x}from"./SelectionBox2-201141a0.js";import{P as Ne}from"./Paginator-4878ac5b.js";import{W as ke}from"./Wormhole-fa0163d3.js";import{s as te}from"./scroll-88dc0c55.js";import{S as Te}from"./StickySidebar-65b823c5.js";import{S as xe}from"./Search-c8ce1e29.js";import{s as Ie}from"./Layout-bd2a0ea3.js";import{P as ye}from"./PageTitle-3d0a9832.js";import{A as De}from"./ArticlePreview-3d0aa4c8.js";import{P as je}from"./PageCaption-27eb7f4c.js";import{s as D}from"./HomeSidebar.module-aa2a7eab.js";import{A as Re,a as Ee}from"./ArticlePreviewSidebarSkeleton-add7f0b3.js";import{T as V}from"./ParsedNote-9900e3c8.js";import{s as T}from"./Skeleton.module-8b20490e.js";import{s as I}from"./SelectionItem-0e1bfb8a.js";import{A as He}from"./ArticlePreviewSkeleton-3f1ff222.js";import"./G5FCC32B-f4759418.js";import"./RLGGFAYQ-2a48be09.js";import"./index-b4296c5e.js";import"./5WXHJDCZ-8b9b8e69.js";import"./LR7LBJN3-a1aba763.js";import"./index-c76cfba2.js";import"./QJIB6BDF-1d7b1e44.js";import"./JNCCF6MP-19ab5fd3.js";import"./index-a25c8160.js";import"./Buttons.module-e818c1ea.js";import"./Loader-1ac7e304.js";import"./SearchOption-a7f2ab4a.js";import"./ButtonPrimary-1f64caa8.js";import"./EditBox-1353f619.js";import"./index-555a6fe0.js";import"./textArea-802fec28.js";import"./ButtonSecondary-cc5e2282.js";import"./ButtonGhost-a0fa1826.js";import"./EmojiPickHeader-dfcd5384.js";import"./ConfirmModal.module-73b4314e.js";import"./AdvancedSearchDialog-eff41eef.js";import"./Uploader-f6bcb09a.js";import"./EMOXVTIZ-81fa338a.js";import"./dates-9bcb2bf7.js";import"./Note-f0f70728.js";import"./BannerIOS-4372487a.js";import"./primal_white-9ad5c7e6.js";import"./open_white-d7ddfa1e.js";import"./7FJWXM73-511ca333.js";import"./SOM3K36D-40feb6ac.js";import"./TextInput-e0ece469.js";import"./JFO5B7NF-4a51a11a.js";import"./ConfirmModal-62a7ec79.js";import"./QrCode-24ae49c9.js";import"./qr_nostrich-54e27ae3.js";import"./qr_lightning-fba50a71.js";import"./ButtonLink-2f835890.js";import"./CreatePinModal-3a4f5174.js";const Le=F("<div>"),Me=w(e=>(()=>{const p=Le();return C(()=>s(p,T.authorSubscribeSkeleton)),p})(),"AuthorSubscribeSkeleton"),Be="_authorSubscribeCard_1hjrm_1",Ke="_userInfo_1hjrm_10",Ve="_userData_1hjrm_15",Oe="_userName_1hjrm_22",Ue="_nip05_1hjrm_32",Je="_userPitch_1hjrm_41",We="_actions_1hjrm_52",ze="_authorPlaceholder_1hjrm_67",qe="_authorFeaturCard_1hjrm_74",Ge="_imageHolder_1hjrm_86",Qe="_image_1hjrm_86",Xe="_userBasicData_1hjrm_108",Ye="_userAdditionalData_1hjrm_137",Ze="_userAbout_1hjrm_144",et="_extended_1hjrm_158",tt="_userStats_1hjrm_162",nt="_number_1hjrm_167",rt="_unit_1hjrm_174",N={authorSubscribeCard:Be,userInfo:Ke,userData:Ve,userName:Oe,nip05:Ue,userPitch:Je,actions:We,authorPlaceholder:ze,authorFeaturCard:qe,imageHolder:Ge,image:Qe,userBasicData:Xe,userAdditionalData:Ye,userAbout:Ze,extended:et,userStats:tt,number:nt,unit:rt},st=F("<div><img>"),ne=F("<div>"),ot=F("<div><div></div><div>followers"),it=F("<div><div><div></div></div><div><div>"),ct=w(e=>{B();const p=re();de(),se();const u=w(()=>_e()&&localStorage.getItem("animate")==="true","shouldAnimate");return r(V,{get name(){return u()?"slide-fade":"none"},get children(){return r(k,{get when(){return e.author},get fallback(){return(()=>{const f=ne();return v(f,r(Me,{})),f})()},get children(){return r(U,{get href(){return p?.actions.profileLink(e.author?.npub)||""},get class(){return N.authorFeaturCard},get children(){return[r(k,{get when(){return e.author?.picture},get children(){const f=st(),m=f.firstChild;return C(g=>{const h=N.imageHolder,b=N.image,n=e.author?.picture;return h!==g._v$&&s(f,g._v$=h),b!==g._v$2&&s(m,g._v$2=b),n!==g._v$3&&K(m,"src",g._v$3=n),g},{_v$:void 0,_v$2:void 0,_v$3:void 0}),f}}),(()=>{const f=it(),m=f.firstChild,g=m.firstChild,h=m.nextSibling,b=h.firstChild;return v(g,()=>oe(e.author),null),v(g,r(ue,{get user(){return e.author}}),null),v(m,r(k,{get when(){return e.author?.nip05},get children(){const n=ne();return v(n,()=>le(e.author)),C(()=>s(n,N.nip05)),n}}),null),v(b,()=>e.author?.about),v(h,r(k,{get when(){return e.author?.userStats?.followers_count},get children(){const n=ot(),$=n.firstChild,o=$.nextSibling;return v($,()=>ve(e.author?.userStats?.followers_count||0)),C(c=>{const t=N.userStats,P=N.number,_=N.unit;return t!==c._v$4&&s(n,c._v$4=t),P!==c._v$5&&s($,c._v$5=P),_!==c._v$6&&s(o,c._v$6=_),c},{_v$4:void 0,_v$5:void 0,_v$6:void 0}),n}}),null),C(n=>{const $=N.userInfo,o=N.userBasicData,c=N.userName,t=N.userAdditionalData,P=`${N.userAbout} ${e.author?.nip05?"":N.extended}`;return $!==n._v$7&&s(f,n._v$7=$),o!==n._v$8&&s(m,n._v$8=o),c!==n._v$9&&s(g,n._v$9=c),t!==n._v$10&&s(h,n._v$10=t),P!==n._v$11&&s(b,n._v$11=P),n},{_v$7:void 0,_v$8:void 0,_v$9:void 0,_v$10:void 0,_v$11:void 0}),f})()]}})}})}})},"AuthorSubscribe"),at=O(ct),dt=F("<div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div>"),ut=w(e=>(()=>{const p=dt(),u=p.firstChild,f=u.nextSibling,m=f.nextSibling,g=m.nextSibling,h=g.nextSibling,b=h.nextSibling,n=b.nextSibling,$=n.nextSibling,o=$.nextSibling,c=o.nextSibling;return C(t=>{const P=T.readsFeaturedTopicsSkeleton,_=T.topic,a=T.topic,i=T.topic,l=T.topic,d=T.topic,A=T.topic,S=T.topic,H=T.topic,y=T.topic,G=T.topic;return P!==t._v$&&s(p,t._v$=P),_!==t._v$2&&s(u,t._v$2=_),a!==t._v$3&&s(f,t._v$3=a),i!==t._v$4&&s(m,t._v$4=i),l!==t._v$5&&s(g,t._v$5=l),d!==t._v$6&&s(h,t._v$6=d),A!==t._v$7&&s(b,t._v$7=A),S!==t._v$8&&s(n,t._v$8=S),H!==t._v$9&&s($,t._v$9=H),y!==t._v$10&&s(o,t._v$10=y),G!==t._v$11&&s(c,t._v$11=G),t},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0,_v$9:void 0,_v$10:void 0,_v$11:void 0}),p})(),"ReadsFeaturedTopicsSkeleton"),lt=F("<div>Featured Author"),j=F("<div>"),vt=F("<div>Featured Reads"),_t=F("<div>Topics"),z=F('<div class="animated">'),ht=w(e=>{const p=B(),u=J(),[f,m]=E(),[g,h]=E(!1),[b,n]=E(!1),[$,o]=E(!1);E(!1);const c=w(()=>{if(!u||u.topics.length>0)return;const _=`reads_topics_${W}`,a=Q(_,{onEvent:(i,l)=>{const d=JSON.parse(l.content||"[]");u?.actions.setTopics(d)},onEose:()=>{n(()=>!1),a()}});n(()=>!0),he(_)},"getTopics"),t=w(()=>{if(!u||u.featuredAuthor)return;const _=`reads_fa_${W}`,a=Q(_,{onEvent:(i,l)=>{const d=JSON.parse(l.content||"[]");m(()=>d[Math.floor(Math.random()*d.length)])},onEose:()=>{o(()=>!1),a()}});o(()=>!0),me(_)},"getFeaturedAuthor"),P=w(async _=>{const a=p?.publicKey||$e.names.primal;if(!a||!_)return;const i=`reads_fpi_${W}`;h(()=>!0);const l=await fe(a,_,i);h(()=>!1),u?.actions.setFeaturedAuthor(l)},"getAuthorData");return q(()=>{p?.isKeyLookupDone&&u?.recomendedReads.length===0&&u.actions.doSidebarSearch(""),p?.isKeyLookupDone&&(c(),t())}),M(()=>{if(!u)return;const _=f();_&&P(_)}),(()=>{const _=j();return v(_,r(k,{get when(){return p?.isKeyLookupDone},get children(){return[(()=>{const a=lt();return C(()=>s(a,D.headingPicks)),a})(),(()=>{const a=j();return v(a,r(at,{get author(){return u?.featuredAuthor}})),C(()=>s(a,D.section)),a})(),(()=>{const a=vt();return C(()=>s(a,D.headingPicks)),a})(),(()=>{const a=j();return v(a,r(V,{name:"slide-fade",get children(){return r(k,{get when(){return u&&u.topPicks.length>0},get fallback(){return r(k,{get when(){return!u||u.topPicks.length===0},get children(){const i=j();return v(i,r(L,{get each(){return Array(3)},children:()=>(()=>{const l=z();return v(l,r(Re,{})),l})()})),i}})},get children(){const i=j();return v(i,r(L,{get each(){return u?.topPicks},children:l=>(()=>{const d=z();return v(d,r(Ee,{article:l})),d})()})),i}})}})),C(()=>s(a,D.sectionTopPicks)),a})(),(()=>{const a=_t();return C(()=>s(a,D.headingPicks)),a})(),(()=>{const a=j();return v(a,r(V,{name:"slide-fade",get children(){return r(k,{get when(){return u&&u.topics.length>0},get fallback(){return r(k,{get when(){return!u||u.topics.length===0},get children(){const i=z();return v(i,r(ut,{})),i}})},get children(){const i=j();return v(i,r(L,{get each(){return u?.topics},children:l=>r(U,{href:`/reads/${l}`,get class(){return D.topic},children:l})})),i}})}})),C(()=>s(a,D.sectionTopics)),a})()]}})),C(a=>{const i=e.id,l=D.readsSidebar;return i!==a._v$&&K(_,"id",a._v$=i),l!==a._v$2&&s(_,a._v$2=l),a},{_v$:void 0,_v$2:void 0}),_})()},"ReadsSidebar"),mt=O(ht),$t=w(e=>{const p=B(),u=J(),f=se(),m=w(o=>Object.values(JSON.parse(o)).join("_"),"genId"),g=w(o=>{if(!o)return;const c={spec:o.value||"",name:o.label,description:o.description||"",enabled:!0},t=u?.selectedFeed;t&&t.spec===c.spec||(u?.actions.clearNotes(),u?.actions.selectFeed(c))},"selectFeed"),h=w(o=>{const c=u?.selectedFeed;return c&&c.spec===o.value},"isSelected"),b=w(()=>f?f?.readsFeeds.reduce((o,c)=>c.enabled?[...o,{label:c.name,value:c.spec,description:c.description,id:m(c.spec)}]:o,[]):[],"options"),n=w(()=>{const o=u?.selectedFeed;if(!o){let c=ge(p?.publicKey,"reads");if(c)return{label:c.name,value:c.spec||"",description:c.description,id:m(c.spec)};const t=b()[0];return g(t),t}return{label:o.name,value:o.spec||"",description:o.description,id:m(o.spec)}},"initialValue"),$=w(()=>u?.selectedFeed?{label:u.selectedFeed.name,value:u.selectedFeed.spec,description:u.selectedFeed.description,id:m(u.selectedFeed.spec)}:n(),"selectedValue");return r(Ae,{get options(){return b()},onChange:g,get initialValue(){return n()},get value(){return $()},isSelected:h,get isPhone(){return e.isPhone},get big(){return e.big},caption:"Reads Feeds",get captionAction(){return r(U,{href:"/settings/reads_feeds",children:"Edit Feeds"})}})},"ReedSelect"),ft=O($t),gt=F("<button><div>"),bt=F("<div><button><div></div><div>"),pt=F("<div><div>"),St=F("<div>"),wt=w(e=>{const p=J(),u=B(),f=ie();let m=document.body.scrollTop||document.documentElement.scrollTop;const g=w(()=>{const h=document.body.scrollTop||document.documentElement.scrollTop,b=document.getElementById("small_bottom_border");p?.actions.updateScrollTop(h);const n=h>m;if(m=h,h<2){b&&(b.style.display="none");return}m<2||b&&(b.style.display="flex")},"onScroll");return q(()=>{window.addEventListener("scroll",g)}),ce(()=>{window.removeEventListener("scroll",g)}),(()=>{const h=pt(),b=h.firstChild;return v(b,r(ft,{big:!0}),null),v(b,r(k,{get when(){return e.hasNewPosts()},get children(){const n=gt(),$=n.firstChild;return X(n,"click",e.loadNewContent,!0),v($,()=>f.formatMessage(Y,{number:e.newPostCount()>=99?99:e.newPostCount()})),C(o=>{const c=I.newContentItem,t=I.counter;return c!==o._v$&&s(n,o._v$=c),t!==o._v$2&&s($,o._v$2=t),o},{_v$:void 0,_v$2:void 0}),n}}),null),v(h,r(k,{get when(){return e.hasNewPosts()&&!u?.showNewNoteForm&&!((p?.scrollTop||0)<85)},get children(){const n=bt(),$=n.firstChild,o=$.firstChild,c=o.nextSibling;return X($,"click",e.loadNewContent,!0),v(o,r(L,{get each(){return e.newPostAuthors},children:t=>(()=>{const P=St();return v(P,r(pe,{user:t,size:"xss"})),C(_=>{const a=I.avatar,i=oe(t);return a!==_._v$9&&s(P,_._v$9=a),i!==_._v$10&&K(P,"title",_._v$10=i),_},{_v$9:void 0,_v$10:void 0}),P})()})),v(c,()=>f.formatMessage(Y,{number:e.newPostCount()})),C(t=>{const P=I.newArticleContentNotification,_=I.avatars,a=I.counter;return P!==t._v$3&&s(n,t._v$3=P),_!==t._v$4&&s(o,t._v$4=_),a!==t._v$5&&s(c,t._v$5=a),t},{_v$3:void 0,_v$4:void 0,_v$5:void 0}),n}}),null),C(n=>{const $=e.id,o=I.readsHeader,c=`${I.bigFeedSelect} ${I.readsFeed}`;return $!==n._v$6&&K(h,"id",n._v$6=$),o!==n._v$7&&s(h,n._v$7=o),c!==n._v$8&&s(b,n._v$8=c),n},{_v$6:void 0,_v$7:void 0,_v$8:void 0}),h})()},"ReadsHeader"),Ct=O(wt);be(["click"]);const R=F("<div>"),Pt=F("<div><div>topic:"),Ft=F("<div><div>"),At=F('<div class="animated">'),xn=w(()=>{const e=J(),p=B(),u=ie(),f=re(),m=Se(),g=w(()=>e?.isFetching,"isPageLoading");let h=0;const[b,n]=E(!1),[$,o]=E(0),[c,t]=we([]),P=w(()=>$()<100?$():100,"newPostCount");q(()=>{te(e?.scrollTop)}),M(()=>{if((e?.future.notes.length||0)>99||f?.isInactive){clearInterval(h);return}const i=e?.selectedFeed?.spec||"";h&&(clearInterval(h),n(!1),o(0),t(()=>[]));const l=25e3+Math.random()*1e4;h=setInterval(()=>{e?.actions.checkForNewNotes(i)},l)}),M(()=>{const i=e?.future.notes.length||0;if(i!==0){if(b()||n(!0),c.length<3){const d=(e?.future.notes.map(A=>A.user)||[]).reduce((A,S)=>A.find(y=>y&&y.pubkey===S.pubkey)?A:[...A,S],[]).slice(0,3);t(()=>[...d])}o(i)}}),ce(()=>{clearInterval(h),Ie(!1)});const _=w(()=>{if($()>100||f?.appState==="waking"){e?.actions.getFirstPage();return}e?.actions.loadFutureContent(),te(0,!0),n(!1),o(0),t(()=>[])},"loadNewContent");M(Z(()=>m.topic,(i,l)=>{if(i&&i.length>0){e?.actions.clearNotes(),e?.actions.fetchNotes(`{"kind":"reads","topic":"${decodeURIComponent(m.topic)}"}`);return}else l&&l.length>0&&e?.actions.refetchSelectedFeed()})),M(Z(()=>p?.isKeyLookupDone,(i,l)=>{if(i&&i!==l&&p?.publicKey&&!m.topic){const d=e?.selectedFeed;d&&e?.actions.selectFeed({...d})}}));const a=w((i,l)=>{e?.actions.setArticleHeight(i.naddr,l?.getBoundingClientRect().height||0)},"onArticleRendered");return(()=>{const i=Ft(),l=i.firstChild;return v(i,r(ye,{get title(){return u.formatMessage(Ce)}}),l),v(i,r(ke,{to:"search_section",get children(){return r(xe,{})}}),l),v(i,r(je,{get title(){return u.formatMessage(Pe.pageTitle)},get children(){return r(k,{get when(){return m.topic},get fallback(){return(()=>{const d=R();return v(d,r(Ct,{hasNewPosts:b,loadNewContent:_,newPostCount:P,newPostAuthors:c})),d})()},get children(){const d=Pt(),A=d.firstChild;return v(d,r(U,{get class(){return x.topicBubble},href:"/reads",onClick:()=>e?.actions.refetchSelectedFeed(),get children(){return[(()=>{const S=R();return v(S,()=>decodeURIComponent(m.topic)),S})(),(()=>{const S=R();return C(()=>s(S,x.closeIcon)),S})()]}}),null),C(S=>{const H=x.readsTopicHeader,y=x.backToReads;return H!==S._v$&&s(d,S._v$=H),y!==S._v$2&&s(A,S._v$2=y),S},{_v$:void 0,_v$2:void 0}),d}})}}),l),v(i,r(Te,{get children(){return r(mt,{})}}),l),v(l,r(V,{name:"slide-fade",get children(){return r(k,{get when(){return e?.notes&&e.notes.length>0},get fallback(){return(()=>{const d=R();return v(d,r(L,{each:new Array(5),children:()=>r(He,{})})),d})()},get children(){const d=R();return v(d,r(L,{get each(){return e?.notes},children:A=>(()=>{const S=At();return v(S,r(De,{article:A,get height(){return e?.articleHeights[A.naddr]},onRender:a})),S})()})),C(()=>s(d,x.feed)),d}})}}),null),v(l,r(Fe,{get children(){return[r(ee,{get when(){return!g()&&e?.notes&&e?.notes.length===0},get children(){const d=R();return C(()=>s(d,x.noContent)),d}}),r(ee,{get when(){return g()},get children(){const d=R();return C(()=>s(d,x.noContent)),d}})]}}),null),v(l,r(Ne,{loadNextPage:()=>e?.actions.fetchNextPage(m.topic)}),null),C(d=>{const A=x.homeContent,S=x.readsFeed;return A!==d._v$3&&s(i,d._v$3=A),S!==d._v$4&&s(l,d._v$4=S),d},{_v$3:void 0,_v$4:void 0}),i})()},"Home");export{xn as default};
//# sourceMappingURL=Reads-451d1355.js.map
