var re=Object.defineProperty;var r=(e,n)=>re(e,"name",{value:n,configurable:!0});import{e as ne,r as Z,j as f,l as T,s as ae,m as s,b3 as ce,t as S,u as ue,ad as ve,g as _e,B as me,b as fe,D as ge,E as $e,c as g,k as X,S as Y,d as K,A as he,F as ke,cy as ee,ak as j}from"./index-64dc6460.js";import{j as _,k as be,c as Ce,l as ye}from"./ParsedNote-9900e3c8.js";const pe="_feedMarketplaceTitle_197n3_1",ze="_feedMarketplaceContent_197n3_8",Me="_booths_197n3_18",Pe="_boothsPage_197n3_26",Ze="_feedMarketPlaceItem_197n3_32",Te="_header_197n3_46",Se="_left_197n3_49",we="_avatar_197n3_55",Le="_smallPrimalLogo_197n3_58",Fe="_right_197n3_71",Ie="_info_197n3_80",xe="_title_197n3_87",De="_about_197n3_98",Ee="_createdBy_197n3_110",Ne="_authorName_197n3_120",Ue="_actions_197n3_126",Ae="_commonUsersList_197n3_133",Re="_stats_197n3_150",Be="_dark_197n3_160",Ke="_likeIcon_197n3_169",je="_zapIcon_197n3_178",Ge="_feedMarketplaceFooter_197n3_188",Ve="_instruction_197n3_194",We="_feedMarketplacePreview_197n3_202",qe="_previewInDialog_197n3_210",Oe="_dvmCaption_197n3_215",Qe="_dvmList_197n3_218",He="_feedMarketplacePreviewFooter_197n3_223",Je="_paidToken_197n3_232",Xe="_freeToken_197n3_246",Ye="_primalLogo_197n3_260",d={feedMarketplaceTitle:pe,feedMarketplaceContent:ze,booths:Me,boothsPage:Pe,feedMarketPlaceItem:Ze,header:Te,left:Se,avatar:we,smallPrimalLogo:Le,right:Fe,info:Ie,title:xe,about:De,createdBy:Ee,authorName:Ne,actions:Ue,commonUsersList:Ae,stats:Re,dark:Be,likeIcon:Ke,zapIcon:je,feedMarketplaceFooter:Ge,instruction:Ve,feedMarketplacePreview:We,previewInDialog:qe,dvmCaption:Oe,dvmList:Qe,feedMarketplacePreviewFooter:He,paidToken:Je,freeToken:Xe,primalLogo:Ye},et=S("<button><div><div></div><div>"),tt={zap:_.zapType,like:_.likeType,reply:_.replyType,repost:_.repostType},te=r(e=>(()=>{const n=et(),k=n.firstChild,$=k.firstChild,c=$.nextSibling;return Z(n,"touchend",e.onTouchEnd??(()=>{}),!0),Z(n,"touchstart",e.onTouchStart??(()=>{}),!0),Z(n,"mouseup",e.onMouseUp??(()=>{}),!0),Z(n,"mousedown",e.onMouseDown??(()=>{}),!0),Z(n,"click",e.onClick??(()=>{}),!0),f(c,()=>e.label||""),T(o=>{const m=`btn_${e.type}_${e.dvm?.id}`,i=`${_.stat} ${e.highlighted?_.highlighted:""}`,p=e.disabled,b=`${tt[e.type]} ${e.large?_.large:""}`,C=`${_.icon} ${e.large?_.large:""}`,x=e.hidden?"visibility: hidden":"visibility: visible",w=_.statNumber;return m!==o._v$&&ae(n,"id",o._v$=m),i!==o._v$2&&s(n,o._v$2=i),p!==o._v$3&&(n.disabled=o._v$3=p),b!==o._v$4&&s(k,o._v$4=b),C!==o._v$5&&s($,o._v$5=C),o._v$6=ce($,x,o._v$6),w!==o._v$7&&s(c,o._v$7=w),o},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0}),n})(),"DvmFooterActionButton");ne(["click","mousedown","mouseup","touchstart","touchend"]);const nt=S("<div>PAID"),at=S("<div><div></div><span>Created by</span> <span>Primal"),it=S("<div><div><div></div><div></div></div><div><div><div></div><div></div></div><div><div></div><div>"),st=S("<div>FREE"),rt=r(e=>{const n=ue(),k=ve(),$=_e(),c=me(),o=fe(),[m,i]=ge({likes:0,satszapped:0,liked:!1,zapped:!1,isZapping:!1,zapFailed:!1}),p=r(()=>e.size||"list","size");$e(()=>{e.stats&&i(()=>({likes:e.stats?.likes||0,satszapped:e.stats?.satszapped||0})),e.actions&&i(()=>({liked:e.actions?.liked||!1,zapped:e.actions?.zapped||!1}))});const b=r(()=>m.likes,"likes"),C=r(()=>m.satszapped,"satszapped"),x=r(()=>{if(!e.dvm)return!1;const{amount:a,primalVerifiedRequired:l}=e.dvm,u=parseInt(a);return a!=="free"&&!isNaN(u)&&u>0||l},"isPaid"),w=r(async a=>{if(a.preventDefault(),a.stopPropagation(),!n||!e.dvm)return;if(!n.hasPublicKey()){n.actions.showGetStarted();return}if(!n.proxyThroughPrimal&&n.relays.length===0){k?.sendWarning($.formatMessage(j.noRelaysConnected));return}await n.actions.addLike(e.dvm)&&i(u=>({likes:u.likes+1,liked:!0}))},"doLike");let G=0;const D=r(()=>({dvm:e.dvm?{...e.dvm,user:e.author}:void 0,onConfirm:ie,onSuccess:se,onFail:oe,onCancel:de}),"customZapInfo"),ie=r(a=>{c?.actions.closeCustomZapModal(),i("satszapped",l=>l+(a.amount||0)),i("zapped",()=>!0)},"onConfirmZap"),se=r(a=>{c?.actions.closeCustomZapModal(),c?.actions.resetCustomZap(),i("zapped",()=>!0)},"onSuccessZap"),oe=r(a=>{c?.actions.closeCustomZapModal(),c?.actions.resetCustomZap(),i("satszapped",l=>l-(a.amount||0)),i("zapped",()=>e.actions?.zapped||!1)},"onFailZap"),de=r(a=>{c?.actions.closeCustomZapModal(),c?.actions.resetCustomZap(),i("satszapped",l=>l-(a.amount||0)),i("zapped",()=>e.actions?.zapped||!1)},"onCancelZap"),V=r(a=>{if(a.preventDefault(),a.stopPropagation(),!n?.hasPublicKey()){n?.actions.showGetStarted(),i("isZapping",()=>!1);return}if(!n.proxyThroughPrimal&&n.relays.length===0){k?.sendWarning($.formatMessage(j.noRelaysConnected));return}if(!be(e.author)){k?.sendWarning($.formatMessage(j.zapDVMUnavailable)),i("isZapping",()=>!1),i("zapFailed",()=>!0);return}G=setTimeout(()=>{c?.actions.openCustomZapModal(D()),i("isZapping",()=>!0)},500)},"startZap"),W=r(a=>{if(a.preventDefault(),a.stopPropagation(),clearTimeout(G),m.zapFailed){i("zapFailed",()=>!1);return}if(!n?.hasPublicKey()){n?.actions.showGetStarted();return}!n.proxyThroughPrimal&&n.relays.length===0||c?.customZap===void 0&&le()},"commitZap"),le=r(async()=>{if(!n?.hasPublicKey()){n?.actions.showGetStarted();return}const a=o?.defaultZap.amount||10,l=o?.defaultZap.message||"",u=o?.defaultZap.emoji;i("satszapped",y=>y+(a||0)),i("isZapping",()=>!0),setTimeout(async()=>{if(!e.dvm||!e.author)return;const y=await Ce(e.dvm,e.author,n.publicKey,a,l,n.activeRelays);if(i("isZapping",()=>!1),y){D().onSuccess({emoji:u,amount:a,message:l});return}D().onFail({emoji:u,amount:a,message:l})},ye())},"doQuickZap");return(()=>{const a=it(),l=a.firstChild,u=l.firstChild,y=u.nextSibling,E=l.nextSibling,N=E.firstChild,U=N.firstChild,q=U.nextSibling,A=N.nextSibling,R=A.firstChild,B=R.nextSibling;return a.$$click=()=>e.onClick&&e.onClick(e.dvm),f(u,g(X,{size:"vs2",get src(){return e.dvm?.picture||e.dvm?.image||""}})),f(y,g(Y,{get when(){return x()},get fallback(){return(()=>{const t=st();return T(()=>s(t,d.freeToken)),t})()},get children(){const t=nt();return T(()=>s(t,d.paidToken)),t}})),f(U,()=>e.dvm?.name||""),f(q,()=>e.dvm?.about||""),f(E,g(Y,{get when(){return K(()=>!!e.metadata?.isPrimal)()&&p()==="header"},get children(){const t=at(),h=t.firstChild,L=h.nextSibling,F=L.nextSibling,I=F.nextSibling;return T(v=>{const z=d.createdBy,M=d.primalLogo,P=d.authorName;return z!==v._v$&&s(t,v._v$=z),M!==v._v$2&&s(h,v._v$2=M),P!==v._v$3&&s(I,v._v$3=P),v},{_v$:void 0,_v$2:void 0,_v$3:void 0}),t}}),A),f(R,g(ke,{get each(){return e.commonUsers},children:t=>g(he,{get href(){return c?.actions.profileLink(t.npub)||""},get class(){return d.avatar},onClick:h=>(h.stopPropagation(),!0),get children(){return g(X,{size:"micro",user:t})}})})),f(B,g(te,{get dvm(){return e.dvm},onClick:w,type:"like",get highlighted(){return m.liked||n?.likes.includes(e.dvm?.id||"")},get label(){return K(()=>b()===0)()?"":ee(b(),2)},get title(){return b().toLocaleString()}}),null),f(B,g(te,{get dvm(){return e.dvm},onClick:t=>t.stopPropagation(),onMouseDown:V,onMouseUp:W,onTouchStart:V,onTouchEnd:W,type:"zap",get highlighted(){return m.zapped||m.isZapping},get label(){return K(()=>C()===0)()?"":ee(C(),2)},get title(){return C().toLocaleString()}}),null),T(t=>{const h=e.dvm?.id,L=`${d.feedMarketPlaceItem} ${p()==="header"?d.header:""}`,F=d.left,I=d.avatar,v=d.paid,z=d.right,M=d.info,P=d.title,O=d.about,Q=d.actions,H=d.commonUsersList,J=d.stats;return h!==t._v$4&&ae(a,"data-id",t._v$4=h),L!==t._v$5&&s(a,t._v$5=L),F!==t._v$6&&s(l,t._v$6=F),I!==t._v$7&&s(u,t._v$7=I),v!==t._v$8&&s(y,t._v$8=v),z!==t._v$9&&s(E,t._v$9=z),M!==t._v$10&&s(N,t._v$10=M),P!==t._v$11&&s(U,t._v$11=P),O!==t._v$12&&s(q,t._v$12=O),Q!==t._v$13&&s(A,t._v$13=Q),H!==t._v$14&&s(R,t._v$14=H),J!==t._v$15&&s(B,t._v$15=J),t},{_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0,_v$9:void 0,_v$10:void 0,_v$11:void 0,_v$12:void 0,_v$13:void 0,_v$14:void 0,_v$15:void 0}),a})()},"FeedMarketItem");ne(["click"]);export{rt as F,d as s};
//# sourceMappingURL=FeedMarketPlaceItem-1368feb7.js.map
