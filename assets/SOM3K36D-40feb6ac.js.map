{"version":3,"file":"SOM3K36D-40feb6ac.js","sources":["../../node_modules/@kobalte/core/dist/chunk/SOM3K36D.jsx"],"sourcesContent":["import {\n  createControllableArraySignal\n} from \"./FN6EICGO.jsx\";\n\n// src/primitives/create-dom-collection/create-dom-collection.ts\nimport { access, addItemToArray } from \"@kobalte/utils\";\nimport { createComponent } from \"solid-js\";\n\n// src/primitives/create-dom-collection/dom-collection-context.ts\nimport { createContext, useContext } from \"solid-js\";\nvar DomCollectionContext = createContext();\nfunction useOptionalDomCollectionContext() {\n  return useContext(DomCollectionContext);\n}\nfunction useDomCollectionContext() {\n  const context = useOptionalDomCollectionContext();\n  if (context === void 0) {\n    throw new Error(\n      \"[kobalte]: `useDomCollectionContext` must be used within a `DomCollectionProvider` component\"\n    );\n  }\n  return context;\n}\n\n// src/primitives/create-dom-collection/utils.ts\nimport { getDocument } from \"@kobalte/utils\";\nimport { createEffect, onCleanup } from \"solid-js\";\nfunction isElementPreceding(a, b) {\n  return Boolean(\n    b.compareDocumentPosition(a) & Node.DOCUMENT_POSITION_PRECEDING\n  );\n}\nfunction findDOMIndex(items, item) {\n  const itemEl = item.ref();\n  if (!itemEl) {\n    return -1;\n  }\n  let length = items.length;\n  if (!length) {\n    return -1;\n  }\n  while (length--) {\n    const currentItemEl = items[length]?.ref();\n    if (!currentItemEl) {\n      continue;\n    }\n    if (isElementPreceding(currentItemEl, itemEl)) {\n      return length + 1;\n    }\n  }\n  return 0;\n}\nfunction sortBasedOnDOMPosition(items) {\n  const pairs = items.map((item, index) => [index, item]);\n  let isOrderDifferent = false;\n  pairs.sort(([indexA, a], [indexB, b]) => {\n    const elementA = a.ref();\n    const elementB = b.ref();\n    if (elementA === elementB) {\n      return 0;\n    }\n    if (!elementA || !elementB) {\n      return 0;\n    }\n    if (isElementPreceding(elementA, elementB)) {\n      if (indexA > indexB) {\n        isOrderDifferent = true;\n      }\n      return -1;\n    }\n    if (indexA < indexB) {\n      isOrderDifferent = true;\n    }\n    return 1;\n  });\n  if (isOrderDifferent) {\n    return pairs.map(([_, item]) => item);\n  }\n  return items;\n}\nfunction setItemsBasedOnDOMPosition(items, setItems) {\n  const sortedItems = sortBasedOnDOMPosition(items);\n  if (items !== sortedItems) {\n    setItems(sortedItems);\n  }\n}\nfunction getCommonParent(items) {\n  const firstItem = items[0];\n  const lastItemEl = items[items.length - 1]?.ref();\n  let parentEl = firstItem?.ref()?.parentElement;\n  while (parentEl) {\n    if (lastItemEl && parentEl.contains(lastItemEl)) {\n      return parentEl;\n    }\n    parentEl = parentEl.parentElement;\n  }\n  return getDocument(parentEl).body;\n}\nfunction createTimeoutObserver(items, setItems) {\n  createEffect(() => {\n    const timeout = setTimeout(() => {\n      setItemsBasedOnDOMPosition(items(), setItems);\n    });\n    onCleanup(() => clearTimeout(timeout));\n  });\n}\nfunction createSortBasedOnDOMPosition(items, setItems) {\n  if (typeof IntersectionObserver !== \"function\") {\n    createTimeoutObserver(items, setItems);\n    return;\n  }\n  let previousItems = [];\n  createEffect(() => {\n    const callback = () => {\n      const hasPreviousItems = !!previousItems.length;\n      previousItems = items();\n      if (!hasPreviousItems) {\n        return;\n      }\n      setItemsBasedOnDOMPosition(items(), setItems);\n    };\n    const root = getCommonParent(items());\n    const observer = new IntersectionObserver(callback, { root });\n    for (const item of items()) {\n      const itemEl = item.ref();\n      if (itemEl) {\n        observer.observe(itemEl);\n      }\n    }\n    onCleanup(() => observer.disconnect());\n  });\n}\n\n// src/primitives/create-dom-collection/create-dom-collection.ts\nfunction createDomCollection(props = {}) {\n  const [items, setItems] = createControllableArraySignal({\n    value: () => access(props.items),\n    onChange: (value) => props.onItemsChange?.(value)\n  });\n  createSortBasedOnDOMPosition(items, setItems);\n  const registerItem = (item) => {\n    setItems((prevItems) => {\n      const index = findDOMIndex(prevItems, item);\n      return addItemToArray(prevItems, item, index);\n    });\n    return () => {\n      setItems((prevItems) => {\n        const nextItems = prevItems.filter(\n          (prevItem) => prevItem.ref() !== item.ref()\n        );\n        if (prevItems.length === nextItems.length) {\n          return prevItems;\n        }\n        return nextItems;\n      });\n    };\n  };\n  const DomCollectionProvider = (props2) => {\n    return createComponent(DomCollectionContext.Provider, {\n      value: { registerItem },\n      get children() {\n        return props2.children;\n      }\n    });\n  };\n  return { DomCollectionProvider };\n}\n\n// src/primitives/create-dom-collection/create-dom-collection-item.ts\nimport { mergeDefaultProps } from \"@kobalte/utils\";\nimport { createEffect as createEffect2, onCleanup as onCleanup2 } from \"solid-js\";\nfunction createDomCollectionItem(props) {\n  const context = useDomCollectionContext();\n  const mergedProps = mergeDefaultProps({ shouldRegisterItem: true }, props);\n  createEffect2(() => {\n    if (!mergedProps.shouldRegisterItem) {\n      return;\n    }\n    const unregister = context.registerItem(mergedProps.getItem());\n    onCleanup2(unregister);\n  });\n}\n\nexport {\n  DomCollectionContext,\n  useOptionalDomCollectionContext,\n  useDomCollectionContext,\n  createDomCollection,\n  createDomCollectionItem\n};\n"],"names":["DomCollectionContext","createContext","useOptionalDomCollectionContext","useContext","useDomCollectionContext","context","Error","isElementPreceding","a","b","Boolean","compareDocumentPosition","Node","DOCUMENT_POSITION_PRECEDING","findDOMIndex","items","item","itemEl","ref","length","currentItemEl","sortBasedOnDOMPosition","pairs","map","index","isOrderDifferent","sort","indexA","indexB","elementA","elementB","_","setItemsBasedOnDOMPosition","setItems","sortedItems","getCommonParent","firstItem","lastItemEl","parentEl","parentElement","contains","getDocument","body","createTimeoutObserver","createEffect","timeout","setTimeout","onCleanup","clearTimeout","createSortBasedOnDOMPosition","IntersectionObserver","previousItems","callback","hasPreviousItems","root","observer","observe","disconnect","createDomCollection","props","createControllableArraySignal","value","access","onChange","onItemsChange","registerItem","prevItems","addItemToArray","nextItems","filter","prevItem","DomCollectionProvider","props2","createComponent","Provider","children","createDomCollectionItem","mergedProps","mergeDefaultProps","shouldRegisterItem","createEffect2","unregister","getItem","onCleanup2"],"mappings":"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","x_google_ignoreList":[0]}