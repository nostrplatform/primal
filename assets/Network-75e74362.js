var Ye=Object.defineProperty;var u=(r,o)=>Ye(r,"name",{value:o,configurable:!0});import{j as i,t as b,g as Ze,u as et,b as tt,D as nt,C as Z,E as it,N as rt,dA as Me,T as Ie,dB as st,c as a,cN as d,A as lt,p as N,aP as ot,l as g,m as n,S as T,cO as at,dC as Pe,q as O,F as vt,H as dt,M as Ee,s as ee,e as ct,ay as Te,x as Ue}from"./index-64dc6460.js";import{s as t}from"./Settings.module-7ae8ff86.js";import{P as ut}from"./PageCaption-27eb7f4c.js";import{C as $t}from"./ConfirmModal-62a7ec79.js";import{H as te}from"./HelpTip-4eefb44b.js";import{P as gt}from"./PageTitle-3d0a9832.js";import{B as Ae}from"./ButtonLink-2f835890.js";import{C as Be}from"./CheckBox2-65e1c04f.js";import"./ConfirmModal.module-73b4314e.js";import"./ButtonPrimary-1f64caa8.js";import"./Buttons.module-e818c1ea.js";import"./5WXHJDCZ-8b9b8e69.js";import"./index-b4296c5e.js";import"./ButtonSecondary-cc5e2282.js";import"./AdvancedSearchDialog-eff41eef.js";import"./index-a25c8160.js";import"./index-c76cfba2.js";import"./JNCCF6MP-19ab5fd3.js";import"./QJIB6BDF-1d7b1e44.js";import"./VI7QYH27-fb7b5f5a.js";import"./Checkbox.module-81b9bd85.js";const _t=b("<b>"),ft=u((...r)=>(()=>{const o=_t();return i(o,r),o})(),"interpretBold"),h=b("<div>"),ne=b("<span>"),mt=b('<div><div><div><span></span></div><div></div></div><div><div></div><div><div></div></div><div><div><div></div><span></span></div></div><div></div><div><div></div><input type="text"><button><div></div></button></div><div style="height:20px"></div></div><div><div></div><div></div></div><div></div><div></div><div><div></div><div><div></div><input type="text"><button><div></div></button></div><div style="height:48px">'),ht=b("<div><div>"),yt=b("<button><div><div></div><span></span></div><div>"),jt=u(()=>{const r=Ze(),o=et(),De=tt(),[Ne,Oe]=nt([]),[H,L]=Z(""),[He,ie]=Z(!1),[Le,re]=Z(!1);let y,C;const W=u(()=>{let s=[];for(let v in o?.relaySettings||{})s.push(Me(v));return s},"relays"),We=u(s=>{const v=o?.relays.find(_=>_.url===s);return v&&v.ws&&v.ws.readyState===WebSocket.OPEN},"isConnected$1"),je=u(()=>{const s="wss://relay.primal.net".split(",")||[];return Object.keys(o?.relaySettings||{}).includes(s[0])},"isPrimalRelayInUserSettings"),Fe=u(()=>{o?.actions.setConnectToPrimaryRelays(!o.connectToPrimaryRelays)},"onCheckPrimalRelay"),qe=u(s=>{o?.actions.removeRelay(s),W().length===0&&setTimeout(()=>{o?.actions.connectToRelays({})},200)},"onRemoveRelay"),se=u(()=>{if(!(!y||y.value===""))try{const s=y.value,v=new URL(s);if(!v.origin.startsWith("wss://")&&!v.origin.startsWith("ws://"))throw new Error("must be a wss");y.value="",o?.actions.addRelay(s),ie(!1)}catch(s){Te("invalid relay input ",s),ie(!0)}},"onCustomRelayInput"),ze=u(()=>{o?.actions.resetRelays(Ne)},"resetRelays"),le=u(()=>{if(!(!C||C.value===""))try{const s=new URL(C.value);if(!s.origin.startsWith("wss://")&&!s.origin.startsWith("ws://"))throw new Error("must be a wss");C.value="",o?.actions.changeCachingService(s.href),re(!1)}catch(s){Te("invalid caching service input",s),re(!0)}},"onCachingServiceInput");return it(()=>{const s=rt(`settings_drs_${Ie}`,{onEvent:(v,_)=>{const U=JSON.parse(_.content||"[]")||[];Oe(()=>U.map(Me))},onEose:()=>{s()}});st(`settings_drs_${Ie}`)}),(()=>{const s=mt(),v=s.firstChild,_=v.firstChild,U=_.firstChild,oe=_.nextSibling,S=v.nextSibling,j=S.firstChild,A=j.nextSibling,Je=A.firstChild,F=A.nextSibling,q=F.firstChild,z=q.firstChild,Ge=z.nextSibling,J=F.nextSibling,G=J.nextSibling,ae=G.firstChild,w=ae.nextSibling,ve=w.nextSibling,Ke=ve.firstChild,Qe=G.nextSibling,K=S.nextSibling,Q=K.firstChild,de=Q.nextSibling,B=K.nextSibling,D=B.nextSibling,V=D.nextSibling,X=V.firstChild,Y=X.nextSibling,ce=Y.firstChild,x=ce.nextSibling,ue=x.nextSibling,Ve=ue.firstChild,Xe=Y.nextSibling;i(s,a(gt,{get title(){return`${r.formatMessage(d.network.title)} ${r.formatMessage(d.title)}`}}),v),i(s,a(ut,{get children(){return[a(lt,{href:"/settings",get children(){return r.formatMessage(d.index.title)}}),":Â ",(()=>{const e=h();return i(e,()=>r.formatMessage(d.network.title)),e})()]}}),v),i(_,a(Be,{id:"proxyEvents",label:"",onChange:()=>{De?.actions.setProxyThroughPrimal(!o?.proxyThroughPrimal)},get checked(){return o?.proxyThroughPrimal}}),U),i(U,()=>r.formatMessage(d.network.proxyEvents)),i(_,a(te,{zIndex:1e3,get children(){const e=ne();return i(e,()=>r.formatMessage(d.network.proxyDescription)),e}}),null),i(oe,()=>r.formatMessage(d.network.proxyDescription)),i(j,()=>r.formatMessage(d.network.cachingService)),i(Je,()=>r.formatMessage(d.network.connectedCachingService)),i(A,a(te,{get children(){const e=ne();return i(e,()=>r.formatMessage(N.cachingPoolHelp)),e}}),null),i(q,a(T,{get when(){return ot()},get fallback(){return(()=>{const e=h();return g(()=>n(e,t.disconnected)),e})()},get children(){const e=h();return g(()=>n(e,t.connected)),e}}),z),i(Ge,()=>at()?.url),i(J,()=>r.formatMessage(d.network.alternativeCachingService)),w.addEventListener("change",()=>le());const $e=C;typeof $e=="function"?Ue($e,w):C=w,ve.$$click=()=>le(),i(S,a(T,{get when(){return Le()},get children(){const e=h();return i(e,()=>r.formatMessage(Pe.invalidRelayUrl)),g(()=>n(e,t.invalidInput)),e}}),Qe),i(S,a(Ae,{onClick:()=>o?.actions.changeCachingService(),get children(){return r.formatMessage(O.restoreCachingService)}}),null),i(Q,()=>r.formatMessage(d.network.relays)),i(de,()=>r.formatMessage(d.network.myRelays)),i(s,a(T,{get when(){return W().length>0},get fallback(){return(()=>{const e=ht(),$=e.firstChild;return i($,()=>r.formatMessage(d.network.noMyRelays)),g(c=>{const f=t.settingsContentPaddingOnly,m=t.noMyRelays;return f!==c._v$26&&n(e,c._v$26=f),m!==c._v$27&&n($,c._v$27=m),c},{_v$26:void 0,_v$27:void 0}),e})()},get children(){return a(vt,{get each(){return W()},children:e=>(()=>{const $=yt(),c=$.firstChild,f=c.firstChild,m=f.nextSibling,R=c.nextSibling;return $.$$click=()=>L(e.url),i(c,a(dt,{get fallback(){return(()=>{const l=h();return g(()=>n(l,t.disconnected)),l})()},get children(){return[a(Ee,{get when(){return o?.proxyThroughPrimal},get children(){const l=h();return g(()=>n(l,t.suspended)),l}}),a(Ee,{get when(){return We(e.url)},get children(){const l=h();return g(()=>n(l,t.connected)),l}})]}}),f),i(m,()=>e.url),i(R,()=>r.formatMessage(O.removeRelay)),g(l=>{const k=t.relayItem,p=t.relayEntry,M=t.webIcon,I=t.relayUrl,P=e.url,E=t.remove;return k!==l._v$28&&n($,l._v$28=k),p!==l._v$29&&n(c,l._v$29=p),M!==l._v$30&&n(f,l._v$30=M),I!==l._v$31&&n(m,l._v$31=I),P!==l._v$32&&ee(m,"title",l._v$32=P),E!==l._v$33&&n(R,l._v$33=E),l},{_v$28:void 0,_v$29:void 0,_v$30:void 0,_v$31:void 0,_v$32:void 0,_v$33:void 0}),$})()})}}),B),i(B,a(T,{get when(){return!je()},get children(){return a(Be,{id:"primal_relay_check",get checked(){return o?.connectToPrimaryRelays},onChange:()=>Fe(),get label(){return"Post a copy of all content to the Primal relay (wss://relay.primal.net)"}})}})),i(D,a(Ae,{onClick:ze,get children(){return r.formatMessage(O.resetRelays)}}),null),i(D,a(te,{get children(){const e=ne();return i(e,()=>r.formatMessage(N.resetRelaysHelp)),e}}),null),i(X,()=>r.formatMessage(d.network.customRelay)),x.addEventListener("change",()=>se());const ge=y;return typeof ge=="function"?Ue(ge,x):y=x,ue.$$click=()=>se(),i(V,a(T,{get when(){return He()},get children(){const e=h();return i(e,()=>r.formatMessage(Pe.invalidRelayUrl)),g(()=>n(e,t.invalidInput)),e}}),Xe),i(s,a($t,{get open(){return H().length>0},get description(){return r.formatMessage(O.confirmRemoveRelay,{url:H(),b:ft})},onConfirm:()=>{qe(H()),L("")},onAbort:()=>L("")}),null),g(e=>{const $=t.settingsContent,c=t.settingsCaption,f=t.moderationDescription,m=t.settingsContent,R=`${t.bigCaption}`,l=t.settingsCaption,k=`${t.relayItem} ${t.extended}`,p=t.relayEntry,M=t.webIcon,I=`${t.settingsCaption} ${t.secondCaption}`,P=t.relayInput,E=t.webIcon,_e=r.formatMessage(N.cachingServiceUrl),fe=t.connectIcon,me=t.settingsContent,he=t.bigCaption,ye=t.settingsCaption,Ce=t.settingsContentPaddingOnly,be=t.resetRelays,Se=t.settingsContentBorderless,we=`${t.settingsCaption} ${t.secondCaption}`,xe=t.relayInput,Re=t.webIcon,ke=r.formatMessage(N.relayUrl),pe=t.connectIcon;return $!==e._v$&&n(v,e._v$=$),c!==e._v$2&&n(_,e._v$2=c),f!==e._v$3&&n(oe,e._v$3=f),m!==e._v$4&&n(S,e._v$4=m),R!==e._v$5&&n(j,e._v$5=R),l!==e._v$6&&n(A,e._v$6=l),k!==e._v$7&&n(F,e._v$7=k),p!==e._v$8&&n(q,e._v$8=p),M!==e._v$9&&n(z,e._v$9=M),I!==e._v$10&&n(J,e._v$10=I),P!==e._v$11&&n(G,e._v$11=P),E!==e._v$12&&n(ae,e._v$12=E),_e!==e._v$13&&ee(w,"placeholder",e._v$13=_e),fe!==e._v$14&&n(Ke,e._v$14=fe),me!==e._v$15&&n(K,e._v$15=me),he!==e._v$16&&n(Q,e._v$16=he),ye!==e._v$17&&n(de,e._v$17=ye),Ce!==e._v$18&&n(B,e._v$18=Ce),be!==e._v$19&&n(D,e._v$19=be),Se!==e._v$20&&n(V,e._v$20=Se),we!==e._v$21&&n(X,e._v$21=we),xe!==e._v$22&&n(Y,e._v$22=xe),Re!==e._v$23&&n(ce,e._v$23=Re),ke!==e._v$24&&ee(x,"placeholder",e._v$24=ke),pe!==e._v$25&&n(Ve,e._v$25=pe),e},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0,_v$9:void 0,_v$10:void 0,_v$11:void 0,_v$12:void 0,_v$13:void 0,_v$14:void 0,_v$15:void 0,_v$16:void 0,_v$17:void 0,_v$18:void 0,_v$19:void 0,_v$20:void 0,_v$21:void 0,_v$22:void 0,_v$23:void 0,_v$24:void 0,_v$25:void 0}),s})()},"Network");ct(["click"]);export{jt as default};
//# sourceMappingURL=Network-75e74362.js.map
